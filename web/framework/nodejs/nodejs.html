<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.38" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://chenyl8848.github.io/web/framework/nodejs/nodejs.html"><meta property="og:site_name" content="Java陈序员"><meta property="og:title" content="Node.js 万字入门教程"><meta property="og:type" content="article"><meta property="og:updated_time" content="2024-10-02T03:11:43.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="Node.js"><meta property="article:tag" content="MongoDB"><meta property="article:published_time" content="2023-05-31T00:00:00.000Z"><meta property="article:modified_time" content="2024-10-02T03:11:43.000Z"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_3316994_227lwxrw41z.css"><title>Node.js 万字入门教程 | Java陈序员</title><meta name="description" content="Java陈序员的个人博客网站">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.7c8a6ce0.css">
    <link rel="modulepreload" href="/assets/app.06d697e7.js"><link rel="modulepreload" href="/assets/nodejs.html.0eebf012.js"><link rel="modulepreload" href="/assets/nodejs.html.86126f6f.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc sidebar-open"><!--[--><header class="navbar"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><a href="/" class="home-link"><img class="logo" src="/logo.webp" alt="Java陈序员"><!----><span class="site-name hide-in-pad">Java陈序员</span><!--[--><!----><!--]--></a><nav class="nav-links" style=""><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" arialabel="首页"><i class="icon iconfont icon-home"></i>首页<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="后端"><span class="title"><i class="icon iconfont icon-rearend"></i>后端</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/rearend/java/" class="nav-link" arialabel="Java"><i class="icon iconfont icon-java"></i>Java<!----></a></li><li class="dropdown-item"><a href="/rearend/spring/" class="nav-link" arialabel="Spring"><i class="icon iconfont icon-spring"></i>Spring<!----></a></li><li class="dropdown-item"><a href="/rearend/springBoot/" class="nav-link" arialabel="Spring Boot"><i class="icon iconfont icon-springboot"></i>Spring Boot<!----></a></li><li class="dropdown-item"><a href="/rearend/microServices/" class="nav-link" arialabel="微服务"><i class="icon iconfont icon-microServices"></i>微服务<!----></a></li><li class="dropdown-item"><a href="/rearend/dataStructure/" class="nav-link" arialabel="数据结构"><i class="icon iconfont icon-dataStructure"></i>数据结构<!----></a></li><li class="dropdown-item"><a href="/rearend/algorithm/" class="nav-link" arialabel="算法"><i class="icon iconfont icon-algorithm"></i>算法<!----></a></li><li class="dropdown-item"><a href="/rearend/designPattern/" class="nav-link" arialabel="设计模式"><i class="icon iconfont icon-designPattern"></i>设计模式<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="中间件"><span class="title"><i class="icon iconfont icon-middleware"></i>中间件</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/middleware/database/" class="nav-link" arialabel="数据库"><i class="icon iconfont icon-database"></i>数据库<!----></a></li><li class="dropdown-item"><a href="/middleware/noSQL/" class="nav-link" arialabel="NoSQL"><i class="icon iconfont icon-noSQL"></i>NoSQL<!----></a></li><li class="dropdown-item"><a href="/middleware/mq/" class="nav-link" arialabel="MQ"><i class="icon iconfont icon-MQ"></i>MQ<!----></a></li><li class="dropdown-item"><a href="/middleware/zookeeper/" class="nav-link" arialabel="ZooKeeper"><i class="icon iconfont icon-zookeeper"></i>ZooKeeper<!----></a></li><li class="dropdown-item"><a href="/middleware/elasticsearch/" class="nav-link" arialabel="ElasticSearch"><i class="icon iconfont icon-elasticsearch"></i>ElasticSearch<!----></a></li><li class="dropdown-item"><a href="/middleware/prometheus/" class="nav-link" arialabel="Prometheus"><i class="icon iconfont icon-prometheus"></i>Prometheus<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="服务器"><span class="title"><i class="icon iconfont icon-server"></i>服务器</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/server/linux/" class="nav-link" arialabel="Linux"><i class="icon iconfont icon-linux"></i>Linux<!----></a></li><li class="dropdown-item"><a href="/server/docker/" class="nav-link" arialabel="Docker"><i class="icon iconfont icon-docker"></i>Docker<!----></a></li><li class="dropdown-item"><a href="/server/kubernetes/" class="nav-link" arialabel="Kubernetes"><i class="icon iconfont icon-kubernetes"></i>Kubernetes<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="AI"><span class="title"><i class="icon iconfont icon-wuguan"></i>AI</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/ai/assistant/" class="nav-link" arialabel="AI 助手"><i class="icon iconfont icon-Cursor"></i>AI 助手<!----></a></li><li class="dropdown-item"><a href="/ai/framework/" class="nav-link" arialabel="AI 框架"><i class="icon iconfont icon-Aisucai"></i>AI 框架<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="前端"><span class="title"><i class="icon iconfont icon-wangye"></i>前端</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>框架</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/framework/js/" class="nav-link" arialabel="JavaScript"><i class="icon iconfont icon-java_script"></i>JavaScript<!----></a></li><li class="dropdown-subitem"><a href="/web/framework/nodejs/" class="nav-link active" arialabel="Node.js"><i class="icon iconfont icon-node-js"></i>Node.js<!----></a></li><li class="dropdown-subitem"><a href="/web/framework/vue/" class="nav-link" arialabel="Vue.js"><i class="icon iconfont icon-vue"></i>Vue.js<!----></a></li><li class="dropdown-subitem"><a href="/web/framework/react/" class="nav-link" arialabel="React"><i class="icon iconfont icon-react"></i>React<!----></a></li><li class="dropdown-subitem"><a href="/web/framework/mp/" class="nav-link" arialabel="小程序"><i class="icon iconfont icon-xiaochengxu"></i>小程序<!----></a></li><li class="dropdown-subitem"><a href="/web/framework/blog/" class="nav-link" arialabel="Blog"><i class="icon iconfont icon-folder-vuepress"></i>Blog<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="索引"><span class="title"><i class="icon iconfont icon-index"></i>索引</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/article/" class="nav-link" arialabel="文章"><i class="icon iconfont icon-articles"></i>文章<!----></a></li><li class="dropdown-item"><a href="/category/java/" class="nav-link" arialabel="分类"><i class="icon iconfont icon-category"></i>分类<!----></a></li><li class="dropdown-item"><a href="/tag/" class="nav-link" arialabel="标签"><i class="icon iconfont icon-tag"></i>标签<!----></a></li><li class="dropdown-item"><a href="/timeline/" class="nav-link" arialabel="时间轴"><i class="icon iconfont icon-timeLine"></i>时间轴<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzkzOTM3NjAzOQ==&amp;action=getalbum&amp;album_id=2783119709868212224&amp;scene=126&amp;sessionid=-659761542&amp;uin=&amp;key=&amp;devicetype=Windows+11+x64&amp;version=6309092b&amp;lang=zh_CN&amp;ascene=0&amp;session_us=gh_b840974cfe99" rel="noopener noreferrer" target="_blank" arialabel="开源项目" class="nav-link"><i class="icon iconfont icon-note"></i>开源项目<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><div class="nav-actions-wrapper"><!--[--><!----><!--]--><div class="nav-item"><!----></div><div class="nav-item"><a class="repo-link" href="https://github.com/chenyl8848/chenyl8848.github.io" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" arialabelledby="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><title id="github" lang="en">github icon</title><g fill="currentColor"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></g></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" arialabelledby="outlook"><title id="outlook" lang="en">outlook icon</title><g fill="currentColor"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></g></svg><div class="outlook-dropdown"><!----></div></button></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button><!--[--><!----><!--]--></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/web/framework/nodejs/" class="nav-link sidebar-link sidebar-page" arialabel="Node.js"><i class="icon iconfont icon-node-js"></i>Node.js<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/web/framework/nodejs/nodejs.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" arialabel="Node.js 万字入门教程"><!---->Node.js 万字入门教程<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_0-基础概念" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="0. 基础概念"><!---->0. 基础概念<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_1-buffer" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1. Buffer"><!---->1. Buffer<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_1-1-概念" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.1 概念"><!---->1.1 概念<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_1-2-特点" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2 特点"><!---->1.2 特点<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_1-3-使用" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.3 使用"><!---->1.3 使用<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-fs-模块" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2. fs 模块"><!---->2. fs 模块<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-1-文件写入" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2.1 文件写入"><!---->2.1 文件写入<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-2-文件读取" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2.2 文件读取"><!---->2.2 文件读取<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-3-文件移动与重命名" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2.3 文件移动与重命名"><!---->2.3 文件移动与重命名<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-4-文件删除" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2.4 文件删除"><!---->2.4 文件删除<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-5-文件夹操作" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2.5 文件夹操作"><!---->2.5 文件夹操作<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-6-查看资源状态" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2.6 查看资源状态"><!---->2.6 查看资源状态<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-7-相对路径问题" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2.7 相对路径问题"><!---->2.7 相对路径问题<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-8-dirname" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2.8 __dirname"><!---->2.8 __dirname<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-9-练习" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2.9 练习"><!---->2.9 练习<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_3-path-模块" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="3. path 模块"><!---->3. path 模块<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_4-http-模块" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="4. http 模块"><!---->4. http 模块<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_4-1-创建-http-服务" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="4.1 创建 http 服务"><!---->4.1 创建 http 服务<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_4-2-获取-http-请求报文" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="4.2 获取 http 请求报文"><!---->4.2 获取 http 请求报文<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_4-3-设置-http-响应报文" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="4.3 设置 http 响应报文"><!---->4.3 设置 http 响应报文<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_4-4-练习" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="4.4 练习"><!---->4.4 练习<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_4-5-静态资源服务" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="4.5 静态资源服务"><!---->4.5 静态资源服务<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_5-模块化" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="5. 模块化"><!---->5. 模块化<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_5-1-基础概念" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="5.1 基础概念"><!---->5.1 基础概念<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_5-2-模块暴露" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="5.2 模块暴露"><!---->5.2 模块暴露<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_5-3-模块导入" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="5.3 模块导入"><!---->5.3 模块导入<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_5-4-模块导入流程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="5.4 模块导入流程"><!---->5.4 模块导入流程<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-包管理工具" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="6. 包管理工具"><!---->6. 包管理工具<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-1-基础概念" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="6.1 基础概念"><!---->6.1 基础概念<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-2-npm" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="6.2 npm"><!---->6.2 npm<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-2-2-包管理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="6.2.2 包管理"><!---->6.2.2 包管理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-2-3-启动项目" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="6.2.3 启动项目"><!---->6.2.3 启动项目<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-3-cnpm" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="6.3 cnpm"><!---->6.3 cnpm<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-4-yarn" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="6.4 yarn"><!---->6.4 yarn<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-5-管理发布包" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="6.5 管理发布包"><!---->6.5 管理发布包<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-6-nvm" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="6.6 nvm"><!---->6.6 nvm<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_7-express-框架" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="7. express 框架"><!---->7. express 框架<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_7-1-介绍与使用" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="7.1 介绍与使用"><!---->7.1 介绍与使用<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_7-2-路由" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="7.2 路由"><!---->7.2 路由<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_7-3-中间件" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="7.3 中间件"><!---->7.3 中间件<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_7-4-ejs-模板引擎" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="7.4 EJS 模板引擎"><!---->7.4 EJS 模板引擎<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_7-5-脚手架" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="7.5 脚手架"><!---->7.5 脚手架<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_8-mongodb" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="8. MongoDB"><!---->8. MongoDB<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_8-1-基础概念" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="8.1 基础概念"><!---->8.1 基础概念<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_8-2-操作命令" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="8.2 操作命令"><!---->8.2 操作命令<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_8-3-mongooose" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="8.3 Mongooose"><!---->8.3 Mongooose<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_9-接口" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="9. 接口"><!---->9. 接口<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_9-1-restful-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="9.1 RESTful API"><!---->9.1 RESTful API<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_9-2-json-server" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="9.2 json-server"><!---->9.2 json-server<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_10-会话控制" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="10. 会话控制"><!---->10. 会话控制<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_10-1-cookie" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="10.1 cookie"><!---->10.1 cookie<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_10-2-session" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="10.2 session"><!---->10.2 session<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_10-3-token" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="10.3 token"><!---->10.3 token<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Node.js 万字入门教程</h1><div class="article-info"><span class="author-info" arialabel="作者🖊" data-balloon-pos="down" isoriginal="false" pageview="false" color="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" arialabelledby="author"><title id="author" lang="en">author icon</title><g fill="currentColor"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></g></svg><span><a class="author-item" href="https://chenyl8848.github.io" target="_blank" rel="noopener noreferrer">Java陈序员</a></span><span property="author" content="Java陈序员"></span></span><!----><span class="date-info" arialabel="写作日期📅" data-balloon-pos="down" isoriginal="false" pageview="false" color="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" arialabelledby="calendar"><title id="calendar" lang="en">calendar icon</title><g fill="currentColor"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></g></svg><span>2023年5月31日</span><meta property="datePublished" content="2023-05-31T00:00:00.000Z"></span><span class="category-info" arialabel="分类🌈" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" arialabelledby="category"><title id="category" lang="en">category icon</title><g fill="currentColor"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></g></svg><ul class="categories-wrapper"><li class="category category6 clickable" role="navigation">前端</li><meta property="articleSection" content="前端"></ul></span><span arialabel="标签🏷" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" arialabelledby="tag"><title id="tag" lang="en">tag icon</title><g fill="currentColor"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></g></svg><ul class="tags-wrapper"><li class="tag tag4 clickable" role="navigation">Node.js</li><li class="tag tag3 clickable" role="navigation">MongoDB</li></ul><meta property="keywords" content="Node.js,MongoDB"></span><span class="reading-time-info" arialabel="阅读时间⌛" data-balloon-pos="down" isoriginal="false" pageview="false" color="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" arialabelledby="timer"><title id="timer" lang="en">timer icon</title><g fill="currentColor"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></g></svg><span>大约 52 分钟</span><meta property="timeRequired" content="PT52M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc-list"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_0-基础概念" class="router-link-active router-link-exact-active toc-link level2">0. 基础概念</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_1-buffer" class="router-link-active router-link-exact-active toc-link level2">1. Buffer</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_1-1-概念" class="router-link-active router-link-exact-active toc-link level3">1.1 概念</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_1-2-特点" class="router-link-active router-link-exact-active toc-link level3">1.2 特点</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_1-3-使用" class="router-link-active router-link-exact-active toc-link level3">1.3 使用</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-fs-模块" class="router-link-active router-link-exact-active toc-link level2">2. fs 模块</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-1-文件写入" class="router-link-active router-link-exact-active toc-link level3">2.1 文件写入</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-2-文件读取" class="router-link-active router-link-exact-active toc-link level3">2.2 文件读取</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-3-文件移动与重命名" class="router-link-active router-link-exact-active toc-link level3">2.3 文件移动与重命名</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-4-文件删除" class="router-link-active router-link-exact-active toc-link level3">2.4 文件删除</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-5-文件夹操作" class="router-link-active router-link-exact-active toc-link level3">2.5 文件夹操作</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-6-查看资源状态" class="router-link-active router-link-exact-active toc-link level3">2.6 查看资源状态</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-7-相对路径问题" class="router-link-active router-link-exact-active toc-link level3">2.7 相对路径问题</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-8-dirname" class="router-link-active router-link-exact-active toc-link level3">2.8 __dirname</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_2-9-练习" class="router-link-active router-link-exact-active toc-link level3">2.9 练习</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_3-path-模块" class="router-link-active router-link-exact-active toc-link level2">3. path 模块</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_4-http-模块" class="router-link-active router-link-exact-active toc-link level2">4. http 模块</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_4-1-创建-http-服务" class="router-link-active router-link-exact-active toc-link level3">4.1 创建 http 服务</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_4-2-获取-http-请求报文" class="router-link-active router-link-exact-active toc-link level3">4.2 获取 http 请求报文</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_4-3-设置-http-响应报文" class="router-link-active router-link-exact-active toc-link level3">4.3 设置 http 响应报文</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_4-4-练习" class="router-link-active router-link-exact-active toc-link level3">4.4 练习</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_4-5-静态资源服务" class="router-link-active router-link-exact-active toc-link level3">4.5 静态资源服务</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_5-模块化" class="router-link-active router-link-exact-active toc-link level2">5. 模块化</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_5-1-基础概念" class="router-link-active router-link-exact-active toc-link level3">5.1 基础概念</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_5-2-模块暴露" class="router-link-active router-link-exact-active toc-link level3">5.2 模块暴露</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_5-3-模块导入" class="router-link-active router-link-exact-active toc-link level3">5.3 模块导入</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_5-4-模块导入流程" class="router-link-active router-link-exact-active toc-link level3">5.4 模块导入流程</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-包管理工具" class="router-link-active router-link-exact-active toc-link level2">6. 包管理工具</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-1-基础概念" class="router-link-active router-link-exact-active toc-link level3">6.1 基础概念</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-2-npm" class="router-link-active router-link-exact-active toc-link level3">6.2 npm</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-2-2-包管理" class="router-link-active router-link-exact-active toc-link level3">6.2.2 包管理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-2-3-启动项目" class="router-link-active router-link-exact-active toc-link level3">6.2.3 启动项目</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-3-cnpm" class="router-link-active router-link-exact-active toc-link level3">6.3 cnpm</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-4-yarn" class="router-link-active router-link-exact-active toc-link level3">6.4 yarn</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-5-管理发布包" class="router-link-active router-link-exact-active toc-link level3">6.5 管理发布包</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_6-6-nvm" class="router-link-active router-link-exact-active toc-link level3">6.6 nvm</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_7-express-框架" class="router-link-active router-link-exact-active toc-link level2">7. express 框架</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_7-1-介绍与使用" class="router-link-active router-link-exact-active toc-link level3">7.1 介绍与使用</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_7-2-路由" class="router-link-active router-link-exact-active toc-link level3">7.2 路由</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_7-3-中间件" class="router-link-active router-link-exact-active toc-link level3">7.3 中间件</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_7-4-ejs-模板引擎" class="router-link-active router-link-exact-active toc-link level3">7.4 EJS 模板引擎</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_7-5-脚手架" class="router-link-active router-link-exact-active toc-link level3">7.5 脚手架</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_8-mongodb" class="router-link-active router-link-exact-active toc-link level2">8. MongoDB</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_8-1-基础概念" class="router-link-active router-link-exact-active toc-link level3">8.1 基础概念</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_8-2-操作命令" class="router-link-active router-link-exact-active toc-link level3">8.2 操作命令</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_8-3-mongooose" class="router-link-active router-link-exact-active toc-link level3">8.3 Mongooose</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_9-接口" class="router-link-active router-link-exact-active toc-link level2">9. 接口</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_9-1-restful-api" class="router-link-active router-link-exact-active toc-link level3">9.1 RESTful API</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_9-2-json-server" class="router-link-active router-link-exact-active toc-link level3">9.2 json-server</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_10-会话控制" class="router-link-active router-link-exact-active toc-link level2">10. 会话控制</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_10-1-cookie" class="router-link-active router-link-exact-active toc-link level3">10.1 cookie</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_10-2-session" class="router-link-active router-link-exact-active toc-link level3">10.2 session</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/web/framework/nodejs/nodejs.html#_10-3-token" class="router-link-active router-link-exact-active toc-link level3">10.3 token</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!--[--><h1 id="node-js-万字入门教程" tabindex="-1"><a class="header-anchor" href="#node-js-万字入门教程" aria-hidden="true">#</a> <code>Node.js</code> 万字入门教程</h1><h2 id="_0-基础概念" tabindex="-1"><a class="header-anchor" href="#_0-基础概念" aria-hidden="true">#</a> 0. 基础概念</h2><blockquote><p><code>Node.js</code> 是一个基于 <code>Chrome V8</code> 引擎的 <code>JavaScript</code> 运行环境，使用了一个事件驱动、非阻塞式 <code>I/O</code> 模型，让 <code>JavaScript</code> 运行在服务端的开发平台。</p></blockquote><p>官方地址：https://nodejs.org/en</p><p>中文地址：https://nodejs.org/zh-cn</p><p>代码初体验：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>console.log(&quot;hello NodeJS&quot;)

// 1.进入到对应 js 文件的目录下
// 2.执行 node 1-hello.js
// 3.输出：hello NodeJS
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>示例代码地址：https://github.com/chenyl8848/node.js-study</p><h2 id="_1-buffer" tabindex="-1"><a class="header-anchor" href="#_1-buffer" aria-hidden="true">#</a> 1. <code>Buffer</code></h2><h3 id="_1-1-概念" tabindex="-1"><a class="header-anchor" href="#_1-1-概念" aria-hidden="true">#</a> 1.1 概念</h3><blockquote><p><code>Buffer</code> 是一个类似于数组的<strong>对象</strong>，用于表示固定长度的字节序列。<code>Buffer</code> 本质是一段内存空间，专门用来处理二进制数据。</p></blockquote><h3 id="_1-2-特点" tabindex="-1"><a class="header-anchor" href="#_1-2-特点" aria-hidden="true">#</a> 1.2 特点</h3><ul><li><code>Buffer</code> 大小固定且无法调整</li><li><code>Buffer</code> 性能较好，可以直接对计算机内存进行操作</li><li>每个元素的大小为 1 字节（byte）</li></ul><h3 id="_1-3-使用" tabindex="-1"><a class="header-anchor" href="#_1-3-使用" aria-hidden="true">#</a> 1.3 使用</h3><h4 id="_1-3-1-buffer-的创建" tabindex="-1"><a class="header-anchor" href="#_1-3-1-buffer-的创建" aria-hidden="true">#</a> 1.3.1 <code>Buffer</code> 的创建</h4><p><code>Node.js</code> 中创建 <code>Buffer</code> 的方式主要如下几种：</p><p><code>Buffer.alloc</code></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 创建了一个长度为 10 字节的 Buffer，相当于申请了 10 字节的内存空间，每个字节的值为 0
// 结果为 &lt;Buffer 00 00 00 00 00 00 00 00 00 00&gt;
let buf_1 = Buffer.alloc(10);
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>Buffer.allocUnsafe</code></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 创建了一个长度为 10 字节的 Buffer，Buffer 中可能存在旧的数据, 可能会影响执行结果，所以叫 unsafe
let buf_2 = Buffer.allocUnsafe(10);
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>Buffer.from</code></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 通过字符串创建 Buffer
let buf_3 = Buffer.from(&#39;hello&#39;);
// 通过数组创建 Buffer
let buf_4 = Buffer.from([105, 108, 111, 118, 101, 121, 111, 117]);
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_1-3-2-buffer-与字符串的转化" tabindex="-1"><a class="header-anchor" href="#_1-3-2-buffer-与字符串的转化" aria-hidden="true">#</a> 1.3.2 <code>Buffer</code> 与字符串的转化</h4><p>可以借助 <code>toString</code> 方法将 <code>Buffer</code> 转为字符串</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// buffer 与字符串的转换
const buffer = Buffer.from([105, 108, 111, 118, 101, 121, 111, 117]);
// 默认使用 UTF-8 的编码格式
console.log(buffer.toString())
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>注意：<code>toString</code> 默认是按照 <code>utf-8</code> 编码方式进行转换的。</p></blockquote><h4 id="_1-3-3-buffer-的操作" tabindex="-1"><a class="header-anchor" href="#_1-3-3-buffer-的操作" aria-hidden="true">#</a> 1.3.3 <code>Buffer</code> 的操作</h4><p><code>Buffer</code> 可以直接通过 [] 的方式对数据进行处理。</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>const buffer = Buffer.from(&#39;hello&#39;);
// 二进制：1101000
console.log(buffer[0].toString(2))

// 修改 buffer
buffer[0] = 95
console.log(buffer.toString())

// 溢出 如果修改的数值超过 255 ，则超过 8 位数据会被舍弃
const buffer = Buffer.from(&#39;hello&#39;)
// 会舍弃高位的数字，因为八位的二进制最高值为 255   0001 0110 1001  =&gt; 0110 1001
buffer[0] = 361
console.log(buffer)

// 中文 一个 utf-8 的字符 一般 占 3 个字节
const buffer = Buffer.from(&#39;你好&#39;)
console.log(buffer)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><p>注意：</p><ol><li>如果修改的数值超过 255，则超过 8 位数据会被舍弃</li><li>一个 <code>utf-8</code> 的字符一般占 3 个字节</li></ol></blockquote><h2 id="_2-fs-模块" tabindex="-1"><a class="header-anchor" href="#_2-fs-模块" aria-hidden="true">#</a> 2. <code>fs</code> 模块</h2><blockquote><p><code>fs</code> 全称为 <code>file system</code>,称之为<strong>文件系统</strong>，是 <code>Node.js</code> 中的<strong>内置模块</strong>，可以对计算机中的磁盘进行操作。</p></blockquote><h3 id="_2-1-文件写入" tabindex="-1"><a class="header-anchor" href="#_2-1-文件写入" aria-hidden="true">#</a> 2.1 文件写入</h3><p>文件写入就是将数据保存到文件中，有如下的 <code>API</code></p><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td>writeFile</td><td>异步写入</td></tr><tr><td>writeFileSync</td><td>同步写入</td></tr><tr><td>appendFile/appendFileSync</td><td>追加写入</td></tr><tr><td>createWriteStream</td><td>流式写入</td></tr></tbody></table><h4 id="_2-1-1-异步写入" tabindex="-1"><a class="header-anchor" href="#_2-1-1-异步写入" aria-hidden="true">#</a> 2.1.1 异步写入</h4><p>语法： <code>fs.writeFile(file, data, [options], callback)</code></p><p>参数说明：</p><ul><li><code>file</code>:文件名</li><li><code>data</code>:待写入的数据</li><li><code>options</code>:选项设置 （可选）</li><li><code>callback</code>:写入回调</li></ul><p>返回值： <code>undefined</code></p><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.导入 fs 模块
const fs = require(&#39;fs&#39;)

// 2.写入文件
// writeFile 异步写入，四个参数：1.文件路径 2.写入内容 3.配置信息 4.回调函数
// 文件写入成功
fs.writeFile(&#39;./座右铭.txt&#39;, &#39;封狼居胥，禅于姑衍，饮马瀚海&#39;, error =&gt; {
    // errror 为 null就是写入成功
    if (error) {
        console.log(&#39;文件写入失败&#39;)
        return;
    }
    console.log(&#39;文件写入成功&#39;)
});
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="_2-1-2-同步写入" tabindex="-1"><a class="header-anchor" href="#_2-1-2-同步写入" aria-hidden="true">#</a> 2.1.2 同步写入</h4><p>语法: <code>fs.writeFileSync(file, data, [options])</code></p><p>参数说明：</p><ul><li><code>file</code>:文件名</li><li><code>data</code>:待写入的数据</li><li><code>options</code>:选项设置 （可选）</li></ul><p>返回值： <code>undefined</code></p><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.导入 fs 模块
const fs = require(&#39;fs&#39;)

// 2.写入文件
// 同步写入，没有回调函数
fs.writeFileSync(&#39;./座右铭.txt&#39;, &#39;封狼居胥，禅于姑衍，饮马瀚海，燕石勒然&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p><code>Node.js</code> 中的磁盘操作是由其他线程完成的，结果的处理有两种模式：</p><ul><li>同步处理 <code>JavaScript</code> 主线程会等待其他线程的执行结果，然后再继续执行主线程的代码，效率较低</li><li>异步处理 <code>JavaScript</code> 主线程不会等待其他线程的执行结果，直接执行后续的主线程代码，效率较好</li></ul></blockquote><h4 id="_2-1-3-追加写入" tabindex="-1"><a class="header-anchor" href="#_2-1-3-追加写入" aria-hidden="true">#</a> 2.1.3 追加写入</h4><p><code>appendFile</code> 作用是在文件尾部追加内容，<code>appendFile</code> 语法与 <code>writeFile</code> 语法完全相同 语法:</p><ul><li>fs.appendFile(file, data, [options], callback)</li><li>fs.appendFileSync(file, data, [options])</li></ul><p>返回值： 二者都为 <code>undefined</code> 代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 fs 模块
const fs = require(&#39;fs&#39;);

const content = &#39;\r\n但使龙城飞将在，不教胡马度阴山&#39;;

// fs.appendFile(&#39;./座右铭.txt&#39;, content, error =&gt; {
//     // errror 为 null就是写入成功
//     if (error) {
//         console.log(&#39;文件追加写入失败&#39;)
//         return;
//     }
//     console.log(&#39;文件追加写入成功&#39;);
// })

// 同步文件追加写入
// fs.appendFileSync(&#39;./座右铭.txt&#39;, content)

// 使用 writeFile 的方式追加文件写入
fs.writeFile(&#39;./座右铭.txt&#39;, content, {flag: &#39;a&#39;}, error =&gt; {
    if (error) {
        console.log(&#39;文件追加写入失败&#39;)
        return;
    }
    console.log(&#39;文件追加写入成功&#39;)
})

console.log(&#39;hello world&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h4 id="_2-1-4-流式写入" tabindex="-1"><a class="header-anchor" href="#_2-1-4-流式写入" aria-hidden="true">#</a> 2.1.4 流式写入</h4><p>语法： <code>fs.createWriteStream(path, [options])</code></p><p>参数说明：</p><ul><li><code>path</code>:文件路径</li><li><code>options</code>:选项配置（ 可选 ）</li></ul><p>返回值： <code>Object</code></p><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.导入 fs 模块
const fs = require(&#39;fs&#39;);

// 2.创建写入流对象
const writeStream = fs.createWriteStream(&#39;./观书有感.txt&#39;);

// 3.写入内容
writeStream.write(&#39;半亩方塘一鉴开\r\n&#39;)
writeStream.write(&#39;天光云影共徘徊\r\n&#39;)
writeStream.write(&#39;问渠那得清如许\r\n&#39;)
writeStream.write(&#39;为有源头活水来\r\n&#39;)

// 4.关闭通道 不是必须
// writeStream.close();
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><blockquote><p>程序打开一个文件是需要消耗资源的，流式写入可以减少打开关闭文件的次数。流式写入方式适用于<strong>大文件写入</strong>或者<strong>频繁写入</strong>的场景, <code>writeFile</code> 适合于写入频率较低的场景。</p></blockquote><h3 id="_2-2-文件读取" tabindex="-1"><a class="header-anchor" href="#_2-2-文件读取" aria-hidden="true">#</a> 2.2 文件读取</h3><p>文件读取顾名思义，就是通过程序从文件中取出其中的数据，有如下几种 <code>API</code>：</p><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td>readFile</td><td>异步读取</td></tr><tr><td>readFileSync</td><td>同步读取</td></tr><tr><td>createReadStream</td><td>流式读取</td></tr></tbody></table><h4 id="_2-2-1-异步读取" tabindex="-1"><a class="header-anchor" href="#_2-2-1-异步读取" aria-hidden="true">#</a> 2.2.1 异步读取</h4><p>语法： <code>fs.readFile(path, [options], callback)</code></p><p>参数说明：</p><ul><li><code>path</code>:文件路径</li><li><code>options</code>:选项配置</li><li><code>callback</code>:回调函数</li></ul><p>返回值： <code>undefined</code></p><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 fs 模块
const fs = require(&#39;fs&#39;)

// 2.异步读取
fs.readFile(&#39;./座右铭.txt&#39;, (error, data) =&gt; {
    if (error) {
        console.log(&#39;文件读取错误&#39;)
        return
    }
    console.log(data.toString())
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_2-2-2-同步读取" tabindex="-1"><a class="header-anchor" href="#_2-2-2-同步读取" aria-hidden="true">#</a> 2.2.2 同步读取</h4><p>语法： <code>fs.readFileSync(path, [options])</code></p><p>参数说明：</p><ul><li><code>path</code>:文件路径</li><li><code>options</code>:选项配置</li></ul><p>返回值： <code>string</code> | <code>Buffer</code></p><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 fs 模块
const fs = require(&#39;fs&#39;)

// 2.同步读取
let data = fs.readFileSync(&#39;./座右铭.txt&#39;);
console.log(data.toString())
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_2-2-3-流式读取" tabindex="-1"><a class="header-anchor" href="#_2-2-3-流式读取" aria-hidden="true">#</a> 2.2.3 流式读取</h4><p>语法： <code>fs.createReadStream(path, [options])</code></p><p>参数说明：</p><ul><li><code>path</code>:文件路径</li><li><code>options</code>:选项配置（可选）</li></ul><p>返回值：<code>Object</code></p><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.导入 fs 模块
const fs = require(&#39;fs&#39;)

// 2.创建读取流对象
const rs = fs.createReadStream(&#39;./观书有感.txt&#39;);

// 3.绑定 data 事件
rs.on(&#39;data&#39;, chunk =&gt; {
    // chunk:块儿、大块儿
    console.log(chunk)
    console.log(chunk.length)
    console.log(chunk.toString())
})

// 4.结束事件（可选）
rs.on(&#39;end&#39;, () =&gt; {
    console.log(&#39;文件读取完成&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_2-3-文件移动与重命名" tabindex="-1"><a class="header-anchor" href="#_2-3-文件移动与重命名" aria-hidden="true">#</a> 2.3 文件移动与重命名</h3><p>在 <code>Node.js</code> 中，可以使用 <code>rename</code> 或 <code>renameSync</code> 来移动或重命名文件或文件夹</p><p>语法：</p><ul><li><code>fs.rename(oldPath, newPath, callback)</code></li><li><code>fs.renameSync(oldPath, newPath)</code></li></ul><p>参数说明：</p><ul><li><code>oldPath</code>:文件当前的路径</li><li><code>newPath</code>:文件新的路径</li><li><code>callback</code>:操作后的回调</li></ul><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.导入 fs 模块
const fs = require(&#39;fs&#39;);

// 2.文件重命名
// fs.rename(&#39;./座右铭-2.txt&#39;, &#39;./西汉名将.txt&#39;, error =&gt; {
//     if (error) {
//         console.log(&#39;文件重命名失败&#39;)
//            return ;
//     }
//     console.log(&#39;文件重命名成功&#39;)
// })

// 3.文件移动
// 文件夹如果不存在，会报错误 Error: ENOENT: no such file or directory
fs.rename(&#39;./西汉名将.txt&#39;, &#39;./文件/西汉名将.txt&#39;, error =&gt; {
    if (error) {
        console.log(error, &#39;移动文件出错&#39;);
        return ;
    }
    console.log(&#39;操作成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_2-4-文件删除" tabindex="-1"><a class="header-anchor" href="#_2-4-文件删除" aria-hidden="true">#</a> 2.4 文件删除</h3><p>在 <code>Node.js</code> 中，可以使用 <code>unlink</code> 或 <code>unlinkSync</code> 或 <code>rm</code> 或 <code>rmSync</code> 来删除文件</p><p>语法：</p><ul><li><code>fs.unlink(path, callback)</code></li><li><code>fs.unlinkSync(path)</code></li></ul><p>参数说明：</p><ul><li><code>path</code>:文件路径</li><li><code>callback</code>:操作后的回调</li></ul><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 fs 模块
const fs = require(&#39;fs&#39;)

// 2.调用 unlink 方法
// unlinkSync:同步删除
// fs.unlink(&#39;./座右铭-3.txt&#39;, error =&gt; {
//     if (error) {
//         console.log(&#39;删除文件错误&#39;, error)
//         return;
//     }
//     console.log(&#39;删除文件成功&#39;)
// })

// 3.调用 rm 方法
// rmSync:同步删除
fs.rm(&#39;./文件/西汉名将.txt&#39;, error =&gt; {
    if (error) {
        console.log(&#39;文件删除失败&#39;, error)
        return;
    }
    console.log(&#39;文件删除成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_2-5-文件夹操作" tabindex="-1"><a class="header-anchor" href="#_2-5-文件夹操作" aria-hidden="true">#</a> 2.5 文件夹操作</h3><p>在 <code>Node.js</code> 中可以通过如下 <code>API</code> 对文件夹进行创建、读取、删除等操作</p><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td>mkdir / mkdirSync</td><td>创建文件夹</td></tr><tr><td>readdir / readdirSync</td><td>读取文件夹</td></tr><tr><td>rmdir / rmdirSync</td><td>删除文件夹</td></tr></tbody></table><h4 id="_2-5-1-创建文件夹" tabindex="-1"><a class="header-anchor" href="#_2-5-1-创建文件夹" aria-hidden="true">#</a> 2.5.1 创建文件夹</h4><p>在 <code>Node.js</code> 中，可以使用 <code>mkdir</code> 或 <code>mkdirSync</code> 来创建文件夹</p><p>语法：</p><ul><li><code>fs.mkdir(path, [options], callback)</code></li><li><code>fs.mkdirSync(path, [options])</code></li></ul><p>参数说明：</p><ul><li><code>path</code>:文件夹路径</li><li><code>options</code>:选项配置（可选）</li><li><code>callback</code>:操作后的回调</li></ul><p>示例代码：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 fs 模块
const fs = require(&#39;fs&#39;)

// 2.创建文件夹
// mkdir make:制作 directory:目录
fs.mkdir(&#39;./html&#39;, error =&gt; {
    if (error) {
        console.log(&#39;创建目录失败&#39;, error)
        return;
    }
    console.log(&#39;创建目录成功&#39;)
})

// 3.递归创建文件夹
fs.mkdir(&#39;./a/b/c&#39;, {
    recursive: true
}, error =&gt; {
    if (error) {
        console.log(&quot;递归创建文件夹失败&quot;, error)
        return;
    }
    console.log(&#39;递归创建文件夹成功&#39;)
})

// 4.递归同步创建文件夹
fs.mkdirSync(&#39;./a/b/c&#39;, {recursive: true});
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="_2-5-2-读取文件夹" tabindex="-1"><a class="header-anchor" href="#_2-5-2-读取文件夹" aria-hidden="true">#</a> 2.5.2 读取文件夹</h4><p>在 <code>Node.js</code> 中，可以使用 <code>readdir</code> 或 <code>readdirSync</code> 来读取文件夹</p><p>语法：</p><ul><li><code>fs.readdir(path, [options], callback)</code></li><li><code>fs.readdirSync(path, [options])</code></li></ul><p>参数说明：</p><ul><li><code>path</code>:文件夹路径</li><li><code>options</code>:选项配置（可选）</li><li><code>callback</code>:操作后的回调</li></ul><p>示例代码：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 fs 模块
const fs = require(&#39;fs&#39;)

// 2.读取文件夹
// readdir read:读取 dir:directory 目录
fs.readdir(&#39;./&#39;, (error, data) =&gt; {
    if (error) {
        console.log(&#39;读取文件夹错误&#39;, error)
        return;
    }
    // [
    //     &#39;1-文件写入.js&#39;,
    //     &#39;2-追加写入.js&#39;,
    //     &#39;3-流式写入.js&#39;,
    //     &#39;4-文件读取.js&#39;,
    //     &#39;5-流式读取.js&#39;,
    //     &#39;6-练习-文件复制.js&#39;,
    //     &#39;7-文件重命名与移动.js&#39;,
    //     &#39;8-删除文件.js&#39;,
    //     &#39;9-文件夹操作.js&#39;,
    //     &#39;a&#39;,
    //     &#39;html&#39;,
    //     &#39;座右铭.txt&#39;,
    //     &#39;文件&#39;,
    //     &#39;观书有感.txt&#39;
    // ]
    console.log(data)
})

//同步读取
// let data = fs.readdirSync(&#39;./&#39;);
// console.log(data);
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h4 id="_2-5-3-删除文件夹" tabindex="-1"><a class="header-anchor" href="#_2-5-3-删除文件夹" aria-hidden="true">#</a> 2.5.3 删除文件夹</h4><p>在 <code>Node.js</code> 中，可以使用 <code>rmdir</code> 或 <code>rmdirSync</code> 来删除文件夹</p><p>语法：</p><ul><li><code>fs.rmdir(path, [options], callback)</code></li><li><code>fs.rmdirSync(path, [options])</code> 参数说明：</li><li><code>path</code>:文件夹路径</li><li><code>options</code>:选项配置（可选）</li><li><code>callback</code>:操作后的回调</li></ul><p>示例代码：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 fs 模块
const fs = require(&#39;fs&#39;)

// 2.删除文件夹
// fs.rmdir(&#39;./文件&#39;, error =&gt; {
//     if (error) {
//         console.log(&#39;删除文件夹失败&#39;, error)
//         return;
//     }
//     console.log(&#39;删除文件夹成功&#39;)
// })

// 3.递归删除文件夹
// 递归删除文件夹失败 [Error: ENOTEMPTY: directory not empty, rmdir &#39;E:\JavaEE\frontend\nodejs-study\2-fs文件系统\a&#39;]

// 不推荐使用
// fs.rmdir(&#39;./a&#39;, {recursive: true}, error =&gt; {
//     if (error) {
//         console.log(&#39;递归删除文件夹失败&#39;, error)
//         return ;
//     }
//     console.log(&#39;递归删除文件夹成功&#39;)
// })

// 推荐使用
fs.rm(&#39;./a&#39;, {recursive: true}, error =&gt; {
    if (error) {
        console.log(&#39;递归删除文件失败&#39;, error)
        return;
    }
    console.log(&#39;递归删除文件成功&#39;)
})

//同步递归删除文件夹
fs.rmdirSync(&#39;./a&#39;, {recursive: true})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h3 id="_2-6-查看资源状态" tabindex="-1"><a class="header-anchor" href="#_2-6-查看资源状态" aria-hidden="true">#</a> 2.6 查看资源状态</h3><p>在 <code>Node.js</code> 中，可以使用 <code>stat</code> 或 <code>statSync</code> 来查看资源的详细信息</p><p>语法：</p><ul><li><code>fs.stat(path, [options], callback)</code></li><li><code>fs.statSync(path, [options])</code></li></ul><p>参数说明：</p><ul><li><code>path</code>:文件夹路径</li><li><code>options</code>:选项配置（可选）</li><li><code>callback</code>:操作后的回调</li></ul><p>示例代码：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 fs 模块
const fs = require(&#39;fs&#39;)

// 2.stat 方法 status 的缩写：状态
fs.stat(&#39;./观书有感.txt&#39;, (error, data) =&gt; {
    if (error) {
        console.log(&#39;操作失败&#39;, error)
        return;
    }
    // Stats {
    //     dev: 985301708,
    //     mode: 33206,
    //     nlink: 1,
    //     uid: 0,
    //     gid: 0,
    //     rdev: 0,
    //     blksize: 4096,
    //     ino: 281474979770305,
    //     size: 92,
    //     blocks: 0,
    //     atimeMs: 1684373309132.9426,
    //     mtimeMs: 1684289136772.1648,
    //     ctimeMs: 1684289136772.1648,
    //     birthtimeMs: 1684289136770.7136,
    //     atime: 2023 - 05 - 18 T01: 28: 29.133 Z,
    //     mtime: 2023 - 05 - 17 T02: 05: 36.772 Z,
    //     ctime: 2023 - 05 - 17 T02: 05: 36.772 Z,
    //     birthtime: 2023 - 05 - 17 T02: 05: 36.771 Z
    // }
    console.log(data)
    console.log(data.isFile())
    console.log(data.isDirectory())
})

// 3.同步获取状态
let data = fs.statSync(&#39;./观书有感.txt&#39;);
console.log(data)
console.log(data.isFile())
console.log(data.isDirectory())
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>结果值对象结构：</p><ul><li><code>size</code>:文件体积</li><li><code>birthtime</code>:创建时间</li><li><code>mtime</code>:最后修改时间</li><li><code>isFile</code>:检测是否为文件</li><li><code>isDirectory</code>:检测是否为文件夹</li></ul><h3 id="_2-7-相对路径问题" tabindex="-1"><a class="header-anchor" href="#_2-7-相对路径问题" aria-hidden="true">#</a> 2.7 相对路径问题</h3><p><code>fs</code> 模块对资源进行操作时，路径的写法有两种：</p><ul><li>相对路径 <ul><li><code>./座右铭.txt</code>:当前目录下的座右铭.txt</li><li><code>座右铭.txt</code>:等效于上面的写法</li><li><code>../座右铭.txt</code>:当前目录的上一级目录中的座右铭.txt</li></ul></li><li>绝对路径 <ul><li><code>D:/Program Files</code>:<code>windows</code> 系统下的绝对路径</li><li><code>/usr/bin</code>:<code>Linux</code> 系统下的绝对路径</li></ul></li></ul><blockquote><p>相对路径中所谓的当前目录，指的是<strong>命令行的工作目录</strong>，而并非是文件的所在目录。所以当命令行的工作目录与文件所在目录不一致时，会出现一些 <code>BUG</code>。</p></blockquote><h3 id="_2-8-dirname" tabindex="-1"><a class="header-anchor" href="#_2-8-dirname" aria-hidden="true">#</a> 2.8 <code>__dirname</code></h3><p><code>__dirname</code> 与 <code>require</code> 类似，都是 <code>Node.js</code> 环境中的 &#39;全局&#39; 变量 <code>__dirname</code> 保存着<strong>当前文件所在目录的绝对路径</strong>，可以使用 <code>__dirname</code> 与文件名拼接成绝对路径 代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>let data = fs.readFileSync(__dirname + &#39;/data.txt&#39;);
console.log(data);
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>使用 <code>fs</code> 模块的时候，尽量使用 <code>__dirname</code> 将路径转化为绝对路径，这样可以避免相对路径产生的 <code>Bug</code></p></blockquote><h3 id="_2-9-练习" tabindex="-1"><a class="header-anchor" href="#_2-9-练习" aria-hidden="true">#</a> 2.9 练习</h3><p>实现文件复制的功能 代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>/**
 * 需求：
 *  复制【座右铭.txt】
 */

// 1.引入 fs 模块
const fs = require(&#39;fs&#39;);
// 全局对象，即 global 对象的属性，无须声明即可访问。它用于描述当前 Node 进程状态的对象，提供了一个与操作系统的简单接口。
const process = require(&#39;process&#39;)

// 方式一：使用 readFile
// 2.读取文件
// let data = fs.readFileSync(&#39;./座右铭.txt&#39;);

// // 3.写入文件
// fs.writeFileSync(&#39;./座右铭-2.txt&#39;, data);

// // 查看系统耗费内存
// // rss: 19795968 字节
// console.log(process.memoryUsage())

// 方式二：使用流式操作
// 2.创建流式读取
let rs = fs.createReadStream(&#39;./座右铭.txt&#39;);

// 3.创建流式写入
let ws = fs.createWriteStream(&#39;./座右铭-3.txt&#39;);

// // 4.绑定 data 事件
// rs.on(&#39;data&#39;, chunk =&gt; {
//     ws.write(chunk);
// })

// // 5.绑定 end 事件
// rs.on(&#39;end&#39;, () =&gt; {
//     // rss: 20885504 字节 相比于同步的方式占用内存会比较小
//     console.log(process.memoryUsage())
// })

// 4.使用 pipe(管道) 可直接复制
rs.pipe(ws)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h2 id="_3-path-模块" tabindex="-1"><a class="header-anchor" href="#_3-path-模块" aria-hidden="true">#</a> 3. <code>path</code> 模块</h2><p><code>path</code> 模块提供了<strong>操作路径</strong>的功能，有如下几个较为常用的 <code>API</code>：</p><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td>path.resolve</td><td>拼接规范的绝对路径常用</td></tr><tr><td>path.sep</td><td>获取操作系统的路径分隔符</td></tr><tr><td>path.parse</td><td>解析路径并返回对象</td></tr><tr><td>path.basename</td><td>获取路径的基础名称</td></tr><tr><td>path.dirname</td><td>获取路径的目录名</td></tr><tr><td>path.extname</td><td>获得路径的扩展名</td></tr></tbody></table><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 path、fs 模块
const path = require(&#39;path&#39;)
const fs = require(&#39;fs&#39;)

// 写入文件
// fs.writeFileSync(__dirname + &#39;/index.html&#39;, &#39;love&#39;)
// E:\JavaEE\frontend\nodejs-study\3-path模块/index.html
// console.log(__dirname + &#39;/index.html&#39;)

// 使用 path 解决
// E:\JavaEE\frontend\nodejs-study\3-path模块\index.html
console.log(path.resolve(__dirname, &#39;./index.html&#39;))
// E:\JavaEE\frontend\nodejs-study\3-path模块\index.html
console.log(path.resolve(__dirname, &#39;index.html&#39;))
// E:\index.html\test
console.log(path.resolve(__dirname, &#39;/index.html&#39;, &#39;./test&#39;))

// 分隔符
// \ windows:\ linux:/
console.log(path.sep)

// parse 方法 __dirname &#39;全局变量&#39;
// __filename &#39;全局变量&#39; 文件的绝对路径
console.log(__filename)

let str = &#39;E:\\JavaEE\\frontend\\nodejs-study\\3-path模块\\index.html&#39;;

// {
//     root: &#39;E:\\&#39;,
//     dir: &#39;E:\\JavaEE\\frontend\\nodejs-study\\3-path模块&#39;,
//     base: &#39;index.html&#39;,
//     ext: &#39;.html&#39;,
//     name: &#39;index&#39;
// }
console.log(path.parse(str))

// index.html
console.log(path.basename(str))

// E:\JavaEE\frontend\nodejs-study\3-path模块
console.log(path.dirname(str))

// .html
console.log(path.extname(str))
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h2 id="_4-http-模块" tabindex="-1"><a class="header-anchor" href="#_4-http-模块" aria-hidden="true">#</a> 4. <code>http</code> 模块</h2><h3 id="_4-1-创建-http-服务" tabindex="-1"><a class="header-anchor" href="#_4-1-创建-http-服务" aria-hidden="true">#</a> 4.1 创建 <code>http</code> 服务</h3><h4 id="_4-1-1-操作步骤" tabindex="-1"><a class="header-anchor" href="#_4-1-1-操作步骤" aria-hidden="true">#</a> 4.1.1 操作步骤</h4><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 http 模块
const http = require(&#39;http&#39;)

// 2.创建 http 服务
const server = http.createServer((request, response) =&gt; {

    // response.end 设置响应体 必须要返回，且只能返回一次
    // 多个 response.end 报错 Error [ERR_STREAM_WRITE_AFTER_END]: write after end
    // response.end(&quot;hello world&quot;)
    // response.end(&quot;hello world&quot;)

    // 解决中文乱码
    response.setHeader(&#39;content-type&#39;, &#39;text/html;charset=utf-8&#39;)
    response.end(&#39;你好，世界&#39;)
})

// 3.启动服务并监听端口
server.listen(9000, () =&gt; {
    console.log(&#39;http 服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><blockquote><p><code>http.createServer</code> 里的回调函数的执行时机：当接收到 <code>http</code> 请求的时候，就会执行</p></blockquote><h4 id="_4-1-2-测试" tabindex="-1"><a class="header-anchor" href="#_4-1-2-测试" aria-hidden="true">#</a> 4.1.2 测试</h4><p>浏览器请求对应端口 <code>http://127.0.0.1:9000</code></p><h4 id="_4-1-3-注意事项" tabindex="-1"><a class="header-anchor" href="#_4-1-3-注意事项" aria-hidden="true">#</a> 4.1.3 注意事项</h4><ul><li>命令行 <code>ctrl + c</code> 停止服务</li><li>当服务启动后，更新代码必须重启服务才能生效</li><li>响应内容中文乱码的解决办法<div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>response.setHeader(&#39;content-type&#39;, &#39;text/html;charset=utf-8&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li>端口号被占用 <ul><li>关闭当前正在运行监听端口的服务</li><li>修改其他端口号</li><li>如果端口被其他程序占用，可以使用<strong>资源监视器</strong>找到占用端口的程序，然后使用<strong>任务管理器</strong>关闭对应的程序</li></ul></li></ul><h3 id="_4-2-获取-http-请求报文" tabindex="-1"><a class="header-anchor" href="#_4-2-获取-http-请求报文" aria-hidden="true">#</a> 4.2 获取 <code>http</code> 请求报文</h3><p>想要获取请求的数据，需要通过 <code>request</code> 对象</p><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td>request.method</td><td>请求方法</td></tr><tr><td>request.httpVersion</td><td>请求版本</td></tr><tr><td>request.url</td><td>请求路径</td></tr><tr><td>require(&#39;url&#39;).parse(request.url).pathname</td><td>URL 路径</td></tr><tr><td>require(&#39;url&#39;).parse(request.url, true).query</td><td>URL 查询字符串</td></tr><tr><td>request.headers</td><td>请求头</td></tr><tr><td>request.on(&#39;data&#39;, function(chunk){})<br>request.on(&#39;end&#39;, function(){});</td><td>请求体</td></tr></tbody></table><p>注意事项：</p><ul><li><code>request.url</code> 只能获取路径以及查询字符串，无法获取 <code>URL</code> 中的域名以及协议的内容</li><li><code>request.headers</code> 将请求信息转化成一个对象，并将属性名都转化成了『小写』</li><li>关于路径：如果访问网站的时候，只填写了 <code>IP</code> 地址或者是域名信息，此时请求的路径为『/』</li><li>关于 <code>favicon.ico</code>：这个请求是属于浏览器自动发送的请求</li></ul><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 http 模块
const http = require(&#39;http&#39;)

// 2.创建服务
const server = http.createServer((request, response) =&gt; {
    // 获取请求的方法
    console.log(request.method)
    // 获取请求的 url
    console.log(request.url)
    // 获取 http 协议版本号
    console.log(request.httpVersion)
    // 获取请求头
    console.log(request.headers)
    // 获取请求主机地址
    console.log(request.headers.host)

    response.end(&quot;hello world&quot;)
})

// 3.启动服务并监听端口‘
server.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 http 模块
const http = require(&#39;http&#39;)

// 2.创建服务
const server = http.createServer((request, response) =&gt; {

    // 1.声明一个变量
    let body = &#39;&#39;

    // 2.绑定 data 事件
    request.on(&#39;data&#39;, chunk =&gt; {
        body += chunk
    })

    // 3.绑定 end 事件
    request.on(&#39;end&#39;, () =&gt; {
        console.log(body)
        response.end(&quot;hello world&quot;)
    })

})

// 3.启动服务并监听端口‘
server.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 http 模块
const http = require(&#39;http&#39;)

// 1.导入 url 模块
const url = require(&#39;url&#39;)

// 2.创建服务
const server = http.createServer((request, response) =&gt; {
    // request: http://127.0.0.1:9000/search?keyword=123&amp;username=chen

    // 2.解析 request.url
    // let res1 = url.parse(request.url)
    // Url {
    //     protocol: null,
    //     slashes: null,
    //     auth: null,
    //     host: null,
    //     port: null,
    //     hostname: null,
    //     hash: null,
    //     search: &#39;?keyword=123&amp;username=chen&#39;,
    //     query: &#39;keyword=123&amp;username=chen&#39;,
    //     pathname: &#39;/search&#39;,
    //     path: &#39;/search?keyword=123&amp;username=chen&#39;,
    //     href: &#39;/search?keyword=123&amp;username=chen&#39;
    // }
    // console.log(res1)


    // let res2 = url.parse(request.url, true)
    // Url {
    //     protocol: null,
    //     slashes: null,
    //     auth: null,
    //     host: null,
    //     port: null,
    //     hostname: null,
    //     hash: null,
    //     search: &#39;?keyword=123&amp;username=chen&#39;,
    //     query: [Object: null prototype] {
    //         keyword: &#39;123&#39;,
    //         username: &#39;chen&#39;
    //     },
    //     pathname: &#39;/search&#39;,
    //     path: &#39;/search?keyword=123&amp;username=chen&#39;,
    //     href: &#39;/search?keyword=123&amp;username=chen&#39;
    // }
    // console.log(res2)

    let res = url.parse(request.url, true)
    // 请求路径
    // /search
    console.log(res.pathname)
    // 查询字符串
    // 123
    console.log(res.query.keyword)

    response.end(&#39;hello world&#39;)
})

// 3.启动服务并监听端口‘
server.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 http 模块
const http = require(&#39;http&#39;)

// 2.创建服务
const server = http.createServer((request, response) =&gt; {
    // request: http://127.0.0.1:9000/search?keyword=123&amp;username=chen

    // 第二个参数要写完整 http://127.0.0.1  只写 ip 会报错
    let url = new URL(request.url, &#39;http://127.0.0.1&#39;)

    // URL {
    //     href: &#39;http://127.0.0.1/search?keyword=123&amp;username=chen&#39;,
    //     origin: &#39;http://127.0.0.1&#39;,
    //     protocol: &#39;http:&#39;,
    //     username: &#39;&#39;,
    //     password: &#39;&#39;,
    //     host: &#39;127.0.0.1&#39;,
    //     hostname: &#39;127.0.0.1&#39;,
    //     port: &#39;&#39;,
    //     pathname: &#39;/search&#39;,
    //     search: &#39;?keyword=123&amp;username=chen&#39;,
    //     searchParams: URLSearchParams {
    //         &#39;keyword&#39; =&gt; &#39;123&#39;, &#39;username&#39; =&gt; &#39;chen&#39;
    //     },
    //     hash: &#39;&#39;
    // }
    // console.log(url)

    // 请求路径
    console.log(url.pathname)

    // 请求路径参数
    console.log(url.searchParams.get(&#39;keyword&#39;))

    response.end(&#39;hello world&#39;)
})

// 3.启动服务并监听端口‘
server.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h3 id="_4-3-设置-http-响应报文" tabindex="-1"><a class="header-anchor" href="#_4-3-设置-http-响应报文" aria-hidden="true">#</a> 4.3 设置 <code>http</code> 响应报文</h3><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td>response.statusCode</td><td>设置响应状态码</td></tr><tr><td>response.statusMessage</td><td>设置响应状态描述</td></tr><tr><td>response.setHeader(&#39;键名&#39;, &#39;键值&#39;)</td><td>设置响应头信息</td></tr><tr><td>response.write(&#39;xx&#39;)response.end(&#39;xxx&#39;)</td><td>设置响应体</td></tr></tbody></table><p><code>write</code> 和 <code>end</code> 的两种使用情况：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.write 和 end 的结合使用 响应体相对分散
response.write(&#39;xx&#39;);
response.write(&#39;xx&#39;);
response.write(&#39;xx&#39;);

 //每一个请求，在处理的时候必须要执行 end 方法，且只能执行一次
response.end();

// 2.单独使用 end 方法 响应体相对集中
response.end(&#39;xxx&#39;);
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入 http 模块
const http = require(&#39;http&#39;)

// 2.创建服务
const server = http.createServer((request, response) =&gt; {

    // 1.设置响应状态码
    // response.statusCode = 200
    // response.statusCode = 404

    // 2.设置响应信息 不常用
    // response.statusMessage = &#39;hello world&#39;

    // 3.设置响应头
    response.setHeader(&#39;content-type&#39;, &#39;text/html;charset=utf-8&#39;)
    response.setHeader(&#39;Server&#39;, &#39;Node.js&#39;)
    response.setHeader(&#39;myHeader&#39;, &#39;myHeader&#39;)
    response.setHeader(&#39;test&#39;, [&#39;love&#39;, &#39;love&#39;, &#39;love&#39;])

    // 4.设置响应体
    response.write(&#39;love\r\n&#39;)
    response.write(&#39;love\r\n&#39;)
    response.write(&#39;love\r\n&#39;)
    response.write(&#39;love\r\n&#39;)

    response.end(&#39;hello world&#39;)

})

// 3.启动服务并监听端口‘
server.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h3 id="_4-4-练习" tabindex="-1"><a class="header-anchor" href="#_4-4-练习" aria-hidden="true">#</a> 4.4 练习</h3><h4 id="_4-4-1-http-请求练习" tabindex="-1"><a class="header-anchor" href="#_4-4-1-http-请求练习" aria-hidden="true">#</a> 4.4.1 <code>http</code> 请求练习</h4><p>需求： 当请求方式为 <code>get</code> 请求时，请求路径为 <code>/login</code> 返回 <code>login</code> 当请求方式为 <code>get</code> 请求时，请求路径为 <code>/register</code> 返回 <code>register</code></p><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>/**
 * 需求：
 *  当请求方式为 get 请求时，请求路径为 /login 返回 login
 *  当请求方式为 get 请求时，请求路径为 /register 返回 register
 */

// 1.引入 http 模块
const http = require(&#39;http&#39;)

// 2.创建服务
const server = http.createServer((request, response) =&gt; {

    // 请求方式
    let { method } = request

    // 请求路径
    let { pathname } = new URL(request.url, &#39;http://127.0.0.1&#39;)

    if (method === &#39;GET&#39; &amp;&amp; pathname === &#39;/login&#39;) {
        response.end(&#39;login&#39;)
    } else if (method === &#39;GET&#39; &amp;&amp; pathname === &#39;/register&#39;) {
        response.end(&#39;register&#39;)
    } else {
        response.end(&#39;hello world&#39;)
    }
})

// 3.启动服务并监听端口‘
server.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h4 id="_4-4-1-http-响应练习" tabindex="-1"><a class="header-anchor" href="#_4-4-1-http-响应练习" aria-hidden="true">#</a> 4.4.1 <code>http</code> 响应练习</h4><p>需求： 回一个 4 行 3 列的表格，且要求表格有隔行换色效果，且点击单元格能高亮显示</p><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>/**
 * 需求：
 *  返回一个4行3列的表格，且要求表格有隔行换色效果，且点击单元格能高亮显示
 */


// 1.引入 http 模块
const http = require(&#39;http&#39;)

// 2.创建服务
const server = http.createServer((request, response) =&gt; {

    response.end(`
    &lt;!DOCTYPE html&gt;
        &lt;html lang=&quot;en&quot;&gt;

        &lt;head&gt;
            &lt;meta charset=&quot;UTF-8&quot;&gt;
            &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
            &lt;title&gt;Document&lt;/title&gt;
            &lt;style&gt;
                td {
                    padding: 20px 40px;
                }

                table tr:nth-child(odd) {
                    background: rgb(179, 165, 201);
                }

                table tr:nth-child(even) {
                    background: #fcb;
                }

                table,
                td {
                    border-collapse: collapse;
                }
            &lt;/style&gt;
        &lt;/head&gt;

        &lt;body&gt;
            &lt;table border=&quot;1&quot;&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;/td&gt;
                &lt;/tr&gt;
            &lt;/table&gt;
            &lt;script&gt;
                //获取所有的 td
                let tds = document.querySelectorAll(&#39;td&#39;);
                //遍历
                tds.forEach(item =&gt; {
                    item.onclick = function () {
                        this.style.background = &#39;#222&#39;;
                    }
                })
            &lt;/script&gt;
        &lt;/body&gt;

        &lt;/html&gt;
    `)

})

// 3.启动服务并监听端口‘
server.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br></div></div><p>代码优化：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>/**
 * 需求：
 *  返回一个4行3列的表格，且要求表格有隔行换色效果，且点击单元格能高亮显示
 */


// 1.引入 http 模块
const http = require(&#39;http&#39;)

// 1.引入 fs 模块
const fs = require(&#39;fs&#39;)

// 2.创建服务
const server = http.createServer((request, response) =&gt; {

    // 2.读取文件内容
    let file = fs.readFileSync(__dirname + &#39;/10-table.html&#39;)

    response.end(file)

})

// 3.启动服务并监听端口‘
server.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="_4-5-静态资源服务" tabindex="-1"><a class="header-anchor" href="#_4-5-静态资源服务" aria-hidden="true">#</a> 4.5 静态资源服务</h3><blockquote><p>静态资源是指<strong>内容长时间不发生改变的资源</strong>，例如图片、视频、<code>CSS</code> 文件、<code>JS</code> 文件、<code>HTML</code> 文件、字体文件等。</p></blockquote><blockquote><p>动态资源是指<strong>内容经常更新的资源</strong>，例如百度首页、网易首页、京东搜索列表页面等。</p></blockquote><h4 id="_4-5-1-网页中的-url" tabindex="-1"><a class="header-anchor" href="#_4-5-1-网页中的-url" aria-hidden="true">#</a> 4.5.1 网页中的 <code>URL</code></h4><blockquote><p>网页中的 <code>URL</code> 主要分为两大类：相对路径与绝对路径</p></blockquote><p>绝对路径可靠性强，而且相对容易理解，在项目中运用较多</p><table><thead><tr><th>形式</th><th>特点</th></tr></thead><tbody><tr><td>http://xxx.com/web</td><td>直接向目标资源发送请求，容易理解，网站的外链会用到此形式</td></tr><tr><td>//xxx.com/web</td><td>与页面 <code>URL</code> 的协议拼接形成完整 <code>URL</code> 再发送请求，大型网站用的比较多</td></tr><tr><td>/web</td><td>与页面 <code>URL</code> 的协议、主机名、端口拼接形成完整 <code>URL</code> 再发送请求，中小型网站</td></tr></tbody></table><p>相对路径在发送请求时，需要与当前页面 <code>URL</code> 路径进行计算，得到完整 <code>URL</code> 后，再发送请求 例如当前网页 <code>URL</code> 为 <code>http://www.xxx.com/course/h5.html</code></p><table><thead><tr><th>形式</th><th>最终的 <code>URL</code></th></tr></thead><tbody><tr><td>./css/app.css</td><td>http://www.xxx.com/course/css/app.css</td></tr><tr><td>js/app.js</td><td>http://www.xxx.com/course/js/app.js</td></tr><tr><td>../img/logo.png</td><td>http://www.xxx.com/img/logo.png</td></tr><tr><td>../../mp4/show.mp4</td><td>http://www.atguigu.com/mp4/show.mp4</td></tr></tbody></table><h4 id="_4-5-2-设置资源类型-mime-类型" tabindex="-1"><a class="header-anchor" href="#_4-5-2-设置资源类型-mime-类型" aria-hidden="true">#</a> 4.5.2 设置资源类型（<code>mime</code> 类型）</h4><blockquote><p>媒体类型（通常称为 <code>Multipurpose Internet Mail Extensions</code> 或 <code>MIME</code> 类型 ）是一种标准，用来表示文档、文件或字节流的性质和格式。</p></blockquote><p><code>mime</code> 类型结构： <code>[type]/[subType]</code></p><p>例如： <code>text/html</code> <code>text/css</code> <code>image/jpeg</code> <code>image/png</code> <code>application/json</code></p><p><code>http</code> 服务可以设置响应头 <code>Content-Type</code> 来表明响应体的 <code>mime</code> 类型，浏览器会根据该类型决定如何处理资源 下面是常见文件对应的 <code>mime</code> 类型：</p><div class="language-Json ext-Json line-numbers-mode"><pre class="language-Json"><code>{
    html: &#39;text/html&#39;,
    css: &#39;text/css&#39;,
    js: &#39;text/javascript&#39;,
    png: &#39;image/png&#39;,
    jpg: &#39;image/jpeg&#39;,
    gif: &#39;image/gif&#39;,
    mp4: &#39;video/mp4&#39;,
    mp3: &#39;audio/mpeg&#39;,
    json: &#39;application/json&#39;
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p>说明：对于未知的资源类型，可以选择 <code>application/octet-stream</code> 类型，浏览器在遇到该类型的响应时，会对响应体内容进行独立存储，也就是<strong>下载</strong>。</p></blockquote><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>/**
 * 需求：
 *  根据不同的请求路径，返回不同的文件
 */

// 1.引入模块
const http = require(&#39;http&#39;)
const fs = require(&#39;fs&#39;)

// 2.创建服务
const server = http.createServer((request, response) =&gt; {

    // 获取请求路径
    let { pathname } = new URL(request.url, &#39;https://127.0.0.1:9000&#39;)
    if (pathname === &#39;/&#39;) {
        // 获取要响应的文件
        let data = fs.readFileSync(__dirname + &#39;/11-table.html&#39;)
        // 设置响应
        response.end(data)
    } else if (pathname === &#39;/index.css&#39;) {
        // 获取要响应的文件
        let data = fs.readFileSync(__dirname + &#39;/index.css&#39;)
        // 设置响应
        response.end(data)
    } else if (pathname === &#39;/index.js&#39;) {
        // 获取要响应的文件
        let data = fs.readFileSync(__dirname + &#39;/index.js&#39;)
        // 设置响应
        response.end(data)
    } else {
        response.end(`&lt;h1&gt;404 Not Found&lt;/h1&gt;`)
    }
})

// 3.启动服务，并监听端口‘
server.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>代码优化：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>/**
 * 需求：
 *  创建一个 HTTP 服务，端口为 9000，满足如下需求
 *      GET  /index.html        响应  page/index.html 的文件内容
 *      GET  /css/app.css       响应  page/css/app.css 的文件内容
 *      GET  /images/logo.png   响应  page/images/logo.png 的文件内容
 */

// 1.引入模块
const http = require(&#39;http&#39;)
const fs = require(&#39;fs&#39;)
const path = require(&#39;path&#39;)

// 2.创建服务
const server = http.createServer((request, response) =&gt; {

    // 获取文件根路径
    let root = path.resolve(__dirname + &#39;/page&#39;)
    // 获取文件路径
    let { pathname } = new URL(request.url, &#39;https://127.0.0.1:9000&#39;)
    // 拼接文件路径
    let filePath = root + pathname

    // 获取文件
    fs.readFile(filePath, (error, data) =&gt; {
        // 设置字符集，解决打开文件中文乱码的问题
        response.setHeader(&#39;content-type&#39;, &#39;text/html;charset=utf-8&#39;)

        if (error) {
            response.end(&#39;读取文件错误&#39;)
        }

        response.end(data)
        return;
    })
})

// 3.启动服务并监听端口
server.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>代码优化：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>/**
 * 需求：
 *  创建一个 HTTP 服务，端口为 9000，满足如下需求
 *      GET  /index.html        响应  page/index.html 的文件内容
 *      GET  /css/app.css       响应  page/css/app.css 的文件内容
 *      GET  /images/logo.png   响应  page/images/logo.png 的文件内容
 *  根据不同的文件类型，返回不同的类型
 */

// 1.引入模块
const http = require(&#39;http&#39;)
const fs = require(&#39;fs&#39;)
const path = require(&#39;path&#39;)

// 声明一个变量
let mimes = {
    html: &#39;text/html&#39;,
    css: &#39;text/css&#39;,
    js: &#39;text/javascript&#39;,
    png: &#39;image/png&#39;,
    jpg: &#39;image/jpeg&#39;,
    gif: &#39;image/gif&#39;,
    mp4: &#39;video/mp4&#39;,
    mp3: &#39;audio/mpeg&#39;,
    json: &#39;application/json&#39;
}

// 2.创建服务
const server = http.createServer((request, response) =&gt; {

    // 获取文件根路径
    let root = path.resolve(__dirname + &#39;/page&#39;)
    // 获取文件路径
    let {
        pathname
    } = new URL(request.url, &#39;https://127.0.0.1:9000&#39;)
    // 拼接文件路径
    let filePath = root + pathname

    // 获取文件
    fs.readFile(filePath, (error, data) =&gt; {

        if (error) {
            // 设置字符集，解决打开文件中文乱码的问题
            response.setHeader(&#39;content-type&#39;, &#39;text/html;charset=utf-8&#39;)
            switch(error.code) {
                case &#39;ENOENT&#39;:
                    response.statusCode = 404
                    response.end(`&lt;h1&gt;404 Not Found&lt;/h1&gt;`)
                    break;
                case &#39;EPERM&#39;:
                    response.statusCode = 403
                    response.end(`&lt;h1&gt;403 Forbidden&lt;/h1&gt;`)
                    break;
                default:
                    response.statusCode = 500
                    response.end(`&lt;h1&gt;500 Internal &lt;/h1&gt;`)
                    break;
            }
            return;
        }

        // 获取文件后缀
        let ext = path.extname(filePath).slice(1)
        // 获取对应的类型
        let type = mimes[ext]
        if (type) {
            // 匹配到了
            if (ext === &#39;html&#39;) {
                response.setHeader(&#39;content-type&#39;, type + &#39;;charset=utf-8&#39;)
            } else {
                response.setHeader(&#39;content-type&#39;, type)
            }
        } else {
            // 没有匹配到
            // 这种返回格式可以实现下载效果
            response.setHeader(&#39;content-type&#39;, &#39;application/octet-stream&#39;)
        }

        response.end(data)
    })
})

// 3.启动服务并监听端口
server.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br></div></div><h4 id="_4-5-3-get-和-post-请求的区别" tabindex="-1"><a class="header-anchor" href="#_4-5-3-get-和-post-请求的区别" aria-hidden="true">#</a> 4.5.3 <code>GET</code> 和 <code>POST</code> 请求的区别</h4><ul><li><code>GET</code> 和 <code>POST</code> 是 <code>http</code> 协议请求的两种方式。</li><li><code>GET</code> 主要用来获取数据，<code>POST</code> 主要用来提交数据</li><li><code>GET</code> 带参数请求是将参数缀到 <code>URL</code> 之后，在地址栏中输入 <code>URL</code> 访问网站就是 <code>GET</code> 请求，<code>POST</code> 带参数请求是将参数放到请求体中</li><li><code>POST</code> 请求相对 <code>GET</code> 安全一些，因为在浏览器中参数会暴露在地址栏</li><li><code>GET</code> 请求大小有限制，一般为 <code>2K</code>，而 <code>POST</code> 请求则没有大小限制</li></ul><h2 id="_5-模块化" tabindex="-1"><a class="header-anchor" href="#_5-模块化" aria-hidden="true">#</a> 5. 模块化</h2><h3 id="_5-1-基础概念" tabindex="-1"><a class="header-anchor" href="#_5-1-基础概念" aria-hidden="true">#</a> 5.1 基础概念</h3><blockquote><p>模块化：将一个复杂的程序文件依据一定规则（规范）拆分成多个文件的过程称之为<strong>模块化</strong>。</p></blockquote><blockquote><p>模块：拆分出的每个文件就是一个模块，模块的内部数据是私有的，不过模块可以暴露内部数据以便其他模块使用</p></blockquote><blockquote><p>模块化项目：编码时是按照模块一个一个编码的， 整个项目就是一个模块化的项目</p></blockquote><p>模块化好处：</p><ul><li>防止命名冲突</li><li>高复用性</li><li>高维护性</li></ul><h3 id="_5-2-模块暴露" tabindex="-1"><a class="header-anchor" href="#_5-2-模块暴露" aria-hidden="true">#</a> 5.2 模块暴露</h3><p>模块暴露的方式有两种：</p><ul><li><code>module.exports = value</code></li><li><code>exports.name = value</code></li></ul><blockquote><p>说明：</p><ul><li><code>module.exports</code> 可以暴露任意数据和方法</li><li>不能使用 <code>exports = value</code> 的形式暴露，模块内部 <code>module</code> 与 <code>exports</code> 具有隐式关系 <code>exports = module.exports = {}</code>,<code>require</code> 返回的是目标模块中 <code>module.exports</code> 的值</li></ul></blockquote><p>代码示例： <code>hello.js</code></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>const type = &#39;hello world&#39;

function helloWorld() {
    console.log(&#39;你好，世界....&#39;)
}

// 暴露数据、方法
module.exports = {
    type,
    helloWorld
}

// exports.type = type
// module.exports = helloWorld

// exports.type = type
// exports.helloWorld = helloWorld
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><code>index.js</code></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 引入自定应模块
const hello = require(&#39;./hello&#39;)

// 调用模块数据/方法
console.log(hello)
hello.helloWorld()
// hello()
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_5-3-模块导入" tabindex="-1"><a class="header-anchor" href="#_5-3-模块导入" aria-hidden="true">#</a> 5.3 模块导入</h3><p>在模块中使用 <code>require</code> 传入文件路径即可引入文件 <code>require</code> 使用的一些注意事项：</p><ul><li>对于自己创建的模块，导入时路径建议写<strong>相对路径</strong>，且不能省略 <code>./</code> 和 <code>../</code></li><li><code>js</code> 和 <code>json</code> 文件导入时可以不用写后缀，<code>c/c++</code> 编写的 <code>node</code> 扩展文件也可以不写后缀，但是一般用不到</li><li>如果导入其他类型的文件，会以 <code>js</code> 文件进行处理</li><li>如果导入的路径是个文件夹，则会首先检测该文件夹下 <code>package.json</code> 文件中 <code>main</code> 属性对应的文件，如果存在则导入，反之如果文件不存在会报错。如果 <code>main</code> 属性不存在，或者 <code>package.json</code> 不存在，则会尝试导入文件夹下的 <code>index.js</code> 和 <code>index.json</code>，如果还是没找到，就会报错</li><li>导入 <code>node.js</code> 内置模块时，直接 <code>require</code> 模块的名字即可，无需加 <code>./</code> 和 <code>../</code></li></ul><h3 id="_5-4-模块导入流程" tabindex="-1"><a class="header-anchor" href="#_5-4-模块导入流程" aria-hidden="true">#</a> 5.4 模块导入流程</h3><p><code>require</code> 导入<strong>自定义模块</strong>的基本流程：</p><ol><li>将相对路径转为绝对路径，定位目标文件</li><li>缓存检测</li><li>读取目标文件代码</li><li>包裹为一个函数并执行（自执行函数），通过 <code>arguments.callee.toString()</code> 查看自执行函数</li><li>缓存模块的值</li><li>返回 <code>module.exports</code> 的值</li></ol><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>/**
 * require 导入原理 伪代码
 */

// 1.引入模块
const path = require(&#39;path&#39;)
const fs = require(&#39;fs&#39;)

// 2.定义一个缓存数组
let caches = []

function require(file) {
    // 3.将相对路径转成绝对路径
    let absolutePath = path.resolve(__dirname, file)

    // 4.检测是否有缓存
    if (caches[absolutePath]) {
        return caches[absolutePath]
    }

    // 5.读取文件的代码
    let code = fs.readFileSync(absolutePath).toString()
    // 6.封装一个函数
    let module = {}
    let exports = module.exports = {}

    (function (exports, require, module, __fileName, __dirname) {
        const test = {
            name: &#39;hello world&#39;
        }
        module.exports = test

        console.log(arguments.callee.toString())
    })(exports, require, module, __filename, __dirname)

    // 7.缓存结果
    caches[absolutePath] = module.exports

    // 7.返回 module.exports 的值
    return module.exports
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h2 id="_6-包管理工具" tabindex="-1"><a class="header-anchor" href="#_6-包管理工具" aria-hidden="true">#</a> 6. 包管理工具</h2><h3 id="_6-1-基础概念" tabindex="-1"><a class="header-anchor" href="#_6-1-基础概念" aria-hidden="true">#</a> 6.1 基础概念</h3><p>包：英文单词是 <code>package</code>，代表了一组特定功能的源码集合 包管理工具：管理<strong>包</strong>的应用软件，可以对<strong>包</strong>进行下载安装、更新、删除、上传等操作。借助包管理工具，可以快速开发项目，提升开发效率。包管理工具是一个通用的概念，很多编程语言都有包管理工具，所以 掌握好包管理工具非常重要</p><p>常用的包管理工具：</p><ul><li><code>npm</code></li><li><code>cnpm</code></li><li><code>yarn</code></li><li><code>pnpm</code></li></ul><h3 id="_6-2-npm" tabindex="-1"><a class="header-anchor" href="#_6-2-npm" aria-hidden="true">#</a> 6.2 <code>npm</code></h3><blockquote><p><code>npm</code> 全称 <code>Node Package Manager</code>,翻译为中文意思是<strong>Node 的包管理工具</strong></p></blockquote><blockquote><p><code>npm</code> 是 <code>Node.js</code> 官方内置的包管理工具，是必须要掌握住的工具</p></blockquote><p>常见使用命令：</p><table><thead><tr><th>命令</th><th>说明</th></tr></thead><tbody><tr><td><code>npm -v</code></td><td>查看版本号</td></tr><tr><td><code>npm init</code></td><td>命令的作用是将文件夹初始化为一个包， 交互式创建 <code>package.json</code> 文件</td></tr><tr><td><code>npm s/search</code></td><td>搜索包</td></tr><tr><td><code>npm install</code> <code>npm i</code></td><td>下载安装包</td></tr><tr><td><code>npm i -g</code></td><td>全局安装</td></tr><tr><td><code>npm i &lt;包名@版本号&gt;</code></td><td>安装指定版本的包</td></tr><tr><td><code>npm remove</code> <code>npm r</code></td><td>局部删除依赖</td></tr><tr><td><code>npm remove -g</code></td><td>全局删除依赖</td></tr></tbody></table><h4 id="_6-2-1-初始化" tabindex="-1"><a class="header-anchor" href="#_6-2-1-初始化" aria-hidden="true">#</a> 6.2.1 初始化</h4><p>创建一个空目录，然后以此目录作为工作目录<strong>启动命令行工具</strong>，执行 <code>npm init</code>. <code>npm init</code> 命令的作用是将文件夹初始化为一个<strong>包</strong>，交互式创建 <code>package.json</code> 文件。 <code>package.json</code> 文件是包的配置文件，每个包都必须要有， <code>package.json</code> 文件内容：</p><div class="language-Json ext-Json line-numbers-mode"><pre class="language-Json"><code>{
    &quot;name&quot;: &quot;1-npm&quot;, #包的名字
    &quot;version&quot;: &quot;1.0.0&quot;, #包的版本
    &quot;description&quot;: &quot;&quot;, #包的描述
    &quot;main&quot;: &quot;index.js&quot;, #包的入口文件
    &quot;scripts&quot;: { #脚本配置
    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;
    },
    &quot;author&quot;: &quot;&quot;, #作者
    &quot;license&quot;: &quot;ISC&quot; #开源证书
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p>初始化的过程中还有一些注意事项：</p><ul><li><code>name</code> ( 包名 ) 不能使用中文、大写，默认值是文件夹的名称 ，所以文件夹名称也不能使用中文和大写</li><li><code>version</code> ( 版本号 )要求 <code>x.x.x</code> 的形式定义， <code>x</code> 必须是数字，默认值是 <code>1.0.0</code></li><li><code>ISC</code> 证书与 <code>MIT</code> 证书功能上是相同的，关于开源证书扩展阅读 http://www.ruanyifeng.com/blog/2011/05/how_to_choose_free_software_licenses.html</li><li><code>package.json</code> 可以手动创建与修改</li><li>使用 <code>npm init -y</code> 或者 <code>npm init --yes</code> 极速创建 <code>package.json</code></li></ul></blockquote><h3 id="_6-2-2-包管理" tabindex="-1"><a class="header-anchor" href="#_6-2-2-包管理" aria-hidden="true">#</a> 6.2.2 包管理</h3><p>通过 <code>npm install</code> 和 <code>npm i</code> 命令安装包</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm install uniq
npm i uniq
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>运行之后文件夹下会增加两个资源</p><ul><li><code>node_modules</code> 文件夹存放下载的包，<code>node_modules</code> 文件夹大多数情况都不会存入版本库(<code>git</code>、<code>svn</code> 等)</li><li><code>package-lock.json</code> 包的锁文件，用来锁定包的版本</li></ul><p>可以使用 <code>require</code> 导入 <code>npm</code> 包</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 导入 uniq 包
const uniq = require(&#39;uniq&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>require</code> 导入的基本流程：</p><ul><li>在当前文件夹下 <code>node_modules</code> 中寻找同名的文件夹</li><li>在上级目录中下的 <code>node_modules</code> 中寻找同名的文件夹，直至找到磁盘根目录</li></ul><p>安装的包，也称为<strong>依赖</strong>，<strong>依赖</strong>有<strong>生产依赖</strong>与<strong>开发依赖</strong>，二者的使用如下：</p><table><thead><tr><th>类型</th><th>命令</th><th>说明</th></tr></thead><tbody><tr><td>生产依赖</td><td><code>npm i -S uniq</code> <code>npm i --save uniq</code></td><td><code>-S</code> 等效于 <code>--save</code>,<code>-S</code> 是默认选项 包信息保存在 <code>package.json</code> 中 <code>dependencies</code> 属性</td></tr><tr><td>开发依赖</td><td><code>npm i -D less</code> <code>npm i --save-dev less</code></td><td><code>-D</code> 等效于 <code>--save-dev</code> 包信息保存在 <code>package.json</code> 中 <code>devDependencies</code> 属性</td></tr></tbody></table><p>项目中可能会遇到版本不匹配的情况，有时就需要安装指定版本的包，可以使用下面的命令</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm i jquery@1.11.2
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>可以执行安装选项 <code>-g</code> 进行全局安装</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm i -g nodemon
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>全局安装完成之后就可以在命令行的任何位置运行 <code>nodemon</code> 命令，该命令的作用是<strong>自动重启 Node 应用程序</strong></p><blockquote><p>说明：</p><ul><li>全局安装的命令不受工作目录位置影响</li><li>可以通过 <code>npm root -g</code> 可以查看全局安装包的位置</li><li>不是所有的包都适合全局安装，只有全局类的工具才适合，可以通过查看包的官方文档来确定</li></ul></blockquote><p>项目中可能需要删除某些不需要的包，可以使用下面的命令</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>## 局部删除
npm remove uniq
npm r uniq
## 全局删除
npm remove -g nodemon
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_6-2-3-启动项目" tabindex="-1"><a class="header-anchor" href="#_6-2-3-启动项目" aria-hidden="true">#</a> 6.2.3 启动项目</h3><p>可以通过配置 <code>package.json</code> 中的 <code>scripts</code> 属性来启动项目</p><div class="language-Json ext-Json line-numbers-mode"><pre class="language-Json"><code>{
    &quot;scripts&quot;: {
        &quot;server&quot;: &quot;node server.js&quot;,
        &quot;start&quot;: &quot;node index.js&quot;,
    },
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>配置完成之后，执行命令启动项目</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm run server
npm run start
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>不过 <code>start</code> 比较特别，使用时可以省略 <code>run</code></p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm start
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p><code>npm run</code> 有自动向上级目录查找的特性，跟 <code>require</code> 函数一样</p></blockquote><h3 id="_6-3-cnpm" tabindex="-1"><a class="header-anchor" href="#_6-3-cnpm" aria-hidden="true">#</a> 6.3 <code>cnpm</code></h3><p><code>cnpm</code> 是一个淘宝构建的 <code>npmjs.com</code> 的完整镜像，也称为<strong>淘宝镜像</strong>，网址：https://npmmirror.com/。 <code>cnpm</code> 服务部署在国内阿里云服务器上，可以提高包的下载速度。官方也提供了一个全局工具包 <code>cnpm</code>，操作命令与 <code>npm</code> 大体相同。</p><p>可以通过 <code>npm</code> 来安装 <code>cnpm</code> 工具：</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm install -g cnpm --registry=https://registry.npmmirror.com
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>常用操作命令：</p><table><thead><tr><th>命令</th><th>说明</th></tr></thead><tbody><tr><td><code>cnpm init</code> / <code>cnpm init</code></td><td>初始化</td></tr><tr><td><code>cnpm i uniq</code> <code>cnpm i -S uniq</code> <code>cnpm i -D uniq</code> <code>cnpm i -g nodemon</code></td><td>安装包</td></tr><tr><td><code>cnpm i</code></td><td>安装项目依赖</td></tr><tr><td><code>cnpm r uniq</code></td><td>删除</td></tr></tbody></table><p>用 <code>npm</code> 也可以使用淘宝镜像，配置的方式有两种：</p><ul><li>直接配置</li><li>工具配置</li></ul><p>执行如下命令即可完成配置：</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm config set registry https://registry.npmmirror.com/
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>使用 <code>nrm</code> 配置 <code>npm</code> 的镜像地址 <code>npm registry manager</code></p><ol><li>安装 <code>nrm</code><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm i -g nrm
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li>修改镜像<div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code> nrm use taobao
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li>检查是否配置成功（选做）<div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm config list
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div>检查 <code>registry</code> 地址是否为 <code>https://registry.npmmirror.com/</code>, 如果是则表明成功</li></ol><blockquote><p>补充说明：</p><ul><li>建议使用第二种方式进行镜像配置，因为后续修改起来会比较方便</li><li>虽然 <code>cnpm</code> 可以提高速度，但是 <code>npm</code> 也可以通过淘宝镜像进行加速，所以 <code>npm</code> 的使用率还是高于 <code>cnpm</code></li></ul></blockquote><h3 id="_6-4-yarn" tabindex="-1"><a class="header-anchor" href="#_6-4-yarn" aria-hidden="true">#</a> 6.4 <code>yarn</code></h3><p><code>yarn</code> 是由 <code>Facebook</code> 在 2016 年推出的新的 <code>Javascript</code> 包管理工具，官方网址：https://yarnpkg.com/</p><p><code>yarn</code> 特点：</p><ul><li>速度超快：<code>yarn</code> 缓存了每个下载过的包，所以再次使用时无需重复下载。同时利用并行下载以最大化资源利用率，因此安装速度更快。</li><li>超级安全：在执行代码之前，<code>yarn</code> 会通过算法校验每个安装包的完整性</li><li>超级可靠：使用详细、简洁的锁文件格式和明确的安装算法，<code>yarn</code> 能够保证在不同系统上无差异的工作</li></ul><p>可以使用 <code>npm</code> 安装 <code>yarn</code></p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm i -g yarn
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>yarn</code> 常用命令：</p><table><thead><tr><th>命令</th><th>说明</th></tr></thead><tbody><tr><td><code>yarn init</code> / <code>yarn init -y</code></td><td>初始化</td></tr><tr><td><code>yarn add uniq</code> 生产依赖 <code>yarn add less --dev</code> 开发依赖 <code>yarn global add nodemon</code> 全局安装</td><td>安装包</td></tr><tr><td><code>yarn remove uniq</code> 删除项目依赖包 <code>yarn global remove nodemon</code> 全局删除包</td><td>删除包</td></tr><tr><td><code>yarn</code>/<code>yarn install</code></td><td>安装项目依赖</td></tr><tr><td><code>yarn</code> # 不需要添加 <code>run</code></td><td>运行命令别名</td></tr></tbody></table><p>可以通过如下命令配置淘宝镜像</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>yarn config set registry https://registry.npmmirror.com/
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>查看 <code>yarn</code> 的配置项</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>yarn config list
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>npm</code> 和 <code>yarn</code> 选择：</p><ul><li>个人项目：如果是个人项目， 哪个工具都可以 ，可以根据自己的喜好来选择</li><li>公司项目：如果是公司要根据项目代码来选择，可以 通过<strong>锁文件</strong>判断项目的包管理工具 <ul><li><code>npm</code> 的锁文件为 <code>package-lock.json</code></li><li><code>yarn</code> 的锁文件为 <code>yarn.lock</code></li></ul></li></ul><blockquote><p>切记：包管理工具不要混着用</p></blockquote><h3 id="_6-5-管理发布包" tabindex="-1"><a class="header-anchor" href="#_6-5-管理发布包" aria-hidden="true">#</a> 6.5 管理发布包</h3><p>可以将自己开发的工具包发布到 <code>npm</code> 服务上，方便自己和其他开发者使用，操作步骤如下：</p><ol><li>创建文件夹，并创建文件 <code>index.js</code>， 在文件中声明函数，使用 <code>module.exports</code> 暴露</li><li><code>npm</code> 初始化工具包，<code>package.json</code> 填写包的信息 (包的名字是唯一的)</li><li>注册账号：https://www.npmjs.com/signup</li><li>激活账号（一定要激活账号）</li><li>修改为官方的官方镜像(命令行中运行 <code>nrm use npm</code>)</li><li>命令行下 <code>npm login</code> 填写相关用户信息</li><li>命令行下 <code>npm publish</code> 提交包</li></ol><p>后续可以对自己发布的包进行更新，操作步骤如下：</p><ol><li>更新包中的代码</li><li>测试代码是否可用</li><li>修改 <code>package.json</code> 中的版本号</li><li>发布更新命令 <code>npm publish</code></li></ol><p>执行如下命令删除包</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm unpublish --force
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>删除包需要满足一定的条件，https://docs.npmjs.com/policies/unpublish</p><ul><li>是包的作者</li><li>发布小于 24 小时</li><li>大于 24 小时后，没有其他包依赖，并且每周小于 300 下载量，并且只有一个维护者</li></ul><h3 id="_6-6-nvm" tabindex="-1"><a class="header-anchor" href="#_6-6-nvm" aria-hidden="true">#</a> 6.6 <code>nvm</code></h3><blockquote><p><code>nvm</code> 全称 <code>Node Version Manager</code> 顾名思义它是用来管理 <code>Node</code> 版本的工具，方便切换不同版本的 <code>Node.js</code>。</p></blockquote><blockquote><p><code>nvm</code> 的使用非常的简单，跟 <code>npm</code> 的使用方法类似。</p></blockquote><blockquote><p>下载地址 https://github.com/coreybutler/nvm-windows/releases</p></blockquote><p>常用命令：</p><table><thead><tr><th>命令</th><th>说明</th></tr></thead><tbody><tr><td><code>nvm list available</code></td><td>显示所有可以下载的 <code>Node.js</code> 版本</td></tr><tr><td><code>nvm list</code></td><td>显示已安装的版本</td></tr><tr><td><code>nvm install 18.12.1</code></td><td>安装 <code>18.12.1</code> 版本的 <code>Node.js</code></td></tr><tr><td><code>nvm install latest</code></td><td>安装最新版的 <code>Node.js</code></td></tr><tr><td><code>nvm uninstall 18.12.1</code></td><td>删除某个版本的 <code>Node.js</code></td></tr><tr><td><code>nvm use 18.12.1</code></td><td>切换 <code>18.12.1</code> 的 <code>Node.js</code></td></tr></tbody></table><h2 id="_7-express-框架" tabindex="-1"><a class="header-anchor" href="#_7-express-框架" aria-hidden="true">#</a> 7. <code>express</code> 框架</h2><h3 id="_7-1-介绍与使用" tabindex="-1"><a class="header-anchor" href="#_7-1-介绍与使用" aria-hidden="true">#</a> 7.1 介绍与使用</h3><blockquote><p><code>express</code> 是一个基于 <code>Node.js</code> 平台的极简、灵活的 <code>WEB</code> 应用开发框架，官方网址：<code>https://www.expressjs.com.cn/</code></p></blockquote><blockquote><p>简单来说，<code>express</code> 是一个封装好的工具包，封装了很多功能，便于我们开发 <code>web</code> 应用（<code>http</code> 服务）</p></blockquote><p><code>express</code> 下载 <code>express</code> 本身是一个 <code>npm</code> 包，所以可以通过 <code>npm</code> 安装：</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm init
npm i express
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>express</code> 初体验：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入模块
const express = require(&#39;express&#39;)

// 2.创建服务
const app = express()

// 3.创建路由
app.get(&#39;/hello&#39;, (req, resp) =&gt; {
    resp.end(&#39;hello world&#39;)
})

// 4.启动服务并监听端口
app.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_7-2-路由" tabindex="-1"><a class="header-anchor" href="#_7-2-路由" aria-hidden="true">#</a> 7.2 路由</h3><h4 id="_7-2-1-路由初体验" tabindex="-1"><a class="header-anchor" href="#_7-2-1-路由初体验" aria-hidden="true">#</a> 7.2.1 路由初体验</h4><blockquote><p>官方定义：路由确定了应用程序如何响应客户端对特定端点的请求。</p></blockquote><p>一个路由的组成有请求方法、路径、回调函数组成。 <code>express</code> 中提供了一系列方法，可以很方便的使用路由，使用格式如下：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>app.&lt;method&gt;(path，callback)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.引入模块
const express = require(&#39;express&#39;)

// 2.创建服务
const app = express()

// 3.创建路由
// get 请求
app.get(&#39;/hello&#39;, (req, resp) =&gt; {
    resp.end(&#39;hello world&#39;)
})

// 首页路由
app.get(&#39;/&#39;, (req, resp) =&gt; {
    resp.end(&#39;home&#39;)
})

// post 请求
app.post(&#39;/login&#39;, (req, resp) =&gt; {
    resp.end(&#39;login&#39;)
})

// 所有的请求方式都可以
app.all(&#39;/register&#39;, (req, resp) =&gt; {
    resp.end(&#39;register&#39;)
})

// 404
app.all(&#39;*&#39;, (req, resp) =&gt; {
    resp.end(`&lt;h1&gt;404 Not Found&lt;/h1&gt;`)
})

// 4.启动服务并监听端口
app.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h4 id="_7-2-2-获取请求参数" tabindex="-1"><a class="header-anchor" href="#_7-2-2-获取请求参数" aria-hidden="true">#</a> 7.2.2 获取请求参数</h4><p><code>express</code> 框架封装了一些 <code>API</code> 来方便获取请求报文中的数据，并且兼容原生 <code>http</code> 模块的获取方式.。 代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 引入模块
const express = require(&#39;express&#39;)

// 创建应用服务
const app = express()

// 创建路由
app.get(&#39;/hello&#39;, (req, resp) =&gt; {

    // 原生方式
    // console.log(req.method)
    // console.log(req.url)
    // console.log(req.httpVersion)
    // console.log(req.headers)

    // express 操作
    console.log(req.path)
    console.log(req.query)
    // 获取请求ip
    console.log(req.ip)

    resp.end(&#39;hello world&#39;)
})

// 监听端口，启动服务
app.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p><code>express</code> 框架也可以获取到路由参数。路由参数指的是 <code>URL</code> 路径中的参数（数据）。 代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 导入模块
const express = require(&#39;express&#39;)

// 创建应用服务
const app = express()

// 创建路由
app.get(&#39;/:id/:token&#39;, (req, resp) =&gt; {
    console.log(req.params.id, req.params.token)
    resp.end(&#39;hello world&#39;)
})

// 监听端口，启动服务
app.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><code>express</code> 可以使用 <code>body-parser</code> 包处理请求体。 安装 <code>body-parser</code></p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm i body-parser
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>/**
 * 需求：
 *  GET   /login  显示表单网页
 *  POST  /login  获取表单中的『用户名』和『密码』
 */

// 导入模块
const express = require(&#39;express&#39;)

// 使用 body-parser 获取请求体数据
// 安装 body-parser
// npm i body-parser
// 导入
const bodyParser = require(&#39;body-parser&#39;)

// 创建应用服务
const app = express()

// 解析 json 请求格式的请求体中间件
const jsonParser = bodyParser.json()

// 解析 queryString 请求格式的请求体中间件
const urlencodedParser = bodyParser.urlencoded({extended: false})

// 创建路由
app.get(&#39;/login&#39;, (req, resp) =&gt; {
    resp.sendFile(__dirname + &#39;/11-form.html&#39;)
})

app.post(&#39;/login&#39;, urlencodedParser, (req, resp) =&gt; {

    // 获取用户名和密码
    console.log(req.body)
    resp.send(&#39;登录成功&#39;)
})

app.all(&#39;*&#39;, (req, resp) =&gt; {
    resp.send(`&lt;h1&gt;404 Not Found&lt;/h1&gt;`)
})

// 监听端口，启动服务
app.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h4 id="_7-2-3-设置响应" tabindex="-1"><a class="header-anchor" href="#_7-2-3-设置响应" aria-hidden="true">#</a> 7.2.3 设置响应</h4><p><code>express</code> 框架封装了一些 <code>API</code> 来方便给客户端响应数据，并且兼容原生 <code>http</code> 模块的获取方式。 代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 引入模块
const express = require(&#39;express&#39;)

// 创建应用服务
const app = express()

// 创建路由
app.get(&#39;/hello&#39;, (req, resp) =&gt; {
    // 原生响应
    // resp.statusCode = 404
    // resp.statusMessage = &#39;Not Found&#39;
    // resp.setHeader(&#39;aaaa&#39;, &#39;bbbb&#39;)
    // resp.write(&#39;hello express &#39;)

    // express 操作
    // resp.status(500)
    // resp.set(&#39;aaa&#39;, &#39;123&#39;)
    // 自动返回 utf8 编码。此时无需再写 resp.end()
    // resp.send(&#39;hello express &#39;)

    // 可以链式调用
    resp.status(500).set(&#39;xxx&#39;, &#39;yyy&#39;).send(&#39;你好，世界&#39;)
})

// 监听端口，启动服务
app.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>还可以设置其他响应：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 导入模块
const express = require(&#39;express&#39;)

// 创建应用服务
const app = express()

// 创建路由
app.get(&#39;/hello&#39;, (req, resp) =&gt; {
    // resp.end(&#39;hello world&#39;)

    // 重定向
    // resp.redirect(&#39;https://www.baidu.com&#39;)

    // 下载响应
    // resp.download(__dirname + &#39;/singers.json&#39;)

    // 返回json
    // resp.json({
    //     username: &#39;张三&#39;,
    //     age: 18
    // })

    // 返回文件内容
    resp.sendFile(__dirname + &#39;/2-form.html&#39;)
})

// 监听端口，启动服务
app.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h4 id="_7-2-4-路由模块化" tabindex="-1"><a class="header-anchor" href="#_7-2-4-路由模块化" aria-hidden="true">#</a> 7.2.4 路由模块化</h4><p>对路由进行模块化，可以更好的管理路由。</p><p><code>admin.js</code> 路由</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 导入模块
const express = require(&#39;express&#39;)

// 创建应用服务
const router = express()

// 创建路由
router.get(&#39;/admin&#39;, (req, resp) =&gt; {
    resp.send(&#39;后台首页&#39;)
})

router.get(&#39;/setting&#39;, (req, resp) =&gt; {
    resp.send(&#39;个人设置&#39;)
})

module.exports = router
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><code>home.js</code> 路由</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 导入模块
const express = require(&#39;express&#39;)

// 创建应用服务
const router = express()

// 创建路由
router.get(&#39;/&#39;, (req, resp) =&gt; {
    resp.send(&#39;前台首页&#39;)
})

router.get(&#39;/home&#39;, (req, resp) =&gt; {
    resp.send(&#39;home&#39;)
})

module.exports = router
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><code>index.js</code> 路由</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 导入模块
const express = require(&#39;express&#39;)

// 创建应用服务
const app = express()

// 创建路由
// 导入路由
const admin = require(&#39;./routes/admin&#39;)
const home = require(&#39;./routes/home&#39;)

app.use(admin)
app.use(home)

app.all(&#39;*&#39;, (req, resp) =&gt; {
    resp.send(`&lt;h1&gt;404 Not Found&lt;/h1&gt;`)
})

// 监听端口，启动服务
app.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_7-3-中间件" tabindex="-1"><a class="header-anchor" href="#_7-3-中间件" aria-hidden="true">#</a> 7.3 中间件</h3><blockquote><p>中间件（<code>Middleware</code>）本质是一个回调函数。可以像路由回调一样访问请求对象（<code>request</code>），响应对象（<code>response</code>）。</p></blockquote><blockquote><p>中间件的作用就是使用函数封装公共操作，简化代码。</p></blockquote><p>中间件有两种类型：</p><ul><li>全局中间件</li><li>路由中间件</li></ul><h4 id="_7-3-1-全局中间件" tabindex="-1"><a class="header-anchor" href="#_7-3-1-全局中间件" aria-hidden="true">#</a> 7.3.1 全局中间件</h4><blockquote><p>每一个请求到达服务端之后都会执行全局中间件函数。</p></blockquote><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>/**
 * 需求：
 *  记录每个请求的 ip 和 url
 */

// 引入模块
const express = require(&#39;express&#39;)
const fs = require(&#39;fs&#39;)
const path = require(&#39;path&#39;)

// 创建应用服务
const app = express()

// 创建全局路由中间件
let globalMiddleware = (req, resp, next) =&gt; {
    // 获取 url 和 ip
    let {ip, url} = req
    // 使用追加的方式记录到日志文件
    fs.appendFileSync(path.resolve(__dirname, &#39;./access.log&#39;), `${ip} ${url} \r\n`)
    // 调用 next
    next()
}

// 使用全局路由中间件
app.use(globalMiddleware)

// 创建路由
app.get(&#39;/home&#39;, (req, resp) =&gt; {
    resp.send(&#39;前台首页&#39;)
})

app.get(&#39;/admin&#39;, (req, resp) =&gt; {
    resp.send(&#39;后台首页&#39;)
})

app.all(&#39;*&#39;, (req, resp) =&gt; {
    resp.send(`&lt;h1&gt;404 Not Found&lt;/h1&gt;`)
})

// 监听端口，启动服务
app.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h4 id="_7-3-2-路由中间件" tabindex="-1"><a class="header-anchor" href="#_7-3-2-路由中间件" aria-hidden="true">#</a> 7.3.2 路由中间件</h4><p>如果只需要对某一些路由进行功能封装，则就需要路由中间件。 调用格式如下：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>app.get(&#39;/路径&#39;,`中间件函数`,(request,response)=&gt;{
});

app.get(&#39;/路径&#39;,`中间件函数1`,`中间件函数2`,(request,response)=&gt;{
});
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>/**
 * 需求：
 *  针对 /admin  /setting 的请求, 要求 URL 携带 code=521 参数, 如未携带提示『暗号错误』
 */
// 引入模块
const express = require(&#39;express&#39;)

// 创建应用服务
const app = express()

// 创建路由中间件
let routerMiddleware = (req, resp, next) =&gt; {
    // 获取 code
    let { code } = req.query

    if (code !== &#39;521&#39;) {
        resp.send(&#39;暗号错误&#39;)
        return;
    }
    next()
}

// 创建路由
app.get(&#39;/home&#39;, (req, resp) =&gt; {
    resp.send(&#39;前台首页&#39;)
})

app.get(&#39;/admin&#39;, routerMiddleware, (req, resp) =&gt; {
    resp.send(&#39;后台首页&#39;)
})

app.get(&#39;/setting&#39;, routerMiddleware, (req, resp) =&gt; {
    resp.send(&#39;个人设置&#39;)
})

app.all(&#39;*&#39;, (req, resp) =&gt; {
    resp.send(`&lt;h1&gt;404 Not Found&lt;/h1&gt;`)
})

// 监听端口，启动服务
app.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h4 id="_7-3-3-静态资源中间件" tabindex="-1"><a class="header-anchor" href="#_7-3-3-静态资源中间件" aria-hidden="true">#</a> 7.3.3 静态资源中间件</h4><p><code>express</code> 内置处理静态资源的中间件。</p><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 导入模块
const express = require(&#39;express&#39;)

// 创建应用服务
const app = express()

// 创建路由
app.get(&#39;/&#39;, (req, resp) =&gt; {
    resp.send(&#39;前台首页&#39;)
})

// 静态资源中间件设置
// &#39;/&#39; 路径默认访问 idnex.html，如果与动态资源的请求路径一致时，谁先加载就谁先返回
app.use(express.static(__dirname + &#39;/public&#39;))

app.all(&#39;*&#39;, (req, resp) =&gt; {
    resp.send(`&lt;h1&gt;404 Not Found&lt;/h1&gt;`)
})

// 监听端口，启动服务
app.listen(9000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><blockquote><p>注意事项:</p><ul><li>index.html 文件为默认打开的资源</li><li>如果静态资源与路由规则同时匹配，谁先匹配谁就响应</li><li>路由响应动态资源，静态资源中间件响应静态资源</li></ul></blockquote><h3 id="_7-4-ejs-模板引擎" tabindex="-1"><a class="header-anchor" href="#_7-4-ejs-模板引擎" aria-hidden="true">#</a> 7.4 <code>EJS</code> 模板引擎</h3><blockquote><p>模板引擎是分离<strong>用户界面和业务数据</strong>的一种技术。</p></blockquote><blockquote><p><code>EJS</code> 是一个高效的 <code>Javascript</code> 的模板引擎。官网: https://ejs.co/ 中文站：https://ejs.bootcss.com/</p></blockquote><h4 id="_7-4-1-ejs-初体验" tabindex="-1"><a class="header-anchor" href="#_7-4-1-ejs-初体验" aria-hidden="true">#</a> 7.4.1 <code>EJS</code> 初体验</h4><p>下载安装 <code>EJS</code></p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm i ejs --save
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 安装 ejs
// npm i ejs
// 导入模块
const ejs = require(&#39;ejs&#39;)
const fs = require(&#39;fs&#39;)

// 声明变量
let text = &#39;中国&#39;
let weather = &#39;艳阳高照，万里无云&#39;
let str = fs.readFileSync(__dirname + &#39;/1-html.html&#39;).toString()

let result = ejs.render(str, {text, weather})
console.log(result)

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-Html ext-Html line-numbers-mode"><pre class="language-Html"><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;Document&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;我爱你&lt;%= text %&gt;&lt;/h1&gt;&lt;/h1&gt;
    &lt;h2&gt;&lt;%= weather %&gt;&lt;/h1&gt;&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="_7-4-2-ejs-常用语法" tabindex="-1"><a class="header-anchor" href="#_7-4-2-ejs-常用语法" aria-hidden="true">#</a> 7.4.2 <code>EJS</code> 常用语法</h4><p>字符串输出</p><div class="language-Html ext-Html line-numbers-mode"><pre class="language-Html"><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;Document&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;我爱你&lt;%= text %&gt;&lt;/h1&gt;&lt;/h1&gt;
    &lt;h2&gt;&lt;%= weather %&gt;&lt;/h1&gt;&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>列表渲染</p><div class="language-Html ext-Html line-numbers-mode"><pre class="language-Html"><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;Document&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;ul&gt;
        &lt;% list.forEach( item =&gt; {%&gt;
            &lt;li&gt;&lt;%= item %&gt;&lt;/li&gt;
        &lt;% })%&gt;
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>条件判断</p><div class="language-Html ext-Html line-numbers-mode"><pre class="language-Html"><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;Document&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;% if (isLogin) { %&gt;
        &lt;span&gt;欢迎回来&lt;/span&gt;
    &lt;% } else { %&gt;
        &lt;button&gt;登录&lt;/button&gt;  &lt;button&gt;注册&lt;/button&gt;
    &lt;% } %&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_7-5-脚手架" tabindex="-1"><a class="header-anchor" href="#_7-5-脚手架" aria-hidden="true">#</a> 7.5 脚手架</h3><blockquote><p>脚手架：可以快速创建一个应用的框架，应用框架是指在项目开发过程中常用的目录或文件，比如：css 目录、js 目录等，以提高开发效率。</p></blockquote><blockquote><p><code>express-generator</code> 是实现 <code>express</code> 框架的脚手架。</p></blockquote><p>安装 <code>express-generator</code></p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm i express-generator -g
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>初始化</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>express --view=ejs 项目包名
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>package.json</code> 文件</p><div class="language-JSON ext-JSON line-numbers-mode"><pre class="language-JSON"><code>{
  &quot;name&quot;: &quot;15-express-generator&quot;,
  &quot;version&quot;: &quot;0.0.0&quot;,
  &quot;private&quot;: true,
  &quot;scripts&quot;: {
    &quot;start&quot;: &quot;node ./bin/www&quot;
  },
  &quot;dependencies&quot;: {
    &quot;cookie-parser&quot;: &quot;~1.4.4&quot;,
    &quot;debug&quot;: &quot;~2.6.9&quot;,
    &quot;ejs&quot;: &quot;~2.6.1&quot;,
    &quot;express&quot;: &quot;~4.16.1&quot;,
    &quot;http-errors&quot;: &quot;~1.6.3&quot;,
    &quot;morgan&quot;: &quot;~1.9.1&quot;
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>进入项目，安装依赖</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm i
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>启动项目</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm start
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>浏览器访问，端口默认是：<code>3000</code><code>localhost:3000</code></p><h2 id="_8-mongodb" tabindex="-1"><a class="header-anchor" href="#_8-mongodb" aria-hidden="true">#</a> 8. <code>MongoDB</code></h2><h3 id="_8-1-基础概念" tabindex="-1"><a class="header-anchor" href="#_8-1-基础概念" aria-hidden="true">#</a> 8.1 基础概念</h3><blockquote><p><code>MongoDB</code> 是一个基于<strong>分布式文件存储</strong>的数据库，官方地址：https://www.mongodb.com/,下载地址： https://www.mongodb.com/try/download/community</p></blockquote><blockquote><p><code>MongoDB</code> 操作语法与 <code>JavaScript</code> 类似，容易上手，学习成本低。</p></blockquote><p><code>MongoDB</code> 中有三个重要概念需要掌握：</p><ul><li>数据库（<code>Database</code>） 是一个数据仓库，数据库服务下可以创建很多数据库，数据库中可以存放很多集合</li><li>集合（<code>Collection</code>） 集合类似于 <code>JS</code> 中的数组，在集合中可以存放很多文档</li><li>文档（<code>Document</code>） 文档是数据库中的最小单位，类似于 <code>JS</code> 中的对象</li></ul><p>可以通过 <code>JSON</code> 文件来理解 <code>MongoDB</code> 中的概念： 一个 <code>JSON</code> 文件好比是一个数据库，一个 <code>Mongodb</code> 服务下可以有 <code>N</code> 个数据库；<code>JSON</code> 文件中的一级属性的数组值好比是集合；数组中的对象好比是文档对象中的属性，有时也称之为字段。</p><p>一般情况下，一个项目使用一个数据库，一个集合会存储同一种类型的数据。</p><h3 id="_8-2-操作命令" tabindex="-1"><a class="header-anchor" href="#_8-2-操作命令" aria-hidden="true">#</a> 8.2 操作命令</h3><h4 id="_8-2-1-数据库命令" tabindex="-1"><a class="header-anchor" href="#_8-2-1-数据库命令" aria-hidden="true">#</a> 8.2.1 数据库命令</h4><p>显示所有的数据库</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>show dbs
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>切换到指定的数据库，如果数据库不存在会自动创建数据库</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>use 数据库名
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>显示当前所在的数据库</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>db
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>删除当前数据库</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>use 库名
db.dropDatabase()
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_8-2-2-集合命令" tabindex="-1"><a class="header-anchor" href="#_8-2-2-集合命令" aria-hidden="true">#</a> 8.2.2 集合命令</h4><p>创建集合</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>db.createCollection(&#39;集合名称&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>显示当前数据库中的所有集合</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>show collections
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>删除某个集合</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>db.集合名.drop()
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>重命名集合</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>db.集合名.renameCollection(&#39;newName&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="_8-2-3-文档命令" tabindex="-1"><a class="header-anchor" href="#_8-2-3-文档命令" aria-hidden="true">#</a> 8.2.3 文档命令</h4><p>插入文档</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>db.集合名.insert(文档对象)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>查询文档</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>db.集合名.find(查询条件)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>_id</code> 是 <code>MongoDB</code> 自动生成的唯一编号，用来唯一标识文档</p><p>更新文档</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>db.集合名.update(查询条件,新的文档)
db.集合名.update({name:&#39;张三&#39;},{$set:{age:19}})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>删除文档</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>db.集合名.remove(查询条件)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_8-3-mongooose" tabindex="-1"><a class="header-anchor" href="#_8-3-mongooose" aria-hidden="true">#</a> 8.3 <code>Mongooose</code></h3><h4 id="_8-4-1-介绍与使用" tabindex="-1"><a class="header-anchor" href="#_8-4-1-介绍与使用" aria-hidden="true">#</a> 8.4.1 介绍与使用</h4><blockquote><p><code>Mongoose</code> 是一个 <strong>对象文档模型库</strong>，可以方便使用代码操作 <code>MongoDB</code> 数据库,官网 http://www.mongoosejs.net/。</p></blockquote><p>代码示例：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 1.导入 mongoose
const mongoose = require(&#39;mongoose&#39;)

// 设置 strictQuery 为 true
mongoose.set(&#39;strictQuery&#39;, true)

// 2.连接 mongodb 服务
mongoose.connect(&#39;mongodb://127.0.0.1:27017/test&#39;)

// 3.设置连接成功的回调函数
mongoose.connection.once(&#39;open&#39;, () =&gt; {
    // 创建新文档

    // 1、创建文档的结构模型
    let bookSchema = new mongoose.Schema({
        name: String,
        author: String,
        price: Number
    });

    // 2、创建文档模型对象，用于操作文档
    // book 就是集合名，mongoose 会默认加上 s,在mongodb数据库中显示的是 books
    let bookModel = mongoose.model(&#39;book&#39;, bookSchema);

    // 3、操作文档-新增
    bookModel.create({
        name: &quot;海边的卡夫卡&quot;,
        author: &#39;树上春树&#39;,
        price: 49
    }, (err, data) =&gt; {
        // 判断是否有错误
        if (err) {
            console.log(&#39;文档新增失败&#39;, err)
            return;
        }
        console.log(&#39;文档新增成功&#39;, data)
    });

    console.log(&#39;连接成功&#39;)
})

// 4.设置连接失败的回调函数
mongoose.connection.on(&#39;error&#39;, () =&gt; {
    console.log(&#39;连接失败&#39;)
})

// 5.设置连接关闭的回调函数
mongoose.connection.on(&#39;close&#39;, () =&gt; {
    console.log(&#39;连接关闭&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><h4 id="_8-4-2-字段操作" tabindex="-1"><a class="header-anchor" href="#_8-4-2-字段操作" aria-hidden="true">#</a> 8.4.2 字段操作</h4><p>文档结构可选的常用字段类型列表</p><table><thead><tr><th>类型</th><th>描述</th></tr></thead><tbody><tr><td><code>String</code></td><td>字符串</td></tr><tr><td><code>Number</code></td><td>数字</td></tr><tr><td><code>Boolean</code></td><td>布尔值</td></tr><tr><td><code>Array</code></td><td>数组，也可以使用 <code>[]</code> 来标识</td></tr><tr><td><code>Date</code></td><td>日期</td></tr><tr><td><code>Buffer</code></td><td><code>Buffer</code> 对象</td></tr><tr><td><code>Mixed</code></td><td>任意类型，需要使用 <code>mongoose.Schema.Types.Mixed</code> 指定</td></tr><tr><td><code>ObjectId</code></td><td>对象 <code>ID</code>，需要使用 <code>mongoose.Schema.Types.ObjectId</code> 指定</td></tr><tr><td><code>Decimal128</code></td><td>高精度数字，需要使用 <code>mongoose.Schema.Types.Decimal128</code> 指定</td></tr></tbody></table><p><code>Mongoose</code> 有一些内建验证器，可以对字段值进行验证</p><p>必填项</p><div class="language-JSON ext-JSON line-numbers-mode"><pre class="language-JSON"><code>name: {
    type: String,
    // 设置是否必填
    // name: ValidatorError: Path `name` is required.
    required: true
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>默认值</p><div class="language-JSON ext-JSON line-numbers-mode"><pre class="language-JSON"><code>author: {
    type: String,
    // 设置默认值
    default: &#39;匿名&#39;
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>枚举值</p><div class="language-JSON ext-JSON line-numbers-mode"><pre class="language-JSON"><code>tages: {
    type: String,
    // 枚举
    // tages: ValidatorError: `架空` is not a valid enum value for path `tages`.
    enum: [&#39;言情&#39;, &#39;历史&#39;, &#39;励志&#39;]
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>唯一值</p><div class="language-JSON ext-JSON line-numbers-mode"><pre class="language-JSON"><code>name: {
    type: String,
    // 是否唯一
    unique: true
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>unique</code> 需要<strong>重建集合</strong>才能有效果。</p><blockquote><p>永远不要相信用户的输入!</p></blockquote><h4 id="_8-4-3-增删改查" tabindex="-1"><a class="header-anchor" href="#_8-4-3-增删改查" aria-hidden="true">#</a> 8.4.3 增删改查</h4><p>插入一条</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>bookModel.create({
    name: &quot;海边的卡夫卡&quot;,
    author: &#39;树上春树&#39;,
    price: 49
}, (err, data) =&gt; {
    // 判断是否有错误
    if (err) {
        console.log(&#39;文档新增失败&#39;, err)
        return;
    }
    console.log(&#39;文档新增成功&#39;, data)
});
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>批量插入</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>bookModel.insertMany([{
        name: &#39;西游记&#39;,
        author: &#39;吴承恩&#39;,
        price: 19.9,
    }, {
        name: &#39;红楼梦&#39;,
        author: &#39;曹雪芹&#39;,
        price: 29.9,
    }, {
        name: &#39;三国演义&#39;,
        author: &#39;罗贯中&#39;,
        price: 25.9,
    }, {
        name: &#39;水浒传&#39;,
        author: &#39;施耐庵&#39;,
        price: 20.9,
    }, {
        name: &#39;活着&#39;,
        author: &#39;余华&#39;,
        price: 19.9,
    }, {
        name: &#39;狂飙&#39;,
        author: &#39;徐纪周&#39;,
        price: 68,
    }, {
        name: &#39;大魏能臣&#39;,
        author: &#39;黑男爵&#39;,
        price: 9.9,
    },
    {
        name: &#39;知北游&#39;,
        author: &#39;洛水&#39;,
        price: 59,
    }, {
        name: &#39;道君&#39;,
        author: &#39;跃千愁&#39;,
        price: 59,
    }, {
        name: &#39;七煞碑&#39;,
        author: &#39;游泳的猫&#39;,
        price: 29,
    }, {
        name: &#39;独游&#39;,
        author: &#39;酒精过敏&#39;,
        price: 15,
    }, {
        name: &#39;大泼猴&#39;,
        author: &#39;甲鱼不是龟&#39;,
        price: 26,
    },
    {
        name: &#39;黑暗王者&#39;,
        author: &#39;古羲&#39;,
        price: 39,
    },
    {
        name: &#39;不二大道&#39;,
        author: &#39;文刀手予&#39;,
        price: 89,
    },
    {
        name: &#39;大泼猴&#39;,
        author: &#39;甲鱼不是龟&#39;,
        price: 59,
    },
    {
        name: &#39;长安的荔枝&#39;,
        author: &#39;马伯庸&#39;,
        price: 45,
    },
    {
        name: &#39;命运&#39;,
        author: &#39;蔡崇达&#39;,
        price: 59.8,
    },
    {
        name: &#39;如雪如山&#39;,
        author: &#39;张天翼&#39;,
        price: 58,
    },
    {
        name: &#39;三体&#39;,
        author: &#39;刘慈欣&#39;,
        price: 23,
    },
    {
        name: &#39;秋园&#39;,
        author: &#39;杨本芬&#39;,
        price: 38,
    },
    {
        name: &#39;百年孤独&#39;,
        author: &#39;范晔&#39;,
        price: 39.5,
    },
    {
        name: &#39;在细雨中呼喊&#39;,
        author: &#39;余华&#39;,
        price: 25,
    },
], (error, data) =&gt; {
    if (error) {
        console.log(&#39;批量新增失败&#39;, error)
        return
    }
    console.log(&#39;批量新增成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br></div></div><p>删除一条数据</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>bookModel.deleteOne({name: &#39;西游记&#39;}, (error, data) =&gt; {
    if (error) {
        console.log(&#39;删除文档失败&#39;, data)
        return
    }
    console.log(&#39;删除文档成功&#39;, data)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>批量删除</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>bookModel.deleteMany({
    name: &#39;海边的卡夫卡&#39;
}, (error, data) =&gt; {
    if (error) {
        console.log(&#39;批量删除失败&#39;, error)
        return
    }
    console.log(&#39;批量删除成功&#39;, data)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>更新一条数据</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>bookModel.updateOne({
    name: &#39;海边的卡夫卡&#39;
}, {
    name: &#39;西游记&#39;,
    author: &#39;吴承恩&#39;,
    price: 59
}, (error, data) =&gt; {
    if (error) {
        console.log(&#39;更新文档失败&#39;, error)
        return;
    }

    console.log(&#39;更新文档成功&#39;, data)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>批量更新数据</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code> bookModel.updateMany({
    name: &#39;海边的卡夫卡&#39;
}, {
    price: 89
}, (error, data) =&gt; {
    if (error) {
        console.log(&#39;批量更新文档失败&#39;, error)
        return
    }
    console.log(&#39;批量更新文档成功&#39;, data)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>查询一条数据</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>bookModel.findOne({name: &#39;西游记&#39;}, (error, data) =&gt; {
    if (error) {
        console.log(&#39;读取单个文档错误&#39;, error)
        return
    }
    console.log(&#39;读取单个文档成功&#39;, data)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>批量查询数据</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>bookModel.find({name: &#39;西游记&#39;}, (error, data) =&gt; {
    if (error) {
        console.log(&#39;文档读取错误&#39;, error)
        return;
    }
    console.log(&#39;文档读取成功&#39;, data)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_8-4-4-条件控制" tabindex="-1"><a class="header-anchor" href="#_8-4-4-条件控制" aria-hidden="true">#</a> 8.4.4 条件控制</h4><p>在 <code>MongoDB</code> 不能 <code>&gt;</code>、<code>&lt;</code>、<code>&gt;=</code>、<code>&lt;=</code>、<code>!==</code> 等运算符，需要使用替代符号：</p><p><code>&gt;</code> 使用 <code>$gt</code><code>&lt;</code> 使用 <code>$lt</code><code>&gt;=</code> 使用 <code>$gte</code><code>&lt;=</code> 使用 <code>$lte</code><code>!==</code> 使用 <code>$ne</code></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 获取价格 小于 20 的图书
bookModel.find({price: {$lt: 20}}, (error, data) =&gt; {
    if (error) {
        console.log(&#39;文档读取错误&#39;, error)
        return;
    }
    console.log(&#39;文档读取成功&#39;, data)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>逻辑运算 <code>$or</code> 逻辑或的情况</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>//曹雪芹 或者 余华的书
bookModel.find({
    $or: [
        {
            author: &#39;曹雪芹&#39;
        },
        {
            author: &#39;余华&#39;
        }
    ]
}, (error, data) =&gt; {
    if (error) {
        console.log(&#39;文档读取错误&#39;, error)
        return
    }
    console.log(&#39;文档读取成功&#39;, data)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><code>$and</code> 逻辑与的情况</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>//价格大于等于 30 且小于 70
bookModel.find({
    $and: [
        {
            price: {
                $gte: 30
            }
        }, {
            price: {
                $lt: 70
            }
        }
    ]
}, (error, data) =&gt; {
    if (error) {
        console.log(&#39;文档读取错误&#39;, error)
        return;
    }
    console.log(&#39;文档读取成功&#39;, data)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>正则匹配 条件中可以直接使用 <code>JS</code> 的正则语法，通过正则可以进行模糊查询</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>//正则表达式, 搜索书籍名称中带有 `三` 的图书
let queryCondition = &#39;三&#39;
bookModel.find({name: /三/}, (error, data) =&gt; {
    if (error) {
        console.log(&#39;文档读取错误&#39;, error)
        return;
    }
    console.log(&#39;文档读取成功&#39;, data)
})

bookModel.find({name: new RegExp(queryCondition)}, (error, data) =&gt; {
    if (error) {
        console.log(&#39;文档读取错误&#39;, error)
        return;
    }
    console.log(&#39;文档读取成功&#39;, data)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="_8-4-5-个性化读取" tabindex="-1"><a class="header-anchor" href="#_8-4-5-个性化读取" aria-hidden="true">#</a> 8.4.5 个性化读取</h4><p>字段筛选</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 只查询 书名 作者
// 1:查询 0:不查询
bookModel.find().select({name: 1, author: 1, _id: 0}).exec((error, data) =&gt; {
    if (error) {
        console.log(&#39;文档读取错误&#39;, error)
        return
    }
    console.log(&#39;文档读取成功&#39;, data)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>数据排序</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 对数据进行排序
// 1:升序 -1:降序
bookModel.find({author: &#39;余华&#39;}).select({name: 1, price: 1}).sort({price: -1}).exec((error, data) =&gt; {
    if (error) {
        console.log(&#39;文件读取错误&#39;, error)
        return
    }
    console.log(data)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>数据截取</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 数据列表集合截取
// 可用于分页
bookModel.find()
    .select({name: 1, author: 1, _id: 0})
    .sort({price: -1})
    .skip(2)
    .limit(3)
    .exec((error, data) =&gt; {
        if (error) {
            console.log(&#39;文件读取错误&#39;, error)
            return
        }
        console.log(data)
    })
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="_9-接口" tabindex="-1"><a class="header-anchor" href="#_9-接口" aria-hidden="true">#</a> 9. 接口</h2><h3 id="_9-1-restful-api" tabindex="-1"><a class="header-anchor" href="#_9-1-restful-api" aria-hidden="true">#</a> 9.1 <code>RESTful API</code></h3><p><code>RESTful API</code> 是一种特殊风格的接口，主要特点有如下几个：</p><ul><li><code>URL</code> 中的路径表示资源 ，路径中不能有动词 ，例如 <code>create</code> , <code>delete</code> , <code>update</code> 等这些都不能有</li><li>操作资源要与 <code>HTTP</code> 请求方法对应</li><li>操作结果要与 <code>HTTP</code> 响应状态码对应</li></ul><p>规则示例：</p><table><thead><tr><th>操作</th><th>请求类型</th><th>URL</th></tr></thead><tbody><tr><td>新增歌曲</td><td><code>POST</code></td><td><code>/song</code></td></tr><tr><td>删除歌曲</td><td><code>DELETE</code></td><td><code>/song/10</code></td></tr><tr><td>修改歌曲</td><td><code>PUT</code></td><td><code>/song/10</code></td></tr><tr><td>修改歌曲</td><td><code>PATCH</code></td><td><code>/song/10</code></td></tr><tr><td>获取所有歌曲</td><td><code>GET</code></td><td><code>/song</code></td></tr><tr><td>获取单个歌曲</td><td><code>GET</code></td><td><code>/song/10</code></td></tr></tbody></table><h3 id="_9-2-json-server" tabindex="-1"><a class="header-anchor" href="#_9-2-json-server" aria-hidden="true">#</a> 9.2 <code>json-server</code></h3><blockquote><p><code>json-server</code> 本身是一个 <code>JS</code> 编写的工具包，可以快速搭建 <code>RESTful API</code> 服务。</p></blockquote><p>官方地址: https://github.com/typicode/json-server</p><p>操作步骤： 全局安装 <code>json-server</code></p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>npm i -g json-server
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>创建 <code>JSON</code> 文件（<code>db.json</code>），编写基本结构</p><div class="language-JSON ext-JSON line-numbers-mode"><pre class="language-JSON"><code>{
    &quot;song&quot;: [
        { &quot;id&quot;: 1, &quot;name&quot;: &quot;干杯&quot;, &quot;singer&quot;: &quot;五月天&quot; },
        { &quot;id&quot;: 2, &quot;name&quot;: &quot;当&quot;, &quot;singer&quot;: &quot;动力火车&quot; },
        { &quot;id&quot;: 3, &quot;name&quot;: &quot;不能说的秘密&quot;, &quot;singer&quot;: &quot;周杰伦&quot; }
    ]
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>以 <code>JSON</code> 文件所在文件夹作为工作目录，执行如下命令</p><div class="language-Bash ext-Bash line-numbers-mode"><pre class="language-Bash"><code>json-server --watch db.json
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>默认监听端口为 <code>3000</code></p><h2 id="_10-会话控制" tabindex="-1"><a class="header-anchor" href="#_10-会话控制" aria-hidden="true">#</a> 10. 会话控制</h2><blockquote><p>所谓会话控制就是对会话进行控制。<code>HTTP</code> 是一种无状态的协议，它没有办法区分多次的请求是否来自于同一个客户端，无法区分用户而产品中又大量存在的这样的需求，所以我们需要通过<strong>会话控制</strong>来解决该问题。</p></blockquote><p>常见的会话控制技术有三种：</p><ul><li><code>cookie</code></li><li><code>session</code></li><li><code>token</code></li></ul><h3 id="_10-1-cookie" tabindex="-1"><a class="header-anchor" href="#_10-1-cookie" aria-hidden="true">#</a> 10.1 <code>cookie</code></h3><blockquote><p><code>cookie</code> 是 <code>HTTP</code> 服务器发送到用户浏览器并保存在本地的一小块数据，<strong>保存在浏览器端</strong>的一小块数据且是按照域名划分保存的。</p></blockquote><p><code>express</code> 中可以使用 <code>cookie-parser</code> 来进行对 <code>cookie</code> 的操作。</p><p>示例代码：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 导入express
const express = require(&#39;express&#39;)
const cookieParser = require(&#39;cookie-parser&#39;)

// 创建应用对象
const app = express()
app.use(cookieParser())

// 创建路由
app.get(&#39;/&#39;, (req, resp) =&gt; {
    resp.send(&#39;home&#39;)
})

// 设置cookie
app.get(&#39;/set-cookie&#39;, (req, resp) =&gt; {
    // 在浏览器关闭时会销毁
    // resp.cookie(&#39;name&#39;, &#39;zhangsan&#39;)

    // 设置 cookie 的过期时间。设置一分钟以后过期
    resp.cookie(&#39;name&#39;, &#39;lisi&#39;, {maxAge: 60 * 1000})

    resp.send(&#39;hello world&#39;)
})

// 获取 cookie
app.get(&#39;/get-cookie&#39;, (req, resp) =&gt; {
    console.log(req.cookies)
    resp.send(`欢迎您${req.cookies.name}`)
})

// 删除 cookie
app.get(&#39;/remove-cookie&#39;, (req, resp) =&gt; {
    resp.clearCookie(&#39;name&#39;)
    resp.send(&#39;删除cookie成功&#39;)
})

// 监听端口，启动服务
app.listen(3000, () =&gt; {
    console.log(&#39;服务启动成功&#39;)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><blockquote><p>不同浏览器中的 <code>cookie</code> 是相互独立的，不共享。</p></blockquote><h3 id="_10-2-session" tabindex="-1"><a class="header-anchor" href="#_10-2-session" aria-hidden="true">#</a> 10.2 <code>session</code></h3><blockquote><p><code>session</code> 是保存在<strong>服务器端</strong>的一块儿数据 ，保存当前访问用户的相关信息。</p></blockquote><p><code>express</code> 中可以使用 <code>express-session</code> 对 <code>session</code> 进行操作。 示例代码：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 引入模块
const express = require(&#39;express&#39;)
const session = require(&#39;express-session&#39;)
const MongoStore = require(&#39;connect-mongo&#39;)

// 创建应用服务
const app = express()
// 设置 session 的中间件
app.use(session({
    // 设置 cookie 的 name，默认值是：connect.sid
    name: &#39;sid&#39;,
    // 参与加密的字符串（又称签名）  加盐
    secret: &#39;123456&#39;,
    // 是否为每次请求都设置一个cookie用来存储session的id
    saveUninitialized: false,
    // 是否在每次请求时重新保存session  20 分钟    4:00  4:20
    resave: true,
    store: MongoStore.create({
        //数据库的连接配置
        mongoUrl: &#39;mongodb://127.0.0.1:27017/test&#39;
    }),
    cookie: {
        // 开启后前端无法通过 JS 操作
        httpOnly: true,
        // 这一条 是控制 sessionID 的过期时间的！！！ 5分钟过期
        maxAge: 5 * 60 * 1000
    }
}))

// 创建路由
app.get(&#39;/&#39;, (req, resp) =&gt; {
    resp.send(&#39;home&#39;)
})

// 登录时设置 session
app.get(&#39;/login&#39;, (req, resp) =&gt; {
    // 校验一下用户名密码是否正确
    if (req.query.username === &#39;admin&#39; &amp;&amp; req.query.password === &#39;admin&#39;) {
        // 设置 session 信息
        req.session.username = req.query.username
        req.session.uid = &#39;258aefccc&#39;
        resp.send(&#39;登录成功&#39;)
    } else {
        resp.send(&#39;登录失败&#39;)
    }
})

// 获取 session
app.get(&#39;/cart&#39;, (req, resp) =&gt; {
    // 检测 session 是否存在用户信息
    if (req.session.username) {
        resp.send(`欢迎您${req.session.username}`)
    } else {
        resp.send(&#39;请先登录&#39;)
    }
})

// 退出登录删除 session
app.get(&#39;/logout&#39;, (req, resp) =&gt; {
    req.session.destroy(() =&gt; {
        resp.send(&#39;成功退出登录&#39;)
    })
})

// 监听端口，启动服务
app.listen(3000)

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><p><strong><code>session</code> 和 <code>cookie</code> 的区别</strong><code>cookie</code> 和 <code>session</code> 的区别主要有如下几点：</p><ul><li>存在的位置 <ul><li><code>cookie</code>：浏览器端</li><li><code>session</code>：服务端</li></ul></li><li>安全性 <ul><li><code>cookie</code> 是以明文的方式存放在客户端的，安全性相对较低</li><li><code>session</code> 存放于服务器中，所以安全性<strong>相对较好</strong></li></ul></li><li>网络传输量 <ul><li><code>cookie</code> 设置内容过多会增大报文体积，会影响传输效率</li><li><code>session</code> 数据存储在服务器，只是通过 <code>cookie</code> 传递 <code>id</code>，所以不影响传输效率</li></ul></li><li>存储限制 <ul><li>浏览器限制单个 <code>cookie</code> 保存的数据不能超过 <code>4K</code>，且单个域名下的存储数量也有限制</li><li><code>session</code> 数据存储在服务器中，所以没有这些限制</li></ul></li></ul><h3 id="_10-3-token" tabindex="-1"><a class="header-anchor" href="#_10-3-token" aria-hidden="true">#</a> 10.3 <code>token</code></h3><blockquote><p><code>token</code> 是服务端生成并返回给 <code>HTTP</code> 客户端的一串加密字符串， <code>token</code> 中保存着用户信息。</p></blockquote><p><code>token</code> 的特点：</p><ul><li>服务端压力更小</li><li>数据存储在客户端</li><li>相对更安全</li><li>数据加密</li><li>可以避免 <code>CSRF</code>（跨站请求伪造）</li><li>扩展性更强</li><li>服务间可以共享</li><li>增加服务节点更简单</li></ul><p><code>JWT</code>（<code>JSON Web Token</code>）是目前最流行的跨域认证解决方案，可用于基于 <code>token</code> 的身份验证 <code>JWT</code> 使 <code>token</code> 的生成与校验更规范，可以使用 jsonwebtoken 包 来操作 <code>token</code>.</p><p>代码操作：</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// 引入 jwt
const jwt = require(&#39;jsonwebtoken&#39;)

// 生成 token
// jwt.sign(用户数据，加密字符串，配置对象)
let token = jwt.sign({
    username: &#39;admin&#39;
}, &#39;123456&#39;, {
    // 单位秒 60秒后过期
    expiresIn: 60
})

// eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNjg1NTE5NTkzLCJleHAiOjE2ODU1MTk2NTN9.IP90SEMbkzaBGnxVDoq63IHWzQ8crbfapvYCylGZhhg
console.log(token)

// 校验 token
jwt.verify(token, &#39;123456&#39;, (error, data) =&gt; {
    if (error) {
        console.log(&#39;token 校验失败&#39;, error)
        return
    }
    console.log(data)
})
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><!--]--></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/chenyl8848/chenyl8848.github.io/edit/master/docs/web/framework/nodejs/nodejs.md" rel="noopener noreferrer" target="_blank" arialabel="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" arialabelledby="edit"><title id="edit" lang="en">edit icon</title><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2024/10/2 03:11:43</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: 1063415880@qq.com">chenyl8848</span>,<!--]--><!--[--><span class="contributor" title="email: 1063415880@qq.com">cyl</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/web/framework/nodejs/" class="nav-link active prev" arialabel="Node.js"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><i class="icon iconfont icon-node-js"></i>Node.js</div></a><!----></nav><div class="giscus-wrapper input-top" style="display:block;"><giscus-widget repo="chenyl8848/chenyl8848.github.io" repoId="R_kgDOHJ-qSQ" category="Announcements" categoryId="DIC_kwDOHJ-qSc4COg8Z" lang="zh-CN" theme="light" mapping="pathname" inputPosition="top" reactionsEnabled="1" emitMetadata="0"></giscus-widget></div><!----></main><!--]--><footer class="footer-wrapper"><div class="footer">没有最好，只有更好！</div><div class="copyright">Copyright © 2025 Java陈序员</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.06d697e7.js" defer></script>
  </body>
</html>
