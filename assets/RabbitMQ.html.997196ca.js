import{_ as t,r as e,c as o,a as n,b as p,F as c,d as s,f as l,o as u}from"./app.06d697e7.js";const i={},r=n("h1",{id:"rabbitmq-\u4E07\u5B57\u5165\u95E8\u6559\u7A0B",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#rabbitmq-\u4E07\u5B57\u5165\u95E8\u6559\u7A0B","aria-hidden":"true"},"#"),s(" RabbitMQ \u4E07\u5B57\u5165\u95E8\u6559\u7A0B")],-1),k={href:"https://www.bilibili.com/video/BV1dE411K7MG?spm_id_from=333.999.0.0",target:"_blank",rel:"noopener noreferrer"},b=s("\u5B66\u4E60\u89C6\u9891\u3010\u7F16\u7A0B\u4E0D\u826F\u4EBA\u3011"),m={href:"https://www.rabbitmq.com/",target:"_blank",rel:"noopener noreferrer"},d=s("\u5B98\u7F51"),g={href:"https://www.rabbitmq.com/#getstarted",target:"_blank",rel:"noopener noreferrer"},h=s("\u5B98\u65B9\u6559\u7A0B"),q=l(`<p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/RabbitMQ_Mindmap.png" alt="" loading="lazy"></p><h2 id="_1-mq-\u5F15\u8A00" tabindex="-1"><a class="header-anchor" href="#_1-mq-\u5F15\u8A00" aria-hidden="true">#</a> 1. MQ \u5F15\u8A00</h2><h3 id="_1-1-\u4EC0\u4E48\u662F-mq" tabindex="-1"><a class="header-anchor" href="#_1-1-\u4EC0\u4E48\u662F-mq" aria-hidden="true">#</a> 1.1 \u4EC0\u4E48\u662F MQ</h3><p><code>MQ</code>(Message Quene) : \u7FFB\u8BD1\u4E3A<strong>\u6D88\u606F\u961F\u5217</strong>\uFF0C\u522B\u540D\u4E3A<strong>\u6D88\u606F\u4E2D\u95F4\u4EF6</strong>\uFF0C\u901A\u8FC7\u5178\u578B\u7684<strong>\u751F\u4EA7\u8005</strong>\u548C<strong>\u6D88\u8D39\u8005</strong>\u6A21\u578B\uFF0C\u751F\u4EA7\u8005\u4E0D\u65AD\u5411\u6D88\u606F\u961F\u5217\u4E2D\u751F\u4EA7\u6D88\u606F\uFF0C\u6D88\u8D39\u8005\u4E0D\u65AD\u7684\u4ECE\u961F\u5217\u4E2D\u83B7\u53D6\u6D88\u606F\u3002\u56E0\u4E3A\u6D88\u606F\u7684\u751F\u4EA7\u548C\u6D88\u8D39\u90FD\u662F\u5F02\u6B65\u7684\uFF0C\u800C\u4E14\u53EA\u5173\u5FC3\u6D88\u606F\u7684\u53D1\u9001\u548C\u63A5\u6536\uFF0C\u6CA1\u6709\u4E1A\u52A1\u903B\u8F91\u7684\u4FB5\u5165\uFF0C\u8F7B\u677E\u7684\u5B9E\u73B0\u7CFB\u7EDF\u95F4\u89E3\u8026\u3002\u5229\u7528\u9AD8\u6548\u53EF\u9760\u7684\u6D88\u606F\u4F20\u9012\u673A\u5236\u8FDB\u884C\u5E73\u53F0\u65E0\u5173\u7684\u6570\u636E\u4EA4\u6D41\uFF0C\u5E76\u57FA\u4E8E\u6570\u636E\u901A\u4FE1\u6765\u8FDB\u884C\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u96C6\u6210\u3002</p><h3 id="_1-2-mq-\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#_1-2-mq-\u6709\u54EA\u4E9B" aria-hidden="true">#</a> 1.2 MQ \u6709\u54EA\u4E9B</h3><p>\u5F53\u4ECA\u5E02\u9762\u4E0A\u6709\u5F88\u591A\u4E3B\u6D41\u7684\u6D88\u606F\u4E2D\u95F4\u4EF6\uFF0C\u5982\u8001\u724C\u7684 <code>ActiveMQ</code>\u3001<code>RabbitMQ</code>\uFF0C\u7099\u624B\u53EF\u70ED\u7684 <code>Kafka</code>\uFF0C\u963F\u91CC\u5DF4\u5DF4\u81EA\u4E3B\u5F00\u53D1 <code>RocketMQ</code> \u7B49\u3002</p><h3 id="_1-3-\u4E0D\u540C-mq-\u7279\u70B9" tabindex="-1"><a class="header-anchor" href="#_1-3-\u4E0D\u540C-mq-\u7279\u70B9" aria-hidden="true">#</a> 1.3 \u4E0D\u540C MQ \u7279\u70B9</h3><ul><li>ActiveMQ\uFF1AApache \u51FA\u54C1\uFF0C\u6700\u6D41\u884C\u7684\uFF0C\u80FD\u529B\u5F3A\u52B2\u7684\u5F00\u6E90\u6D88\u606F\u603B\u7EBF\u3002\u5B83\u662F\u4E00\u4E2A\u5B8C\u5168\u652F\u6301 JMS \u89C4\u8303\u7684\u7684\u6D88\u606F\u4E2D\u95F4\u4EF6\u3002\u4E30\u5BCC\u7684API,\u591A\u79CD\u96C6\u7FA4\u67B6\u6784\u6A21\u5F0F\u8BA9 ActiveMQ \u5728\u4E1A\u754C\u6210\u4E3A\u8001\u724C\u7684\u6D88\u606F\u4E2D\u95F4\u4EF6\uFF0C\u5728\u4E2D\u5C0F\u578B\u4F01\u4E1A\u9887\u53D7\u6B22\u8FCE\u3002</li><li>Kafka\uFF1ALinkedIn \u5F00\u6E90\u7684\u5206\u5E03\u5F0F\u53D1\u5E03-\u8BA2\u9605\u6D88\u606F\u7CFB\u7EDF\uFF0C\u76EE\u524D\u5F52\u5C5E\u4E8E Apache \u9876\u7EA7\u9879\u76EE\u3002Kafka \u4E3B\u8981\u7279\u70B9\u662F\u57FA\u4E8E Pull \u7684\u6A21\u5F0F\u6765\u5904\u7406\u6D88\u606F\u6D88\u8D39\uFF0C\u8FFD\u6C42\u9AD8\u541E\u5410\u91CF\uFF0C\u4E00\u5F00\u59CB\u7684\u76EE\u7684\u5C31\u662F\u7528\u4E8E\u65E5\u5FD7\u6536\u96C6\u548C\u4F20\u8F93\u30020.8 \u7248\u672C\u5F00\u59CB\u652F\u6301\u590D\u5236\uFF0C\u4E0D\u652F\u6301\u4E8B\u52A1\uFF0C\u5BF9\u6D88\u606F\u7684\u91CD\u590D\u3001\u4E22\u5931\u3001\u9519\u8BEF\u6CA1\u6709\u4E25\u683C\u8981\u6C42\uFF0C\u9002\u5408\u4EA7\u751F\u5927\u91CF\u6570\u636E\u7684\u4E92\u8054\u7F51\u670D\u52A1\u7684\u6570\u636E\u6536\u96C6\u4E1A\u52A1\u3002</li><li>RocketMQ\uFF1A\u963F\u91CC\u5F00\u6E90\u7684\u6D88\u606F\u4E2D\u95F4\u4EF6\uFF0C\u5B83\u662F\u7EAF <code>Java</code> \u5F00\u53D1\uFF0C\u5177\u6709\u9AD8\u541E\u5410\u91CF\u3001\u9AD8\u53EF\u7528\u6027\u3001\u9002\u5408\u5927\u89C4\u6A21\u5206\u5E03\u5F0F\u7CFB\u7EDF\u5E94\u7528\u7684\u7279\u70B9\u3002RocketMQ \u601D\u8DEF\u8D77\u6E90\u4E8E Kafka\uFF0C\u4F46\u5E76\u4E0D\u662F Kafka \u7684\u4E00\u4E2ACopy\uFF0C\u5B83\u5BF9\u6D88\u606F\u7684\u53EF\u9760\u4F20\u8F93\u53CA\u4E8B\u52A1\u6027\u505A\u4E86\u4F18\u5316\uFF0C\u76EE\u524D\u5728\u963F\u91CC\u96C6\u56E2\u88AB\u5E7F\u6CDB\u5E94\u7528\u4E8E\u4EA4\u6613\u3001\u5145\u503C\u3001\u6D41\u8BA1\u7B97\u3001\u6D88\u606F\u63A8\u9001\u3001\u65E5\u5FD7\u6D41\u5F0F\u5904\u7406\u3001binglog \u5206\u53D1\u7B49\u573A\u666F\u3002</li><li>RabbitMQ\uFF1A\u4F7F\u7528 <code>Erlang</code> \u8BED\u8A00\u5F00\u53D1\u7684\u5F00\u6E90\u6D88\u606F\u961F\u5217\u7CFB\u7EDF\uFF0C\u57FA\u4E8E AMQP \u534F\u8BAE\u6765\u5B9E\u73B0\u3002AMQP \u7684\u4E3B\u8981\u7279\u5F81\u662F\u9762\u5411\u6D88\u606F\u3001\u961F\u5217\u3001\u8DEF\u7531\uFF08\u5305\u62EC\u70B9\u5BF9\u70B9\u548C\u53D1\u5E03/\u8BA2\u9605\uFF09\u3001\u53EF\u9760\u6027\u3001\u5B89\u5168\u3002 AMQP \u534F\u8BAE\u66F4\u591A\u7528\u5728\u4F01\u4E1A\u7CFB\u7EDF\u5185\u5BF9\u6570\u636E\u4E00\u81F4\u6027\u3001\u7A33\u5B9A\u6027\u548C\u53EF\u9760\u6027\u8981\u6C42\u5F88\u9AD8\u7684\u573A\u666F\uFF0C\u5BF9\u6027\u80FD\u548C\u541E\u5410\u91CF\u7684\u8981\u6C42\u8FD8\u5728\u5176\u6B21\u3002</li></ul><blockquote><p>RabbitMQ \u6BD4 Kafka \u53EF\u9760\uFF0CKafka \u66F4\u9002\u5408 IO \u9AD8\u541E\u5410\u7684\u5904\u7406\uFF0C\u4E00\u822C\u5E94\u7528\u5728\u5927\u6570\u636E\u65E5\u5FD7\u5904\u7406\u6216\u5BF9\u5B9E\u65F6\u6027\uFF08\u5C11\u91CF\u5EF6\u8FDF\uFF09\uFF0C\u53EF\u9760\u6027\uFF08\u5C11\u91CF\u4E22\u6570\u636E\uFF09\u8981\u6C42\u7A0D\u4F4E\u7684\u573A\u666F\u4F7F\u7528\uFF0C\u6BD4\u5982 ELK \u65E5\u5FD7\u6536\u96C6\u3002</p></blockquote><hr><h2 id="_2-rabbitmq-\u5F15\u8A00" tabindex="-1"><a class="header-anchor" href="#_2-rabbitmq-\u5F15\u8A00" aria-hidden="true">#</a> 2. RabbitMQ \u5F15\u8A00</h2><h3 id="_2-1-rabbitmq-\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#_2-1-rabbitmq-\u4ECB\u7ECD" aria-hidden="true">#</a> 2.1 RabbitMQ \u4ECB\u7ECD</h3><p>\u57FA\u4E8E <code>AMQP</code> \u534F\u8BAE\uFF0C<code>Erlang</code> \u8BED\u8A00\u5F00\u53D1\uFF0C\u662F\u90E8\u7F72\u6700\u5E7F\u6CDB\u3001\u6700\u53D7\u6B22\u8FCE\u7684<strong>\u5F00\u6E90\u6D88\u606F\u4E2D\u95F4\u4EF6</strong>\u4E4B\u4E00\u3002</p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20190925215603036-9419777.png" alt="" loading="lazy"></p><p><strong>AMQP \u534F\u8BAE</strong></p><p>AMQP\uFF08advanced message queuing protocol\uFF09\u5728 2003 \u5E74\u65F6\u88AB\u63D0\u51FA\uFF0C\u6700\u65E9\u7528\u4E8E\u89E3\u51B3\u91D1\u878D\u9886\u4E0D\u540C\u5E73\u53F0\u4E4B\u95F4\u7684\u6D88\u606F\u4F20\u9012\u4EA4\u4E92\u95EE\u9898\u3002\u987E\u540D\u601D\u4E49\uFF0CAMQP \u662F\u4E00\u79CD\u534F\u8BAE\uFF0C\u66F4\u51C6\u786E\u7684\u8BF4\u662F\u4E00\u79CDbinary wire-level protocol\uFF08\u94FE\u63A5\u534F\u8BAE\uFF09\u3002\u8FD9\u662F\u5176\u548C JMS \u7684\u672C\u8D28\u5DEE\u522B\uFF0CAMQP \u4E0D\u4ECE API \u5C42\u8FDB\u884C\u9650\u5B9A\uFF0C\u800C\u662F\u76F4\u63A5\u5B9A\u4E49\u7F51\u7EDC\u4EA4\u6362\u7684\u6570\u636E\u683C\u5F0F\u3002\u8FD9\u4F7F\u5F97\u5B9E\u73B0\u4E86 AMQP \u7684 provider \u5929\u7136\u6027\u5C31\u662F\u8DE8\u5E73\u53F0\u7684\u3002</p><p>\u4EE5\u4E0B\u662F AMQP \u534F\u8BAE\u6A21\u578B\uFF1A</p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200311182438041.png" alt="" loading="lazy"></p><h3 id="_2-2-rabbitmq-\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#_2-2-rabbitmq-\u5B89\u88C5" aria-hidden="true">#</a> 2.2 RabbitMQ \u5B89\u88C5</h3><h4 id="_2-2-1-\u4E0B\u8F7D" tabindex="-1"><a class="header-anchor" href="#_2-2-1-\u4E0B\u8F7D" aria-hidden="true">#</a> 2.2.1 \u4E0B\u8F7D</h4><p>\u5B98\u7F51\u4E0B\u8F7D\u5730\u5740\uFF1Ahttps://www.rabbitmq.com/download.html</p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20190925220115235.png" alt="" loading="lazy"></p><h4 id="_2-2-2-\u4E0B\u8F7D\u5B89\u88C5\u5305" tabindex="-1"><a class="header-anchor" href="#_2-2-2-\u4E0B\u8F7D\u5B89\u88C5\u5305" aria-hidden="true">#</a> 2.2.2 \u4E0B\u8F7D\u5B89\u88C5\u5305</h4><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20190925220343521.png" alt="" loading="lazy"></p><blockquote><p><strong>\u6CE8\u610F</strong>\uFF1A\u8FD9\u91CC\u7684\u5B89\u88C5\u5305\u662F CentOS7 \u5B89\u88C5\u7684\u5305\u3002</p></blockquote><h4 id="_2-2-3-\u5B89\u88C5\u6B65\u9AA4" tabindex="-1"><a class="header-anchor" href="#_2-2-3-\u5B89\u88C5\u6B65\u9AA4" aria-hidden="true">#</a> 2.2.3 \u5B89\u88C5\u6B65\u9AA4</h4><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">1.</span> \u5C06 RabbitMQ \u5B89\u88C5\u5305\u4E0A\u4F20\u5230 Linux \u7CFB\u7EDF\u4E2D
  erlang-22.0.7-1.el7.x86_64.rpm
	rabbitmq-server-3.7.18-1.el7.noarch.rpm

<span class="token list punctuation">2.</span> \u5B89\u88C5 Erlang \u4F9D\u8D56\u5305
	rpm -ivh erlang-22.0.7-1.el7.x86_64.rpm

<span class="token list punctuation">3.</span> \u5B89\u88C5 RabbitMQ \u5B89\u88C5\u5305\uFF08\u9700\u8981\u8054\u7F51\uFF09
	yum install -y rabbitmq-server-3.7.18-1.el7.noarch.rpm
		
  \u6CE8\u610F\uFF1A\u9ED8\u8BA4\u5B89\u88C5\u5B8C\u6210\u540E\u914D\u7F6E\u6587\u4EF6\u6A21\u677F\u5728\uFF1A/usr/share/doc/rabbitmq-server-3.7.18/rabbitmq.config.example \u76EE\u5F55\u4E2D\uFF0C\u9700\u8981\u5C06\u914D\u7F6E\u6587\u4EF6\u590D\u5236\u5230 /etc/rabbitmq/ \u76EE\u5F55\u4E2D\uFF0C\u5E76\u4FEE\u6539\u540D\u79F0\u4E3A rabbitmq.config

<span class="token list punctuation">4.</span> \u590D\u5236\u914D\u7F6E\u6587\u4EF6
	cp /usr/share/doc/rabbitmq-server-3.7.18/rabbitmq.config.example /etc/rabbitmq/rabbitmq.config

<span class="token list punctuation">5.</span> \u67E5\u770B\u914D\u7F6E\u6587\u4EF6\u4F4D\u7F6E
	ls /etc/rabbitmq/rabbitmq.config

<span class="token list punctuation">6.</span> \u4FEE\u6539\u914D\u7F6E\u6587\u4EF6\uFF08\u53C2\u89C1\u4E0B\u56FE\uFF09
	vim /etc/rabbitmq/rabbitmq.config 
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20190925222230260-3836271.png" alt="" loading="lazy"></p><p>\u5C06\u4E0A\u56FE\u4E2D\u914D\u7F6E\u6587\u4EF6\u4E2D\u7EA2\u8272\u90E8\u5206\u53BB\u6389 <code>%%</code>,\u4EE5\u53CA\u6700\u540E\u7684 <code>,</code>,\u4FEE\u6539\u4E3A\u4E0B\u56FE\uFF1A</p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20190925222329200-3836312.png" alt="" loading="lazy"></p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">7.</span> \u6267\u884C\u5982\u4E0B\u547D\u4EE4\uFF0C\u542F\u52A8 RabbitMQ \u4E2D\u7684\u63D2\u4EF6\u7BA1\u7406
	rabbitmq-plugins enable rabbitmq_management
	
<span class="token code keyword">	\u51FA\u73B0\u5982\u4E0B\u8BF4\u660E\uFF1A
		Enabling plugins on node rabbit@localhost:
    rabbitmq_management
    The following plugins have been configured:
      rabbitmq_management
      rabbitmq_management_agent
      rabbitmq_web_dispatch
    Applying plugin configuration to rabbit@localhost...
    The following plugins have been enabled:
      rabbitmq_management
      rabbitmq_management_agent
      rabbitmq_web_dispatch</span>

<span class="token code keyword">    set 3 plugins.
    Offline change; changes will take effect at broker restart.</span>

<span class="token list punctuation">8.</span> \u542F\u52A8 RabbitMQ \u7684\u670D\u52A1
	systemctl start rabbitmq-server
	systemctl restart rabbitmq-server
	systemctl stop rabbitmq-server
	

<span class="token list punctuation">9.</span> \u67E5\u770B\u670D\u52A1\u72B6\u6001\uFF08\u89C1\u4E0B\u56FE\uFF09
	systemctl status rabbitmq-server
  \u25CF rabbitmq-server.service - RabbitMQ broker
     Loaded: loaded (/usr/lib/systemd/system/rabbitmq-server.service; disabled; vendor preset: disabled)
     Active: active (running) since \u4E09 2019-09-25 22:26:35 CST; 7s ago
   Main PID: 2904 (beam.smp)
     Status: &quot;Initialized&quot;
     CGroup: /system.slice/rabbitmq-server.service
             \u251C\u25002904 /usr/lib64/erlang/erts-10.4.4/bin/beam.smp -W w -A 64 -MBas ageffcbf -MHas ageffcbf -
             MBlmbcs...
             \u251C\u25003220 erl_child_setup 32768
             \u251C\u25003243 inet_gethost 4
             \u2514\u25003244 inet_gethost 4
      .........
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20190925222743776-3836511.png" alt="" loading="lazy"></p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">10.</span> \u5173\u95ED\u9632\u706B\u5899\u670D\u52A1
	systemctl disable firewalld
    Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.
    Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.
	systemctl stop firewalld   

<span class="token list punctuation">11.</span> \u8BBF\u95EE Web \u7BA1\u7406\u754C\u9762
	http://10.15.0.8:15672/
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20190926194738708-3836601.png" alt="" loading="lazy"></p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">12.</span> \u767B\u5F55\u7BA1\u7406\u754C\u9762
	username:  guest
	password:  guest
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20190926194954822-3836665.png" alt="" loading="lazy"></p><hr><h2 id="_3-rabiitmq-\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_3-rabiitmq-\u914D\u7F6E" aria-hidden="true">#</a> 3. RabiitMQ \u914D\u7F6E</h2><h3 id="_3-1-rabbitmq-\u7BA1\u7406\u547D\u4EE4\u884C" tabindex="-1"><a class="header-anchor" href="#_3-1-rabbitmq-\u7BA1\u7406\u547D\u4EE4\u884C" aria-hidden="true">#</a> 3.1 RabbitMQ \u7BA1\u7406\u547D\u4EE4\u884C</h3><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">1.</span> \u670D\u52A1\u542F\u52A8\u76F8\u5173
	systemctl start|restart|stop|status rabbitmq-server

<span class="token list punctuation">2.</span> \u7BA1\u7406\u547D\u4EE4\u884C \u7528\u6765\u5728\u4E0D\u4F7F\u7528 Web \u7BA1\u7406\u754C\u9762\u60C5\u51B5\u4E0B\u547D\u4EE4\u64CD\u4F5C RabbitMQ
	rabbitmqctl  help  \u53EF\u4EE5\u67E5\u770B\u66F4\u591A\u547D\u4EE4

<span class="token list punctuation">3.</span> \u63D2\u4EF6\u7BA1\u7406\u547D\u4EE4\u884C
	rabbitmq-plugins enable|list|disable 
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_3-2-web-\u7BA1\u7406\u754C\u9762\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#_3-2-web-\u7BA1\u7406\u754C\u9762\u4ECB\u7ECD" aria-hidden="true">#</a> 3.2 Web \u7BA1\u7406\u754C\u9762\u4ECB\u7ECD</h3><h4 id="_3-2-1-overview-\u6982\u89C8" tabindex="-1"><a class="header-anchor" href="#_3-2-1-overview-\u6982\u89C8" aria-hidden="true">#</a> 3.2.1 Overview \u6982\u89C8</h4><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20191126162026720.png" alt="" loading="lazy"></p><ul><li><code>connections</code>\uFF1A\u65E0\u8BBA\u751F\u4EA7\u8005\u8FD8\u662F\u6D88\u8D39\u8005\uFF0C\u90FD\u9700\u8981\u4E0E RabbitMQ \u5EFA\u7ACB\u8FDE\u63A5\u540E\u624D\u53EF\u4EE5\u5B8C\u6210\u6D88\u606F\u7684\u751F\u4EA7\u548C\u6D88\u8D39\uFF0C\u5728\u8FD9\u91CC\u53EF\u4EE5\u67E5\u770B\u8FDE\u63A5\u60C5\u51B5</li><li><code>channels</code>\uFF1A\u901A\u9053\uFF0C\u5EFA\u7ACB\u8FDE\u63A5\u540E\uFF0C\u4F1A\u5F62\u6210\u901A\u9053\uFF0C\u6D88\u606F\u7684\u6295\u9012\u83B7\u53D6\u4F9D\u8D56\u901A\u9053\u3002</li><li><code>Exchanges</code>\uFF1A\u4EA4\u6362\u673A\uFF0C\u7528\u6765\u5B9E\u73B0\u6D88\u606F\u7684\u8DEF\u7531</li><li><code>Queues</code>\uFF1A\u961F\u5217\uFF0C\u5373\u6D88\u606F\u961F\u5217\uFF0C\u6D88\u606F\u5B58\u653E\u5728\u961F\u5217\u4E2D\uFF0C\u7B49\u5F85\u6D88\u8D39\uFF0C\u6D88\u8D39\u540E\u88AB\u79FB\u9664\u961F\u5217\u3002</li></ul><h4 id="_3-2-2-admin-\u7528\u6237\u548C\u865A\u62DF\u4E3B\u673A\u7BA1\u7406" tabindex="-1"><a class="header-anchor" href="#_3-2-2-admin-\u7528\u6237\u548C\u865A\u62DF\u4E3B\u673A\u7BA1\u7406" aria-hidden="true">#</a> 3.2.2 Admin \u7528\u6237\u548C\u865A\u62DF\u4E3B\u673A\u7BA1\u7406</h4><ol><li>\u6DFB\u52A0\u7528\u6237</li></ol><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20191126162617280.png" alt="" loading="lazy"></p><p>\u4E0A\u9762\u7684 Tags \u9009\u9879\uFF0C\u5176\u5B9E\u662F\u6307\u5B9A\u7528\u6237\u7684\u89D2\u8272\uFF0C\u53EF\u9009\u7684\u6709\u4EE5\u4E0B\u51E0\u4E2A\uFF1A</p><ul><li><code>\u8D85\u7EA7\u7BA1\u7406\u5458(administrator)</code>\uFF1A\u53EF\u767B\u9646\u7BA1\u7406\u63A7\u5236\u53F0\uFF0C\u53EF\u67E5\u770B\u6240\u6709\u7684\u4FE1\u606F\uFF0C\u5E76\u4E14\u53EF\u4EE5\u5BF9\u7528\u6237\uFF0C\u7B56\u7565(policy)\u8FDB\u884C\u64CD\u4F5C\u3002</li><li><code>\u76D1\u63A7\u8005(monitoring)</code>\uFF1A\u53EF\u767B\u9646\u7BA1\u7406\u63A7\u5236\u53F0\uFF0C\u540C\u65F6\u53EF\u4EE5\u67E5\u770B RabbitMQ \u8282\u70B9\u7684\u76F8\u5173\u4FE1\u606F(\u8FDB\u7A0B\u6570\uFF0C\u5185\u5B58\u4F7F\u7528\u60C5\u51B5\uFF0C\u78C1\u76D8\u4F7F\u7528\u60C5\u51B5\u7B49)</li><li><code>\u7B56\u7565\u5236\u5B9A\u8005(policymaker)</code>\uFF1A\u53EF\u767B\u9646\u7BA1\u7406\u63A7\u5236\u53F0, \u540C\u65F6\u53EF\u4EE5\u5BF9 policy \u8FDB\u884C\u7BA1\u7406\uFF0C\u4F46\u65E0\u6CD5\u67E5\u770B\u8282\u70B9\u7684\u76F8\u5173\u4FE1\u606F(\u4E0A\u56FE\u7EA2\u6846\u6807\u8BC6\u7684\u90E8\u5206)\u3002</li><li><code>\u666E\u901A\u7BA1\u7406\u8005(management)</code>\uFF1A\u4EC5\u53EF\u767B\u9646\u7BA1\u7406\u63A7\u5236\u53F0\uFF0C\u65E0\u6CD5\u770B\u5230\u8282\u70B9\u4FE1\u606F\uFF0C\u4E5F\u65E0\u6CD5\u5BF9\u7B56\u7565\u8FDB\u884C\u7BA1\u7406\u3002</li><li><code>\u5176\u4ED6</code>\uFF1A\u65E0\u6CD5\u767B\u9646\u7BA1\u7406\u63A7\u5236\u53F0\uFF0C\u901A\u5E38\u5C31\u662F\u666E\u901A\u7684\u751F\u4EA7\u8005\u548C\u6D88\u8D39\u8005\u3002</li></ul><ol start="2"><li>\u521B\u5EFA\u865A\u62DF\u4E3B\u673A</li></ol><p>\u4E3A\u4E86\u8BA9\u5404\u4E2A\u7528\u6237\u53EF\u4EE5\u4E92\u4E0D\u5E72\u6270\u7684\u5DE5\u4F5C\uFF0CRabbitMQ \u6DFB\u52A0\u4E86\u865A\u62DF\u4E3B\u673A\uFF08Virtual Hosts\uFF09\u7684\u6982\u5FF5\u3002\u5176\u5B9E\u5C31\u662F\u4E00\u4E2A\u72EC\u7ACB\u7684\u8BBF\u95EE\u8DEF\u5F84\uFF0C\u4E0D\u540C\u7528\u6237\u4F7F\u7528\u4E0D\u540C\u8DEF\u5F84\uFF0C\u5404\u81EA\u6709\u81EA\u5DF1\u7684\u961F\u5217\u3001\u4EA4\u6362\u673A\uFF0C\u4E92\u76F8\u4E0D\u4F1A\u5F71\u54CD\u3002</p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20191126163023153.png" alt="" loading="lazy"></p><ol start="3"><li>\u7ED1\u5B9A\u865A\u62DF\u4E3B\u673A\u548C\u7528\u6237</li></ol><p>\u521B\u5EFA\u597D\u865A\u62DF\u4E3B\u673A\uFF0C\u8FD8\u8981\u7ED9\u7528\u6237\u6DFB\u52A0\u8BBF\u95EE\u6743\u9650\u3002</p><p>\u70B9\u51FB\u6DFB\u52A0\u597D\u7684\u865A\u62DF\u4E3B\u673A\uFF1A</p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20191126163506795.png" alt="" loading="lazy"></p><p>\u8FDB\u5165\u865A\u62DF\u673A\u8BBE\u7F6E\u754C\u9762\uFF1A</p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20191126163631889.png" alt="" loading="lazy"></p><hr><h2 id="_4-rabbitmq-\u7684\u7B2C\u4E00\u4E2A\u7A0B\u5E8F" tabindex="-1"><a class="header-anchor" href="#_4-rabbitmq-\u7684\u7B2C\u4E00\u4E2A\u7A0B\u5E8F" aria-hidden="true">#</a> 4. RabbitMQ \u7684\u7B2C\u4E00\u4E2A\u7A0B\u5E8F</h2><h3 id="_4-0-amqp-\u534F\u8BAE\u7684\u56DE\u987E" tabindex="-1"><a class="header-anchor" href="#_4-0-amqp-\u534F\u8BAE\u7684\u56DE\u987E" aria-hidden="true">#</a> 4.0 AMQP \u534F\u8BAE\u7684\u56DE\u987E</h3><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200312140114784.png" alt="" loading="lazy"></p><h3 id="_4-1-rabbitmq-\u652F\u6301\u7684\u6D88\u606F\u6A21\u578B" tabindex="-1"><a class="header-anchor" href="#_4-1-rabbitmq-\u652F\u6301\u7684\u6D88\u606F\u6A21\u578B" aria-hidden="true">#</a> 4.1 RabbitMQ \u652F\u6301\u7684\u6D88\u606F\u6A21\u578B</h3><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20191126165434784.png" alt="" loading="lazy"></p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20191126165459282.png" alt="" loading="lazy"></p><h3 id="_4-2-\u5F15\u5165\u4F9D\u8D56" tabindex="-1"><a class="header-anchor" href="#_4-2-\u5F15\u5165\u4F9D\u8D56" aria-hidden="true">#</a> 4.2 \u5F15\u5165\u4F9D\u8D56</h3><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.rabbitmq<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>amqp-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.7.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_4-3-\u7B2C\u4E00\u79CD\u6A21\u578B-\u76F4\u8FDE" tabindex="-1"><a class="header-anchor" href="#_4-3-\u7B2C\u4E00\u79CD\u6A21\u578B-\u76F4\u8FDE" aria-hidden="true">#</a> 4.3 \u7B2C\u4E00\u79CD\u6A21\u578B\uFF08\u76F4\u8FDE\uFF09</h3><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20191126165840602.png" alt="" loading="lazy"></p><p>\u5728\u4E0A\u56FE\u7684\u6A21\u578B\u4E2D\uFF0C\u6709\u4EE5\u4E0B\u6982\u5FF5\uFF1A</p><ul><li>P\uFF1A\u751F\u4EA7\u8005\uFF0C\u4E5F\u5C31\u662F\u8981\u53D1\u9001\u6D88\u606F\u7684\u7A0B\u5E8F</li><li>C\uFF1A\u6D88\u8D39\u8005\uFF1A\u6D88\u606F\u7684\u63A5\u53D7\u8005\uFF0C\u4F1A\u4E00\u76F4\u7B49\u5F85\u6D88\u606F\u5230\u6765\u3002</li><li>queue\uFF1A\u6D88\u606F\u961F\u5217\uFF0C\u56FE\u4E2D\u7EA2\u8272\u90E8\u5206\u3002\u7C7B\u4F3C\u4E00\u4E2A\u90AE\u7BB1\uFF0C\u53EF\u4EE5\u7F13\u5B58\u6D88\u606F\uFF1B\u751F\u4EA7\u8005\u5411\u5176\u4E2D\u6295\u9012\u6D88\u606F\uFF0C\u6D88\u8D39\u8005\u4ECE\u5176\u4E2D\u53D6\u51FA\u6D88\u606F\u3002</li></ul><ol><li>\u5F00\u53D1\u751F\u4EA7\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//\u521B\u5EFA\u8FDE\u63A5\u5DE5\u5382</span>
<span class="token class-name">ConnectionFactory</span> connectionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
connectionFactory<span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;10.15.0.9&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
connectionFactory<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5672</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
connectionFactory<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">&quot;ems&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
connectionFactory<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
connectionFactory<span class="token punctuation">.</span><span class="token function">setVirtualHost</span><span class="token punctuation">(</span><span class="token string">&quot;/ems&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Connection</span> connection <span class="token operator">=</span> connectionFactory<span class="token punctuation">.</span><span class="token function">newConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u521B\u5EFA\u901A\u9053</span>
<span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u53C2\u65701: \u662F\u5426\u6301\u4E45\u5316  \u53C2\u65702:\u662F\u5426\u72EC\u5360\u961F\u5217 \u53C2\u65703:\u662F\u5426\u81EA\u52A8\u5220\u9664  \u53C2\u65704:\u5176\u4ED6\u5C5E\u6027</span>
channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;hello rabbitmq&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
channel<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ol start="2"><li>\u5F00\u53D1\u6D88\u8D39\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//\u521B\u5EFA\u8FDE\u63A5\u5DE5\u5382</span>
<span class="token class-name">ConnectionFactory</span> connectionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
connectionFactory<span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;10.15.0.9&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
connectionFactory<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5672</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
connectionFactory<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">&quot;ems&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
connectionFactory<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
connectionFactory<span class="token punctuation">.</span><span class="token function">setVirtualHost</span><span class="token punctuation">(</span><span class="token string">&quot;/ems&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Connection</span> connection <span class="token operator">=</span> connectionFactory<span class="token punctuation">.</span><span class="token function">newConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ol start="3"><li>\u53C2\u6570\u8BF4\u660E</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// \u53C2\u65701\uFF1A\u7528\u6765\u58F0\u660E\u901A\u9053\u5BF9\u5E94\u7684\u961F\u5217</span>
<span class="token comment">// \u53C2\u65702\uFF1A\u7528\u6765\u6307\u5B9A\u662F\u5426\u6301\u4E45\u5316\u961F\u5217</span>
<span class="token comment">// \u53C2\u65703\uFF1A\u7528\u6765\u6307\u5B9A\u662F\u5426\u72EC\u5360\u961F\u5217</span>
<span class="token comment">// \u53C2\u65704\uFF1A\u7528\u6765\u6307\u5B9A\u662F\u5426\u81EA\u52A8\u5220\u9664\u961F\u5217</span>
<span class="token comment">// \u53C2\u65705\uFF1A\u5BF9\u961F\u5217\u7684\u989D\u5916\u914D\u7F6E</span>
channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_4-4-\u7B2C\u4E8C\u79CD\u6A21\u578B-work" tabindex="-1"><a class="header-anchor" href="#_4-4-\u7B2C\u4E8C\u79CD\u6A21\u578B-work" aria-hidden="true">#</a> 4.4 \u7B2C\u4E8C\u79CD\u6A21\u578B(Work)</h3><p><code>Work queues</code>\uFF0C\u4E5F\u88AB\u79F0\u4E3A\u4EFB\u52A1\u6A21\u578B\uFF08<code>Task queues</code>\uFF09\u3002\u5F53\u6D88\u606F\u5904\u7406\u6BD4\u8F83\u8017\u65F6\u7684\u65F6\u5019\uFF0C\u53EF\u80FD\u751F\u4EA7\u6D88\u606F\u7684\u901F\u5EA6\u4F1A\u8FDC\u8FDC\u5927\u4E8E\u6D88\u606F\u7684\u6D88\u8D39\u901F\u5EA6\u3002\u957F\u6B64\u4EE5\u5F80\uFF0C\u6D88\u606F\u5C31\u4F1A\u5806\u79EF\u8D8A\u6765\u8D8A\u591A\uFF0C\u65E0\u6CD5\u53CA\u65F6\u5904\u7406\u3002\u6B64\u65F6\u5C31\u53EF\u4EE5\u4F7F\u7528 Work \u6A21\u578B\uFF1A<strong>\u8BA9\u591A\u4E2A\u6D88\u8D39\u8005\u7ED1\u5B9A\u5230\u4E00\u4E2A\u961F\u5217\uFF0C\u5171\u540C\u6D88\u8D39\u961F\u5217\u4E2D\u7684\u6D88\u606F</strong>\u3002\u961F\u5217\u4E2D\u7684\u6D88\u606F\u4E00\u65E6\u6D88\u8D39\uFF0C\u5C31\u4F1A\u6D88\u5931\uFF0C\u56E0\u6B64\u4EFB\u52A1\u662F\u4E0D\u4F1A\u88AB\u91CD\u590D\u6267\u884C\u7684\u3002</p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200314221002008.png" alt="" loading="lazy"></p><p>\u89D2\u8272\uFF1A</p><ul><li>P\uFF1A\u751F\u4EA7\u8005\uFF1A\u4EFB\u52A1\u7684\u53D1\u5E03\u8005</li><li>C1\uFF1A\u6D88\u8D39\u8005-1\uFF0C\u9886\u53D6\u4EFB\u52A1\u5E76\u4E14\u5B8C\u6210\u4EFB\u52A1\uFF0C\u5047\u8BBE\u5B8C\u6210\u901F\u5EA6\u8F83\u6162</li><li>C2\uFF1A\u6D88\u8D39\u8005-2\uFF1A\u9886\u53D6\u4EFB\u52A1\u5E76\u5B8C\u6210\u4EFB\u52A1\uFF0C\u5047\u8BBE\u5B8C\u6210\u901F\u5EA6\u5FEB</li></ul><ol><li>\u5F00\u53D1\u751F\u4EA7\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">&quot;====&gt;:\u6211\u662F\u6D88\u606F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li>\u5F00\u53D1\u6D88\u8D39\u8005-1</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u80051: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="3"><li>\u5F00\u53D1\u6D88\u8D39\u8005-2</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//\u5904\u7406\u6D88\u606F\u6BD4\u8F83\u6162 \u4E00\u79D2\u5904\u7406\u4E00\u4E2A\u6D88\u606F</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u80052: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ol start="4"><li>\u6D4B\u8BD5\u7ED3\u679C</li></ol><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200314223242058.png" alt="" loading="lazy"></p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200314223302207.png" alt="" loading="lazy"></p><blockquote><p><strong>\u603B\u7ED3</strong>\uFF1A\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0CRabbitMQ \u5C06\u6309\u987A\u5E8F\u5C06\u6BCF\u4E2A\u6D88\u606F\u53D1\u9001\u7ED9\u4E0B\u4E00\u4E2A\u4F7F\u7528\u8005\u3002\u5E73\u5747\u800C\u8A00\uFF0C<strong>\u6BCF\u4E2A\u6D88\u8D39\u8005\u90FD\u4F1A\u6536\u5230\u76F8\u540C\u6570\u91CF\u7684\u6D88\u606F\uFF0C\u8FD9\u79CD\u5206\u53D1\u6D88\u606F\u7684\u65B9\u5F0F\u79F0\u4E3A\u5FAA\u73AF</strong>\u3002</p></blockquote><ol start="5"><li>\u6D88\u606F\u81EA\u52A8\u786E\u8BA4\u673A\u5236</li></ol><blockquote><p>Doing a task can take a few seconds. You may wonder what happens if one of the consumers starts a long task and dies with it only partly done. With our current code, once RabbitMQ delivers a message to the consumer it immediately marks it for deletion. In this case, if you kill a worker we will lose the message it was just processing. We&#39;ll also lose all the messages that were dispatched to this particular worker but were not yet handled.</p><p>But we don&#39;t want to lose any tasks. If a worker dies, we&#39;d like the task to be delivered to another worker.</p></blockquote><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>channel<span class="token punctuation">.</span><span class="token function">basicQos</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u4E00\u6B21\u53EA\u63A5\u53D7\u4E00\u6761\u672A\u786E\u8BA4\u7684\u6D88\u606F</span>
<span class="token comment">//\u53C2\u65702:\u5173\u95ED\u81EA\u52A8\u786E\u8BA4\u6D88\u606F</span>
channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u80051: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    channel<span class="token punctuation">.</span><span class="token function">basicAck</span><span class="token punctuation">(</span>envelope<span class="token punctuation">.</span><span class="token function">getDeliveryTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u624B\u52A8\u786E\u8BA4\u6D88\u606F</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>\u8BBE\u7F6E\u901A\u9053\u4E00\u6B21\u53EA\u80FD\u6D88\u8D39\u4E00\u4E2A\u6D88\u606F</li><li>\u5173\u95ED\u6D88\u606F\u7684\u81EA\u52A8\u786E\u8BA4\uFF0C\u5F00\u542F\u624B\u52A8\u786E\u8BA4\u6D88\u606F</li></ul><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200314230412178.png" alt="" loading="lazy"></p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200314230423280.png" alt="" loading="lazy"></p><h3 id="_4-5-\u7B2C\u4E09\u79CD\u6A21\u578B-fanout" tabindex="-1"><a class="header-anchor" href="#_4-5-\u7B2C\u4E09\u79CD\u6A21\u578B-fanout" aria-hidden="true">#</a> 4.5 \u7B2C\u4E09\u79CD\u6A21\u578B(Fanout)</h3><p>Fanout \u6247\u51FA\u4E5F\u79F0\u4E3A\u5E7F\u64AD\u3002</p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20191126213115873.png" alt="" loading="lazy"></p><p>\u5728\u5E7F\u64AD\u6A21\u5F0F\u4E0B\uFF0C\u6D88\u606F\u53D1\u9001\u6D41\u7A0B\u662F\u8FD9\u6837\u7684\uFF1A</p><ul><li>\u53EF\u4EE5\u6709\u591A\u4E2A\u6D88\u8D39\u8005</li><li>\u6BCF\u4E2A<strong>\u6D88\u8D39\u8005\u6709\u81EA\u5DF1\u7684 queue</strong>\uFF08\u961F\u5217\uFF09</li><li>\u6BCF\u4E2A<strong>\u961F\u5217\u90FD\u8981\u7ED1\u5B9A\u5230 Exchange</strong>\uFF08\u4EA4\u6362\u673A\uFF09</li><li><strong>\u751F\u4EA7\u8005\u53D1\u9001\u7684\u6D88\u606F\uFF0C\u53EA\u80FD\u53D1\u9001\u5230\u4EA4\u6362\u673A</strong>\uFF0C\u4EA4\u6362\u673A\u6765\u51B3\u5B9A\u8981\u53D1\u7ED9\u54EA\u4E2A\u961F\u5217\uFF0C\u751F\u4EA7\u8005\u65E0\u6CD5\u51B3\u5B9A</li><li>\u4EA4\u6362\u673A\u628A\u6D88\u606F\u53D1\u9001\u7ED9\u7ED1\u5B9A\u8FC7\u7684\u6240\u6709\u961F\u5217</li><li>\u961F\u5217\u7684\u6D88\u8D39\u8005\u90FD\u80FD\u62FF\u5230\u6D88\u606F\uFF0C\u5B9E\u73B0\u4E00\u6761\u6D88\u606F\u88AB\u591A\u4E2A\u6D88\u8D39\u8005\u6D88\u8D39</li></ul><ol><li>\u5F00\u53D1\u751F\u4EA7\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//\u58F0\u660E\u4EA4\u6362\u673A</span>
channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u5E7F\u64AD \u4E00\u6761\u6D88\u606F\u591A\u4E2A\u6D88\u8D39\u8005\u540C\u65F6\u6D88\u8D39</span>
<span class="token comment">//\u53D1\u5E03\u6D88\u606F</span>
channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li>\u5F00\u53D1\u6D88\u8D39\u8005-1</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//\u7ED1\u5B9A\u4EA4\u6362\u673A</span>
channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
<span class="token class-name">String</span> queue <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u5C06\u4E34\u65F6\u961F\u5217\u7ED1\u5B9Aexchange</span>
channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u5904\u7406\u6D88\u606F</span>
channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u80051: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ol start="3"><li>\u5F00\u53D1\u6D88\u8D39\u8005-2</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//\u7ED1\u5B9A\u4EA4\u6362\u673A</span>
channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
<span class="token class-name">String</span> queue <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u5C06\u4E34\u65F6\u961F\u5217\u7ED1\u5B9Aexchange</span>
channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u5904\u7406\u6D88\u606F</span>
channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u80052: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ol start="4"><li>\u5F00\u53D1\u6D88\u8D39\u8005-3</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//\u7ED1\u5B9A\u4EA4\u6362\u673A</span>
channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
<span class="token class-name">String</span> queue <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u5C06\u4E34\u65F6\u961F\u5217\u7ED1\u5B9Aexchange</span>
channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u5904\u7406\u6D88\u606F</span>
channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u80053: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ol start="5"><li>\u6D4B\u8BD5\u7ED3\u679C</li></ol><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200315180653207.png" alt="" loading="lazy"></p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200315180708489.png" alt="" loading="lazy"></p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200315180728035.png" alt="" loading="lazy"></p><h3 id="_4-6-\u7B2C\u56DB\u79CD\u6A21\u578B-routing" tabindex="-1"><a class="header-anchor" href="#_4-6-\u7B2C\u56DB\u79CD\u6A21\u578B-routing" aria-hidden="true">#</a> 4.6 \u7B2C\u56DB\u79CD\u6A21\u578B(Routing)</h3><h4 id="_4-6-1-routing-\u4E4B\u8BA2\u9605\u6A21\u578B-direct-\u76F4\u8FDE" tabindex="-1"><a class="header-anchor" href="#_4-6-1-routing-\u4E4B\u8BA2\u9605\u6A21\u578B-direct-\u76F4\u8FDE" aria-hidden="true">#</a> 4.6.1 Routing \u4E4B\u8BA2\u9605\u6A21\u578B-Direct(\u76F4\u8FDE)</h4><p>\u5728 Fanout \u6A21\u5F0F\u4E2D\uFF0C\u4E00\u6761\u6D88\u606F\uFF0C\u4F1A\u88AB\u6240\u6709\u8BA2\u9605\u7684\u961F\u5217\u90FD\u6D88\u8D39\u3002\u4F46\u662F\uFF0C\u5728\u67D0\u4E9B\u573A\u666F\u4E0B\uFF0C\u6211\u4EEC\u5E0C\u671B\u4E0D\u540C\u7684\u6D88\u606F\u88AB\u4E0D\u540C\u7684\u961F\u5217\u6D88\u8D39\uFF0C\u8FD9\u65F6\u5C31\u8981\u7528\u5230 Direct \u7C7B\u578B\u7684 Exchange.</p><p>\u5728 Direct \u6A21\u578B\u4E0B\uFF1A</p><ul><li>\u961F\u5217\u4E0E\u4EA4\u6362\u673A\u7684\u7ED1\u5B9A\uFF0C\u4E0D\u80FD\u662F\u4EFB\u610F\u7ED1\u5B9A\u4E86\uFF0C\u800C\u662F\u8981\u6307\u5B9A\u4E00\u4E2A <code>RoutingKey</code> \uFF08\u8DEF\u7531 key\uFF09</li><li>\u6D88\u606F\u7684\u53D1\u9001\u65B9\u5728 \u5411 Exchange\u53D1\u9001\u6D88\u606F\u65F6\uFF0C\u4E5F\u5FC5\u987B\u6307\u5B9A\u6D88\u606F\u7684 <code>RoutingKey</code>.</li><li>Exchange\u4E0D\u518D\u628A\u6D88\u606F\u4EA4\u7ED9\u6BCF\u4E00\u4E2A\u7ED1\u5B9A\u7684\u961F\u5217\uFF0C\u800C\u662F\u6839\u636E\u6D88\u606F\u7684 <code>RoutingKey</code> \u8FDB\u884C\u5224\u65AD\uFF0C\u53EA\u6709\u961F\u5217\u7684 <code>RoutingKey</code> \u4E0E\u6D88\u606F\u7684 <code>RoutingKey</code> \u5B8C\u5168\u4E00\u81F4\uFF0C\u624D\u4F1A\u63A5\u6536\u5230\u6D88\u606F</li></ul><p>\u6D41\u7A0B:</p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20191126220145375.png" alt="" loading="lazy"></p><p>\u56FE\u89E3\uFF1A</p><ul><li>P\uFF1A\u751F\u4EA7\u8005\uFF0C\u5411 Exchange \u53D1\u9001\u6D88\u606F\uFF0C\u53D1\u9001\u6D88\u606F\u65F6\uFF0C\u4F1A\u6307\u5B9A\u4E00\u4E2A RoutingKey.</li><li>X\uFF1AExchange\uFF08\u4EA4\u6362\u673A\uFF09\uFF0C\u63A5\u6536\u751F\u4EA7\u8005\u7684\u6D88\u606F\uFF0C\u7136\u540E\u628A\u6D88\u606F\u9012\u4EA4\u7ED9 \u4E0E RoutingKey \u5B8C\u5168\u5339\u914D\u7684\u961F\u5217</li><li>C1\uFF1A\u6D88\u8D39\u8005\uFF0C\u5176\u6240\u5728\u961F\u5217\u6307\u5B9A\u4E86\u9700\u8981 RoutingKey \u4E3A error \u7684\u6D88\u606F</li><li>C2\uFF1A\u6D88\u8D39\u8005\uFF0C\u5176\u6240\u5728\u961F\u5217\u6307\u5B9A\u4E86\u9700\u8981 RoutingKey \u4E3A info\u3001error\u3001warn \u7684\u6D88\u606F</li></ul><ol><li>\u5F00\u53D1\u751F\u4EA7\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//\u58F0\u660E\u4EA4\u6362\u673A  \u53C2\u65701:\u4EA4\u6362\u673A\u540D\u79F0 \u53C2\u65702:\u4EA4\u6362\u673A\u7C7B\u578B \u57FA\u4E8E\u6307\u4EE4\u7684Routing key\u8F6C\u53D1</span>
channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;direct&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//\u53D1\u5E03\u6D88\u606F</span>
channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;\u6307\u5B9A\u7684route key&quot;</span> <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">&quot;\u7684\u6D88\u606F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="2"><li>\u5F00\u53D1\u6D88\u8D39\u8005-1</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token comment">//\u58F0\u660E\u4EA4\u6362\u673A</span>
channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;direct&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
<span class="token class-name">String</span> queue <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u7ED1\u5B9A\u961F\u5217\u548C\u4EA4\u6362\u673A</span>
channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;info&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;warn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//\u6D88\u8D39\u6D88\u606F</span>
channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u80051: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ol start="3"><li>\u5F00\u53D1\u6D88\u8D39\u8005-2</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//\u58F0\u660E\u4EA4\u6362\u673A</span>
channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;direct&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
<span class="token class-name">String</span> queue <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u7ED1\u5B9A\u961F\u5217\u548C\u4EA4\u6362\u673A</span>
channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u6D88\u8D39\u6D88\u606F</span>
channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u80052: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ol start="4"><li>\u6D4B\u8BD5\u751F\u4EA7\u8005\u53D1\u9001 RoutingKey \u4E3A error \u7684\u6D88\u606F\u65F6</li></ol><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200316102613933.png" alt="" loading="lazy"></p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200316102627912.png" alt="" loading="lazy"></p><ol start="5"><li>\u6D4B\u8BD5\u751F\u4EA7\u8005\u53D1\u9001 RoutingKey \u4E3A info \u7684\u6D88\u606F\u65F6</li></ol><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200316102925740.png" alt="" loading="lazy"></p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200316102947326.png" alt="" loading="lazy"></p><h4 id="_4-6-2-routing-\u4E4B\u8BA2\u9605\u6A21\u578B-topic" tabindex="-1"><a class="header-anchor" href="#_4-6-2-routing-\u4E4B\u8BA2\u9605\u6A21\u578B-topic" aria-hidden="true">#</a> 4.6.2 Routing \u4E4B\u8BA2\u9605\u6A21\u578B-Topic</h4><p><code>Topic</code> \u7C7B\u578B\u7684 <code>Exchange</code> \u4E0E <code>Direct</code> \u76F8\u6BD4\uFF0C\u90FD\u662F\u53EF\u4EE5\u6839\u636E <code>RoutingKey</code> \u628A\u6D88\u606F\u8DEF\u7531\u5230\u4E0D\u540C\u7684\u961F\u5217\u3002\u53EA\u4E0D\u8FC7 <code>Topic</code> \u7C7B\u578B <code>Exchange</code> \u53EF\u4EE5\u8BA9\u961F\u5217\u5728\u7ED1\u5B9A <code>RoutingKey</code> \u7684\u65F6\u5019\u4F7F\u7528\u901A\u914D\u7B26\uFF01\u8FD9\u79CD\u6A21\u578B<code>RoutingKey</code> \u4E00\u822C\u90FD\u662F\u7531\u4E00\u4E2A\u6216\u591A\u4E2A\u5355\u8BCD\u7EC4\u6210\uFF0C\u591A\u4E2A\u5355\u8BCD\u4E4B\u95F4\u4EE5\u201D.\u201D\u5206\u5272\uFF0C\u4F8B\u5982\uFF1A <code>item.insert</code></p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20191127121900255.png" alt="" loading="lazy"></p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code>\u901A\u914D\u7B26\uFF1A
  <span class="token list punctuation">*</span> (star) can substitute for exactly one word.    \u5339\u914D\u4E0D\u591A\u4E0D\u5C11\u6070\u597D1\u4E2A\u8BCD
  <span class="token title important"><span class="token punctuation">#</span> (hash) can substitute for zero or more words.  \u5339\u914D\u4E00\u4E2A\u6216\u591A\u4E2A\u8BCD</span>
\u5982\uFF1A
  audit.#    \u5339\u914Daudit.irs.corporate\u6216\u8005 audit.irs \u7B49
  audit.*   \u53EA\u80FD\u5339\u914D audit.irs
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol><li>\u5F00\u53D1\u751F\u4EA7\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//\u751F\u547D\u4EA4\u6362\u673A\u548C\u4EA4\u6362\u673A\u7C7B\u578B topic \u4F7F\u7528\u52A8\u6001\u8DEF\u7531(\u901A\u914D\u7B26\u65B9\u5F0F)</span>
channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;topic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> routekey <span class="token operator">=</span> <span class="token string">&quot;user.save&quot;</span><span class="token punctuation">;</span><span class="token comment">//\u52A8\u6001\u8DEF\u7531key</span>
<span class="token comment">//\u53D1\u5E03\u6D88\u606F</span>
channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span> routekey<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;\u8FD9\u662F\u8DEF\u7531\u4E2D\u7684\u52A8\u6001\u8BA2\u9605\u6A21\u578B,route key: [&quot;</span> <span class="token operator">+</span> routekey <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="2"><li>\u5F00\u53D1\u6D88\u8D39\u8005-1</li></ol><p>RoutingKey \u4E2D\u4F7F\u7528 * \u901A\u914D\u7B26\u65B9\u5F0F\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token comment">//\u58F0\u660E\u4EA4\u6362\u673A</span>
channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;topic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
<span class="token class-name">String</span> queue <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u7ED1\u5B9A\u961F\u5217\u4E0E\u4EA4\u6362\u673A\u5E76\u8BBE\u7F6E\u83B7\u53D6\u4EA4\u6362\u673A\u4E2D\u52A8\u6001\u8DEF\u7531</span>
channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user.*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//\u6D88\u8D39\u6D88\u606F</span>
channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u80051: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ol start="3"><li>\u5F00\u53D1\u6D88\u8D39\u8005-2</li></ol><p>RoutingKey \u4E2D\u4F7F\u7528 # \u901A\u914D\u7B26\u65B9\u5F0F\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//\u58F0\u660E\u4EA4\u6362\u673A</span>
channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;topic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
<span class="token class-name">String</span> queue <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//\u7ED1\u5B9A\u961F\u5217\u4E0E\u4EA4\u6362\u673A\u5E76\u8BBE\u7F6E\u83B7\u53D6\u4EA4\u6362\u673A\u4E2D\u52A8\u6001\u8DEF\u7531</span>
channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user.#&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//\u6D88\u8D39\u6D88\u606F</span>
channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u80052: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ol start="4"><li>\u6D4B\u8BD5\u7ED3\u679C</li></ol><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200316113935785.png" alt="" loading="lazy"></p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200316114000459.png" alt="" loading="lazy"></p><h2 id="_5-springboot-\u96C6\u6210-rabbitmq" tabindex="-1"><a class="header-anchor" href="#_5-springboot-\u96C6\u6210-rabbitmq" aria-hidden="true">#</a> 5. SpringBoot \u96C6\u6210 RabbitMQ</h2><h3 id="_5-0-\u73AF\u5883\u642D\u5EFA" tabindex="-1"><a class="header-anchor" href="#_5-0-\u73AF\u5883\u642D\u5EFA" aria-hidden="true">#</a> 5.0 \u73AF\u5883\u642D\u5EFA</h3><ol><li>\u5F15\u5165\u4F9D\u8D56</li></ol><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-amqp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li>\u914D\u7F6E\u914D\u7F6E\u6587\u4EF6</li></ol><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> springboot_rabbitmq
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> 10.15.0.9
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> ems
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123</span>
    <span class="token key atrule">virtual-host</span><span class="token punctuation">:</span> /ems
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>RabbitTemplate</code> \u7528\u6765\u7B80\u5316\u64CD\u4F5C\uFF0C\u4F7F\u7528\u65F6\u5019\u76F4\u63A5\u5728\u9879\u76EE\u4E2D\u6CE8\u5165\u5373\u53EF\u4F7F\u7528\u3002</p><h3 id="_5-1-\u7B2C\u4E00\u79CD-hello-world-\u6A21\u578B\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#_5-1-\u7B2C\u4E00\u79CD-hello-world-\u6A21\u578B\u4F7F\u7528" aria-hidden="true">#</a> 5.1 \u7B2C\u4E00\u79CD hello world \u6A21\u578B\u4F7F\u7528</h3><ol><li>\u5F00\u53D1\u751F\u4EA7\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="2"><li>\u5F00\u53D1\u6D88\u8D39\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queuesToDeclare <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloCustomer</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@RabbitHandler</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive1</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;message = &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_5-2-\u7B2C\u4E8C\u79CD-work-\u6A21\u578B\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#_5-2-\u7B2C\u4E8C\u79CD-work-\u6A21\u578B\u4F7F\u7528" aria-hidden="true">#</a> 5.2 \u7B2C\u4E8C\u79CD Work \u6A21\u578B\u4F7F\u7528</h3><ol><li>\u5F00\u53D1\u751F\u4EA7\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;work&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;hello work!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="2"><li>\u5F00\u53D1\u6D88\u8D39\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WorkCustomer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queuesToDeclare <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">(</span><span class="token string">&quot;work&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive1</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;work message1 = &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queuesToDeclare <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">(</span><span class="token string">&quot;work&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive2</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;work message2 = &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p><strong>\u8BF4\u660E</strong>\uFF1A\u9ED8\u8BA4\u5728 Spring AMQP \u5B9E\u73B0\u4E2D Work \u8FD9\u79CD\u65B9\u5F0F\u5C31\u662F<strong>\u516C\u5E73\u8C03\u5EA6</strong>\uFF0C\u5982\u679C\u9700\u8981\u5B9E\u73B0\u80FD\u8005\u591A\u52B3\u9700\u8981\u989D\u5916\u914D\u7F6E\u3002</p></blockquote><h3 id="_5-3-fanout-\u5E7F\u64AD\u6A21\u578B" tabindex="-1"><a class="header-anchor" href="#_5-3-fanout-\u5E7F\u64AD\u6A21\u578B" aria-hidden="true">#</a> 5.3 Fanout \u5E7F\u64AD\u6A21\u578B</h3><ol><li>\u5F00\u53D1\u751F\u4EA7\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFanout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
  rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;\u8FD9\u662F\u65E5\u5FD7\u5E7F\u64AD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="2"><li>\u5F00\u53D1\u6D88\u8D39\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FanoutCustomer</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
            value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">,</span>
            exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span>type <span class="token operator">=</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive1</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;message1 = &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
            value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">,</span> <span class="token comment">//\u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
            exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span>type <span class="token operator">=</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">)</span>  <span class="token comment">//\u7ED1\u5B9A\u4EA4\u6362\u673A\u7C7B\u578B</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive2</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;message2 = &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_5-4-route-\u8DEF\u7531\u6A21\u578B" tabindex="-1"><a class="header-anchor" href="#_5-4-route-\u8DEF\u7531\u6A21\u578B" aria-hidden="true">#</a> 5.4 Route \u8DEF\u7531\u6A21\u578B</h3><ol><li>\u5F00\u53D1\u751F\u4EA7\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testDirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;directs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;error \u7684\u65E5\u5FD7\u4FE1\u606F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="2"><li>\u5F00\u53D1\u6D88\u8D39\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DirectCustomer</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span><span class="token punctuation">{</span>
            <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
                    value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    key<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token string">&quot;direct&quot;</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;directs&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive1</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;message1 = &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span><span class="token punctuation">{</span>
            <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
                    value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    key<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token string">&quot;direct&quot;</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;directs&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive2</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;message2 = &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="_5-5-topic-\u8BA2\u9605\u6A21\u578B-\u52A8\u6001\u8DEF\u7531\u6A21\u578B" tabindex="-1"><a class="header-anchor" href="#_5-5-topic-\u8BA2\u9605\u6A21\u578B-\u52A8\u6001\u8DEF\u7531\u6A21\u578B" aria-hidden="true">#</a> 5.5 Topic \u8BA2\u9605\u6A21\u578B\uFF08\u52A8\u6001\u8DEF\u7531\u6A21\u578B\uFF09</h3><ol><li>\u5F00\u53D1\u751F\u4EA7\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>

<span class="token comment">//topic</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testTopic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user.save.findAll&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user.save.findAll \u7684\u6D88\u606F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="2"><li>\u5F00\u53D1\u6D88\u8D39\u8005</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TopCustomer</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token punctuation">{</span>
          <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
                  value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">,</span>
                  key <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;user.*&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                  exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token string">&quot;topic&quot;</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">&quot;topics&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive1</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;message1 = &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token punctuation">{</span>
          <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
                  value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">,</span>
                  key <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;user.#&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                  exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token string">&quot;topic&quot;</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">&quot;topics&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive2</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;message2 = &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><hr><h2 id="_6-mq-\u7684\u5E94\u7528\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#_6-mq-\u7684\u5E94\u7528\u573A\u666F" aria-hidden="true">#</a> 6. MQ \u7684\u5E94\u7528\u573A\u666F</h2><h3 id="_6-1-\u5F02\u6B65\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_6-1-\u5F02\u6B65\u5904\u7406" aria-hidden="true">#</a> 6.1 \u5F02\u6B65\u5904\u7406</h3><p>\u573A\u666F\u8BF4\u660E\uFF1A\u7528\u6237\u6CE8\u518C\u540E\uFF0C\u9700\u8981\u53D1\u6CE8\u518C\u90AE\u4EF6\u548C\u6CE8\u518C\u77ED\u4FE1\uFF0C\u4F20\u7EDF\u7684\u505A\u6CD5\u6709\u4E24\u79CD\uFF1A\u4E32\u884C\u7684\u65B9\u5F0F\u3001\u5E76\u884C\u7684\u65B9\u5F0F\u3002</p><ul><li><strong>\u4E32\u884C\u65B9\u5F0F</strong>\uFF1A\u5C06\u6CE8\u518C\u4FE1\u606F\u5199\u5165\u6570\u636E\u5E93\u540E\uFF0C\u53D1\u9001\u6CE8\u518C\u90AE\u4EF6\uFF0C\u518D\u53D1\u9001\u6CE8\u518C\u77ED\u4FE1\uFF0C\u4EE5\u4E0A\u4E09\u4E2A\u4EFB\u52A1\u5168\u90E8\u5B8C\u6210\u540E\u624D\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\u3002\u8FD9\u6709\u4E00\u4E2A\u95EE\u9898\u662F\u90AE\u4EF6\u3001\u77ED\u4FE1\u5E76\u4E0D\u662F\u5FC5\u987B\u7684\uFF0C\u5B83\u53EA\u662F\u4E00\u4E2A\u901A\u77E5\uFF0C\u800C\u8FD9\u79CD\u505A\u6CD5\u8BA9\u5BA2\u6237\u7AEF\u7B49\u5F85\u6CA1\u6709\u5FC5\u8981\u7B49\u5F85\u7684\u4E1C\u897F\u3002</li></ul><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/SouthEast-4860248.png" alt="" loading="lazy"></p><ul><li><strong>\u5E76\u884C\u65B9\u5F0F</strong>\uFF1A\u5C06\u6CE8\u518C\u4FE1\u606F\u5199\u5165\u6570\u636E\u5E93\u540E\uFF0C\u53D1\u9001\u90AE\u4EF6\u7684\u540C\u65F6\uFF0C\u53D1\u9001\u77ED\u4FE1\uFF0C\u4EE5\u4E0A\u4E09\u4E2A\u4EFB\u52A1\u5B8C\u6210\u540E\uFF0C\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\uFF0C\u5E76\u884C\u7684\u65B9\u5F0F\u80FD\u63D0\u9AD8\u5904\u7406\u7684\u65F6\u95F4\u3002</li></ul><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/SouthEast-20191127211112660.png" alt="" loading="lazy"></p><ul><li><strong>\u6D88\u606F\u961F\u5217</strong>\uFF1A\u5047\u8BBE\u4E09\u4E2A\u4E1A\u52A1\u8282\u70B9\u5206\u522B\u4F7F\u7528 50ms\uFF0C\u90A3\u4E48\u4E32\u884C\u65B9\u5F0F\u4F7F\u7528\u65F6\u95F4 150ms\uFF0C\u5E76\u884C\u4F7F\u7528\u65F6\u95F4 100ms\u3002\u867D\u7136\u5E76\u884C\u5DF2\u7ECF\u63D0\u9AD8\u7684\u5904\u7406\u65F6\u95F4\uFF0C\u4F46\u662F\uFF0C\u524D\u9762\u8BF4\u8FC7\uFF0C\u90AE\u4EF6\u548C\u77ED\u4FE1\u5BF9\u6B63\u5E38\u7684\u4F7F\u7528\u7F51\u7AD9\u6CA1\u6709\u4EFB\u4F55\u5F71\u54CD\uFF0C\u5BA2\u6237\u7AEF\u6CA1\u6709\u5FC5\u8981\u7B49\u7740\u5176\u53D1\u9001\u5B8C\u6210\u624D\u663E\u793A\u6CE8\u518C\u6210\u529F\uFF0C\u5E94\u8BE5\u662F\u5199\u5165\u6570\u636E\u5E93\u540E\u5C31\u8FD4\u56DE\u3002\u5F15\u5165\u6D88\u606F\u961F\u5217\u540E\uFF0C\u628A\u53D1\u9001\u90AE\u4EF6\uFF0C\u77ED\u4FE1\u4E0D\u662F\u5FC5\u987B\u7684\u4E1A\u52A1\u903B\u8F91\u5F02\u6B65\u5904\u7406\u3002</li></ul><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/592892-20190520220249900-1679743651.jpg" alt="" loading="lazy"></p><p>\u7531\u6B64\u53EF\u4EE5\u770B\u51FA\uFF0C\u5F15\u5165\u6D88\u606F\u961F\u5217\u540E\uFF0C\u7528\u6237\u7684\u54CD\u5E94\u65F6\u95F4\u5C31\u7B49\u4E8E\u5199\u5165\u6570\u636E\u5E93\u7684\u65F6\u95F4 + \u5199\u5165\u6D88\u606F\u961F\u5217\u7684\u65F6\u95F4(\u53EF\u4EE5\u5FFD\u7565\u4E0D\u8BA1)\uFF0C\u5F15\u5165\u6D88\u606F\u961F\u5217\u540E\u5904\u7406\u540E\uFF0C\u54CD\u5E94\u65F6\u95F4\u662F\u4E32\u884C\u7684 3 \u500D\uFF0C\u662F\u5E76\u884C\u7684 2 \u500D\u3002</p><h3 id="_6-2-\u5E94\u7528\u89E3\u8026" tabindex="-1"><a class="header-anchor" href="#_6-2-\u5E94\u7528\u89E3\u8026" aria-hidden="true">#</a> 6.2 \u5E94\u7528\u89E3\u8026</h3><p>\u573A\u666F\uFF1A\u53CC11\u662F\u8D2D\u7269\u72C2\u8282\uFF0C\u7528\u6237\u4E0B\u5355\u540E\uFF0C\u8BA2\u5355\u7CFB\u7EDF\u9700\u8981\u901A\u77E5\u5E93\u5B58\u7CFB\u7EDF\uFF0C\u4F20\u7EDF\u7684\u505A\u6CD5\u5C31\u662F\u8BA2\u5355\u7CFB\u7EDF\u8C03\u7528\u5E93\u5B58\u7CFB\u7EDF\u7684\u63A5\u53E3\u3002</p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/SouthEast-20191127211247287.png" alt="" loading="lazy"></p><p>\u8FD9\u79CD\u505A\u6CD5\u6709\u4E00\u4E2A\u7F3A\u70B9\uFF1A</p><p>\u5F53\u5E93\u5B58\u7CFB\u7EDF\u51FA\u73B0\u6545\u969C\u65F6\uFF0C\u8BA2\u5355\u5C31\u4F1A\u5931\u8D25\uFF0C\u8BA2\u5355\u7CFB\u7EDF\u548C\u5E93\u5B58\u7CFB\u7EDF\u9AD8\u8026\u5408\u3002</p><p>\u5F15\u5165\u6D88\u606F\u961F\u5217\uFF1A</p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/SouthEast-20191127211304085.png" alt="" loading="lazy"></p><ul><li><strong>\u8BA2\u5355\u7CFB\u7EDF</strong>\uFF1A\u7528\u6237\u4E0B\u5355\u540E\uFF0C\u8BA2\u5355\u7CFB\u7EDF\u5B8C\u6210\u6301\u4E45\u5316\u5904\u7406\uFF0C\u5C06\u6D88\u606F\u5199\u5165\u6D88\u606F\u961F\u5217\uFF0C\u8FD4\u56DE\u7528\u6237\u8BA2\u5355\u4E0B\u5355\u6210\u529F\u3002</li><li><strong>\u5E93\u5B58\u7CFB\u7EDF</strong>\uFF1A\u8BA2\u9605\u4E0B\u5355\u7684\u6D88\u606F\uFF0C\u83B7\u53D6\u4E0B\u5355\u6D88\u606F\uFF0C\u8FDB\u884C\u6263\u51CF\u5E93\u5B58\u64CD\u4F5C\u3002\u5C31\u7B97\u5E93\u5B58\u7CFB\u7EDF\u51FA\u73B0\u6545\u969C\uFF0C\u6D88\u606F\u961F\u5217\u4E5F\u80FD\u4FDD\u8BC1\u6D88\u606F\u7684\u53EF\u9760\u6295\u9012\uFF0C\u4E0D\u4F1A\u5BFC\u81F4\u6D88\u606F\u4E22\u5931\u3002</li></ul><h3 id="_6-3-\u6D41\u91CF\u524A\u5CF0" tabindex="-1"><a class="header-anchor" href="#_6-3-\u6D41\u91CF\u524A\u5CF0" aria-hidden="true">#</a> 6.3 \u6D41\u91CF\u524A\u5CF0</h3><p>\u573A\u666F\uFF1A\u79D2\u6740\u6D3B\u52A8\uFF0C\u4E00\u822C\u4F1A\u56E0\u4E3A\u6D41\u91CF\u8FC7\u5927\uFF0C\u5BFC\u81F4\u5E94\u7528\u6302\u6389\uFF0C\u4E3A\u4E86\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0C\u4E00\u822C\u5728\u5E94\u7528\u524D\u7AEF\u52A0\u5165\u6D88\u606F\u961F\u5217\u3002</p><p>\u4F5C\u7528\uFF1A</p><ol><li>\u53EF\u4EE5\u63A7\u5236\u6D3B\u52A8\u4EBA\u6570\uFF0C\u8D85\u8FC7\u6B64\u4E00\u5B9A\u9600\u503C\u7684\u8BA2\u5355\u76F4\u63A5\u4E22\u5F03\uFF08\u6211\u4E3A\u4EC0\u4E48\u79D2\u6740\u4E00\u6B21\u90FD\u6CA1\u6709\u6210\u529F\u8FC7\u5462^^\uFF09</li></ol><p>\u200B2. \u53EF\u4EE5\u7F13\u89E3\u77ED\u65F6\u95F4\u7684\u9AD8\u6D41\u91CF\u538B\u57AE\u5E94\u7528(\u5E94\u7528\u7A0B\u5E8F\u6309\u81EA\u5DF1\u7684\u6700\u5927\u5904\u7406\u80FD\u529B\u83B7\u53D6\u8BA2\u5355)</p><p>\u6D41\u7A0B\uFF1A</p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/SouthEast-20191127211341601.png" alt="" loading="lazy"></p><ol><li><p>\u7528\u6237\u7684\u8BF7\u6C42\uFF0C\u670D\u52A1\u5668\u6536\u5230\u4E4B\u540E\uFF0C\u9996\u5148\u5199\u5165\u6D88\u606F\u961F\u5217\uFF0C\u52A0\u5165\u6D88\u606F\u961F\u5217\u957F\u5EA6\u8D85\u8FC7\u6700\u5927\u503C\uFF0C\u5219\u76F4\u63A5\u629B\u5F03\u7528\u6237\u8BF7\u6C42\u6216\u8DF3\u8F6C\u5230\u9519\u8BEF\u9875\u9762\u3002</p></li><li><p>\u79D2\u6740\u4E1A\u52A1\u6839\u636E\u6D88\u606F\u961F\u5217\u4E2D\u7684\u8BF7\u6C42\u4FE1\u606F\uFF0C\u518D\u505A\u540E\u7EED\u5904\u7406\u3002</p></li></ol><hr><h2 id="_7-rabbitmq-\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#_7-rabbitmq-\u96C6\u7FA4" aria-hidden="true">#</a> 7. RabbitMQ \u96C6\u7FA4</h2><h3 id="_7-1-\u666E\u901A\u96C6\u7FA4-\u526F\u672C\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#_7-1-\u666E\u901A\u96C6\u7FA4-\u526F\u672C\u96C6\u7FA4" aria-hidden="true">#</a> 7.1 \u666E\u901A\u96C6\u7FA4\uFF08\u526F\u672C\u96C6\u7FA4\uFF09</h3><blockquote><p>All data/state required for the operation of a RabbitMQ broker is replicated across all nodes. An exception to this are message queues, which by default reside on one node, though they are visible and reachable from all nodes. To replicate queues across nodes in a cluster --\u6458\u81EA\u5B98\u7F51</p></blockquote><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF1ARabbitMQ \u4EE3\u7406\u64CD\u4F5C\u6240\u9700\u7684\u6240\u6709\u6570\u636E/\u72B6\u6001\u90FD\u5C06\u8DE8\u6240\u6709\u8282\u70B9\u590D\u5236\u3002\u8FD9\u65B9\u9762\u7684\u4E00\u4E2A\u4F8B\u5916\u662F\u6D88\u606F\u961F\u5217\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u6D88\u606F\u961F\u5217\u4F4D\u4E8E\u4E00\u4E2A\u8282\u70B9\u4E0A\uFF0C\u5C3D\u7BA1\u5B83\u4EEC\u53EF\u4EE5\u4ECE\u6240\u6709\u8282\u70B9\u770B\u5230\u548C\u8BBF\u95EE\u3002</p><ol><li>\u67B6\u6784\u56FE</li></ol><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200320094147471.png" alt="" loading="lazy"></p><p>\u200B\u6838\u5FC3\u89E3\u51B3\u95EE\u9898\uFF1A<strong>\u5F53\u96C6\u7FA4\u4E2D\u67D0\u4E00\u65F6\u523B Master \u8282\u70B9\u5B95\u673A\uFF0C\u53EF\u4EE5\u5BF9 Quene \u4E2D\u4FE1\u606F\uFF0C\u8FDB\u884C\u5907\u4EFD</strong>\u3002</p><ol start="2"><li>\u96C6\u7FA4\u642D\u5EFA</li></ol><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">0.</span> \u96C6\u7FA4\u89C4\u5212
  node1: 10.15.0.3  mq1  master \u4E3B\u8282\u70B9
  node2: 10.15.0.4  mq2  repl1  \u526F\u672C\u8282\u70B9
  node3: 10.15.0.5  mq3  repl2  \u526F\u672C\u8282\u70B9

<span class="token list punctuation">1.</span> \u514B\u9686\u4E09\u53F0\u673A\u5668\u4E3B\u673A\u540D\u548C IP \u6620\u5C04
  vim /etc/hosts\u52A0\u5165\uFF1A
    10.15.0.3 mq1
    10.15.0.4 mq2
    10.15.0.5 mq3

<span class="token code keyword">    node1: vim /etc/hostname \u52A0\u5165\uFF1Amq1
    node2: vim /etc/hostname \u52A0\u5165\uFF1Amq2
    node3: vim /etc/hostname \u52A0\u5165\uFF1Amq3</span>

<span class="token list punctuation">2.</span> \u4E09\u4E2A\u673A\u5668\u5B89\u88C5 RabbitMQ,\u5E76\u540C\u6B65 cookie \u6587\u4EF6\uFF0C\u5728 node1 \u4E0A\u6267\u884C\uFF1A
  scp /var/lib/rabbitmq/.erlang.cookie root@mq2:/var/lib/rabbitmq/
  scp /var/lib/rabbitmq/.erlang.cookie root@mq3:/var/lib/rabbitmq/

<span class="token list punctuation">3.</span> \u67E5\u770B cookie \u662F\u5426\u4E00\u81F4\uFF1A
  node1: cat /var/lib/rabbitmq/.erlang.cookie 
  node2: cat /var/lib/rabbitmq/.erlang.cookie 
  node3: cat /var/lib/rabbitmq/.erlang.cookie 

<span class="token list punctuation">4.</span> \u540E\u53F0\u542F\u52A8 RabbitMQ \u6240\u6709\u8282\u70B9\u6267\u884C\u5982\u4E0B\u547D\u4EE4\uFF0C\u542F\u52A8\u6210\u529F\u8BBF\u95EE\u7BA1\u7406\u754C\u9762\uFF1A
  rabbitmq-server -detached 

<span class="token list punctuation">5.</span> \u5728 node2 \u548C node3 \u6267\u884C\u52A0\u5165\u96C6\u7FA4\u547D\u4EE4\uFF1A
  <span class="token list punctuation">1.</span> \u5173\u95ED       rabbitmqctl stop_app
  <span class="token list punctuation">2.</span> \u52A0\u5165\u96C6\u7FA4    rabbitmqctl join_cluster rabbit@mq1
  <span class="token list punctuation">3.</span> \u542F\u52A8\u670D\u52A1    rabbitmqctl start_app

<span class="token list punctuation">6.</span> \u67E5\u770B\u96C6\u7FA4\u72B6\u6001\uFF0C\u4EFB\u610F\u8282\u70B9\u6267\u884C\uFF1A
  rabbitmqctl cluster_status

<span class="token list punctuation">7.</span> \u5982\u679C\u51FA\u73B0\u5982\u4E0B\u663E\u793A\uFF0C\u96C6\u7FA4\u642D\u5EFA\u6210\u529F\uFF1A
  Cluster status of node rabbit@mq3 ...
  [{nodes,[{disc,[rabbit@mq1,rabbit@mq2,rabbit@mq3]}]},
  {running_nodes,[rabbit@mq1,rabbit@mq2,rabbit@mq3]},
  {cluster_name,&lt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>&quot;rabbit@mq1&quot;</span><span class="token punctuation">&gt;</span></span>&gt;},
  {partitions,[]},
  {alarms,[{rabbit@mq1,[]},{rabbit@mq2,[]},{rabbit@mq3,[]}]}]

<span class="token list punctuation">8.</span> \u767B\u5F55\u7BA1\u7406\u754C\u9762\uFF0C\u5C55\u793A\u5982\u4E0B\u72B6\u6001\uFF1A
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200320095613586.png" alt="" loading="lazy"></p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">9.</span> \u6D4B\u8BD5\u96C6\u7FA4\u5728 node1 \u4E0A\uFF0C\u521B\u5EFA\u961F\u5217
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200320095743935.png" alt="" loading="lazy"></p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">10.</span> \u67E5\u770B node2 \u548C node3 \u8282\u70B9\uFF1A
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200320095827688.png" alt="" loading="lazy"></p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200320095843370.png" alt="" loading="lazy"></p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">11.</span> \u5173\u95ED node1 \u8282\u70B9\uFF0C\u6267\u884C\u5982\u4E0B\u547D\u4EE4\uFF0C\u67E5\u770B node2 \u548C node3:
rabbitmqctl stop_app
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200320100000347.png" alt="" loading="lazy"></p><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200320100010968.png" alt="" loading="lazy"></p><hr><h3 id="_7-2-\u955C\u50CF\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#_7-2-\u955C\u50CF\u96C6\u7FA4" aria-hidden="true">#</a> 7.2 \u955C\u50CF\u96C6\u7FA4</h3><blockquote><p>This guide covers mirroring (queue contents replication) of classic queues --\u6458\u81EA\u5B98\u7F51</p><p>By default, contents of a queue within a RabbitMQ cluster are located on a single node (the node on which the queue was declared). This is in contrast to exchanges and bindings, which can always be considered to be on all nodes. Queues can optionally be made <em>mirrored</em> across multiple nodes. --\u6458\u81EA\u5B98\u7F51</p></blockquote><p>\u955C\u50CF\u961F\u5217\u673A\u5236\u5C31\u662F\u5C06\u961F\u5217\u5728\u4E09\u4E2A\u8282\u70B9\u4E4B\u95F4\u8BBE\u7F6E\u4E3B\u4ECE\u5173\u7CFB\uFF0C\u6D88\u606F\u4F1A\u5728\u4E09\u4E2A\u8282\u70B9\u4E4B\u95F4\u8FDB\u884C\u81EA\u52A8\u540C\u6B65\uFF0C\u4E14\u5982\u679C\u5176\u4E2D\u4E00\u4E2A\u8282\u70B9\u4E0D\u53EF\u7528\uFF0C\u5E76\u4E0D\u4F1A\u5BFC\u81F4\u6D88\u606F\u4E22\u5931\u6216\u670D\u52A1\u4E0D\u53EF\u7528\u7684\u60C5\u51B5\uFF0C\u63D0\u5347 MQ \u96C6\u7FA4\u7684\u6574\u4F53\u9AD8\u53EF\u7528\u6027\u3002</p><ol><li>\u96C6\u7FA4\u67B6\u6784\u56FE</li></ol><p><img src="https://chen-coding.oss-cn-shenzhen.aliyuncs.com/middleware/MQ/01/image-20200320113423235.png" alt="" loading="lazy"></p><ol start="2"><li>\u914D\u7F6E\u96C6\u7FA4\u67B6\u6784</li></ol><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">0.</span> \u7B56\u7565\u8BF4\u660E
  rabbitmqctl set_policy <span class="token url">[<span class="token content">-p &lt;vhost&gt;</span>] [<span class="token variable">--priority &lt;priority&gt;</span>]</span> [--apply-to <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>apply-to</span><span class="token punctuation">&gt;</span></span>] <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>definition</span><span class="token punctuation">&gt;</span></span>
  -p Vhost\uFF1A  \u53EF\u9009\u53C2\u6570\uFF0C\u9488\u5BF9\u6307\u5B9A vhost \u4E0B\u7684 queue \u8FDB\u884C\u8BBE\u7F6E
  priority\uFF1A\u53EF\u9009\u53C2\u6570\uFF0Cpolicy \u7684\u4F18\u5148\u7EA7
  name:       policy \u7684\u540D\u79F0
  pattern:    queue \u7684\u5339\u914D\u6A21\u5F0F\uFF08\u6B63\u5219\u8868\u8FBE\u5F0F\uFF09
  definition: ha-mode\u3001ha-params\u3001ha-sync-mode
    ha-mode: \u6307\u660E\u955C\u50CF\u961F\u5217\u7684\u6A21\u5F0F\uFF0C\u6709\u6548\u503C\u4E3A all/exactly/nodes
      all\uFF1A\u8868\u793A\u5728\u96C6\u7FA4\u4E2D\u6240\u6709\u7684\u8282\u70B9\u4E0A\u8FDB\u884C\u955C\u50CF
      exactly\uFF1A\u8868\u793A\u5728\u6307\u5B9A\u4E2A\u6570\u7684\u8282\u70B9\u4E0A\u8FDB\u884C\u955C\u50CF\uFF0C\u8282\u70B9\u7684\u4E2A\u6570\u7531 ha-params \u6307\u5B9A
      nodes\uFF1A\u8868\u793A\u5728\u6307\u5B9A\u7684\u8282\u70B9\u4E0A\u8FDB\u884C\u955C\u50CF\uFF0C\u8282\u70B9\u540D\u79F0\u901A\u8FC7 ha-params \u6307\u5B9A
    ha-params: ha-mode \u6A21\u5F0F\u9700\u8981\u7528\u5230\u7684\u53C2\u6570
    ha-sync-mode: \u8FDB\u884C\u961F\u5217\u4E2D\u6D88\u606F\u7684\u540C\u6B65\u65B9\u5F0F\uFF0C\u6709\u6548\u503C\u4E3A automatic \u548C manual
                
<span class="token code keyword">                </span>
<span class="token list punctuation">1.</span> \u67E5\u770B\u5F53\u524D\u7B56\u7565
rabbitmqctl list_policies

<span class="token list punctuation">1.</span> \u6DFB\u52A0\u7B56\u7565
rabbitmqctl set_policy ha-all &#39;^hello&#39; &#39;{&quot;ha-mode&quot;:&quot;all&quot;,&quot;ha-sync-mode&quot;:&quot;automatic&quot;}&#39; 

\u8BF4\u660E\uFF1A\u7B56\u7565\u6B63\u5219\u8868\u8FBE\u5F0F\u4E3A \u201C^\u201D \u8868\u793A\u6240\u6709\u5339\u914D\u6240\u6709\u961F\u5217\u540D\u79F0  ^hello: \u5339\u914D hello \u5F00\u5934\u961F\u5217

<span class="token list punctuation">3.</span> \u5220\u9664\u7B56\u7565
rabbitmqctl clear_policy ha-all

<span class="token list punctuation">4.</span> \u6D4B\u8BD5\u96C6\u7FA4
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><hr>`,239);function y(v,w){const a=e("ExternalLinkIcon");return u(),o(c,null,[r,n("blockquote",null,[n("p",null,[n("a",k,[b,p(a)])]),n("p",null,[n("a",m,[d,p(a)])]),n("p",null,[n("a",g,[h,p(a)])])]),q],64)}var _=t(i,[["render",y],["__file","RabbitMQ.html.vue"]]);export{_ as default};
